/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
(function(){var innerGlobal=typeof window!="undefined"?window:global;var exportTo={};(function(window,global,module){var l,aa="function"==typeof Object.defineProperties?Object.defineProperty:function(b,c,d){b!=Array.prototype&&b!=Object.prototype&&(b[c]=d.value)},ba="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function ca(){ca=function(){};ba.Symbol||(ba.Symbol=da)}var da=function(){var b=0;return function(c){return"jscomp_symbol_"+(c||"")+b++}}();
function ea(){ca();var b=ba.Symbol.iterator;b||(b=ba.Symbol.iterator=ba.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&aa(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return fa(this)}});ea=function(){}}function fa(b){var c=0;return ha(function(){return c<b.length?{done:!1,value:b[c++]}:{done:!0}})}function ha(b){ea();b={next:b};b[ba.Symbol.iterator]=function(){return this};return b}function r(b){ea();var c=b[Symbol.iterator];return c?c.call(b):fa(b)}
function ia(b,c){if(c){for(var d=ba,e=b.split("."),f=0;f<e.length-1;f++){var g=e[f];g in d||(d[g]={});d=d[g]}e=e[e.length-1];f=d[e];g=c(f);g!=f&&null!=g&&aa(d,e,{configurable:!0,writable:!0,value:g})}}
ia("Promise",function(b){function c(b){this.b=0;this.g=void 0;this.a=[];var c=this.c();try{b(c.resolve,c.reject)}catch(m){c.reject(m)}}function d(){this.a=null}function e(b){return b instanceof c?b:new c(function(c){c(b)})}if(b)return b;d.prototype.b=function(b){null==this.a&&(this.a=[],this.f());this.a.push(b)};d.prototype.f=function(){var b=this;this.c(function(){b.h()})};var f=ba.setTimeout;d.prototype.c=function(b){f(b,0)};d.prototype.h=function(){for(;this.a&&this.a.length;){var b=this.a;this.a=
[];for(var c=0;c<b.length;++c){var d=b[c];b[c]=null;try{d()}catch(n){this.g(n)}}}this.a=null};d.prototype.g=function(b){this.c(function(){throw b;})};c.prototype.c=function(){function b(b){return function(e){d||(d=!0,b.call(c,e))}}var c=this,d=!1;return{resolve:b(this.u),reject:b(this.f)}};c.prototype.u=function(b){if(b===this)this.f(new TypeError("A Promise cannot resolve to itself"));else if(b instanceof c)this.v(b);else{a:switch(typeof b){case "object":var d=null!=b;break a;case "function":d=!0;
break a;default:d=!1}d?this.o(b):this.h(b)}};c.prototype.o=function(b){var c=void 0;try{c=b.then}catch(m){this.f(m);return}"function"==typeof c?this.C(c,b):this.h(b)};c.prototype.f=function(b){this.i(2,b)};c.prototype.h=function(b){this.i(1,b)};c.prototype.i=function(b,c){if(0!=this.b)throw Error("Cannot settle("+b+", "+c+"): Promise already settled in state"+this.b);this.b=b;this.g=c;this.m()};c.prototype.m=function(){if(null!=this.a){for(var b=0;b<this.a.length;++b)g.b(this.a[b]);this.a=null}};
var g=new d;c.prototype.v=function(b){var c=this.c();b.Pb(c.resolve,c.reject)};c.prototype.C=function(b,c){var d=this.c();try{b.call(c,d.resolve,d.reject)}catch(n){d.reject(n)}};c.prototype.then=function(b,d){function e(b,c){return"function"==typeof b?function(c){try{f(b(c))}catch(B){g(B)}}:c}var f,g,h=new c(function(b,c){f=b;g=c});this.Pb(e(b,f),e(d,g));return h};c.prototype["catch"]=function(b){return this.then(void 0,b)};c.prototype.Pb=function(b,c){function d(){switch(e.b){case 1:b(e.g);break;
case 2:c(e.g);break;default:throw Error("Unexpected state: "+e.b);}}var e=this;null==this.a?g.b(d):this.a.push(d)};c.resolve=e;c.reject=function(b){return new c(function(c,d){d(b)})};c.race=function(b){return new c(function(c,d){for(var f=r(b),g=f.next();!g.done;g=f.next())e(g.value).Pb(c,d)})};c.all=function(b){var d=r(b),f=d.next();return f.done?e([]):new c(function(b,c){function g(c){return function(d){h[c]=d;k--;0==k&&b(h)}}var h=[],k=0;do h.push(void 0),k++,e(f.value).Pb(g(h.length-1),c),f=d.next();
while(!f.done)})};return c});ia("Promise.prototype.finally",function(b){return b?b:function(b){return this.then(function(c){return Promise.resolve(b()).then(function(){return c})},function(c){return Promise.resolve(b()).then(function(){throw c;})})}});function ja(b){function c(c){return b.next(c)}function d(c){return b["throw"](c)}return new Promise(function(e,f){function g(b){b.done?e(b.value):Promise.resolve(b.value).then(c,d).then(g,f)}g(b.next())})}function v(b){return ja(b())}
function la(b){for(var c,d=[];!(c=b.next()).done;)d.push(c.value);return d}var ma="function"==typeof Object.create?Object.create:function(b){function c(){}c.prototype=b;return new c},oa;if("function"==typeof Object.setPrototypeOf)oa=Object.setPrototypeOf;else{var pa;a:{var qa={Td:!0},ra={};try{ra.__proto__=qa;pa=ra.Td;break a}catch(b){}pa=!1}oa=pa?function(b,c){b.__proto__=c;if(b.__proto__!==c)throw new TypeError(b+" is not extensible");return b}:null}var sa=oa;
function ta(){this.c=!1;this.a=null;this.N=void 0;this.j=1;this.g=this.U=0;this.b=null}function ua(b){if(b.c)throw new TypeError("Generator is already running");b.c=!0}ta.prototype.f=function(b){this.N=b};function va(b,c){b.b={kd:c,Ce:!0};b.j=b.U||b.g}ta.prototype["return"]=function(b){this.b={"return":b};this.j=this.g};function w(b,c,d){b.j=d;return{value:c}}function x(b){b.j=0}function wa(b,c){b.j=c;b.U=0}function Ba(b){b.U=0;var c=b.b.kd;b.b=null;return c}
function Ca(b){this.a=new ta;this.b=b}function Fa(b,c){ua(b.a);var d=b.a.a;if(d)return Ga(b,"return"in d?d["return"]:function(b){return{value:b,done:!0}},c,b.a["return"]);b.a["return"](c);return Ha(b)}function Ga(b,c,d,e){try{var f=c.call(b.a.a,d);if(!(f instanceof Object))throw new TypeError("Iterator result "+f+" is not an object");if(!f.done)return b.a.c=!1,f;var g=f.value}catch(h){return b.a.a=null,va(b.a,h),Ha(b)}b.a.a=null;e.call(b.a,g);return Ha(b)}
function Ha(b){for(;b.a.j;)try{var c=b.b(b.a);if(c)return b.a.c=!1,{value:c.value,done:!1}}catch(d){b.a.N=void 0,va(b.a,d)}b.a.c=!1;if(b.a.b){c=b.a.b;b.a.b=null;if(c.Ce)throw c.kd;return{value:c["return"],done:!0}}return{value:void 0,done:!0}}
function Ia(b){this.next=function(c){ua(b.a);b.a.a?c=Ga(b,b.a.a.next,c,b.a.f):(b.a.f(c),c=Ha(b));return c};this["throw"]=function(c){ua(b.a);b.a.a?c=Ga(b,b.a.a["throw"],c,b.a.f):(va(b.a,c),c=Ha(b));return c};this["return"]=function(c){return Fa(b,c)};ea();this[Symbol.iterator]=function(){return this}}function y(b,c){Ia.prototype=b.prototype;return new Ia(new Ca(c))}
function Ja(b,c){ea();b instanceof String&&(b+="");var d=0,e={next:function(){if(d<b.length){var f=d++;return{value:c(f,b[f]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e}ia("Array.prototype.keys",function(b){return b?b:function(){return Ja(this,function(b){return b})}});function Ka(b,c){return Object.prototype.hasOwnProperty.call(b,c)}
ia("WeakMap",function(b){function c(b){this.a=(g+=Math.random()+1).toString();if(b){ca();ea();b=r(b);for(var c;!(c=b.next()).done;)c=c.value,this.set(c[0],c[1])}}function d(b){Ka(b,f)||aa(b,f,{value:{}})}function e(b){var c=Object[b];c&&(Object[b]=function(b){d(b);return c(b)})}if(function(){if(!b||!Object.seal)return!1;try{var c=Object.seal({}),d=Object.seal({}),e=new b([[c,2],[d,3]]);if(2!=e.get(c)||3!=e.get(d))return!1;e["delete"](c);e.set(d,4);return!e.has(c)&&4==e.get(d)}catch(n){return!1}}())return b;
var f="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var g=0;c.prototype.set=function(b,c){d(b);if(!Ka(b,f))throw Error("WeakMap key fail: "+b);b[f][this.a]=c;return this};c.prototype.get=function(b){return Ka(b,f)?b[f][this.a]:void 0};c.prototype.has=function(b){return Ka(b,f)&&Ka(b[f],this.a)};c.prototype["delete"]=function(b){return Ka(b,f)&&Ka(b[f],this.a)?delete b[f][this.a]:!1};return c});
ia("Map",function(b){function c(){var b={};return b.Ca=b.next=b.head=b}function d(b,c){var d=b.a;return ha(function(){if(d){for(;d.head!=b.a;)d=d.Ca;for(;d.next!=d.head;)return d=d.next,{done:!1,value:c(d)};d=null}return{done:!0,value:void 0}})}function e(b,c){var d=c&&typeof c;"object"==d||"function"==d?g.has(c)?d=g.get(c):(d=""+ ++h,g.set(c,d)):d="p_"+c;var e=b.b[d];if(e&&Ka(b.b,d))for(var f=0;f<e.length;f++){var k=e[f];if(c!==c&&k.key!==k.key||c===k.key)return{id:d,list:e,index:f,X:k}}return{id:d,
list:e,index:-1,X:void 0}}function f(b){this.b={};this.a=c();this.size=0;if(b){b=r(b);for(var d;!(d=b.next()).done;)d=d.value,this.set(d[0],d[1])}}if(function(){if(!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),d=new b(r([[c,"s"]]));if("s"!=d.get(c)||1!=d.size||d.get({x:4})||d.set({x:4},"t")!=d||2!=d.size)return!1;var e=d.entries(),f=e.next();if(f.done||f.value[0]!=c||"s"!=f.value[1])return!1;f=e.next();return f.done||4!=f.value[0].x||
"t"!=f.value[1]||!e.next().done?!1:!0}catch(q){return!1}}())return b;ca();ea();var g=new WeakMap;f.prototype.set=function(b,c){var d=e(this,b);d.list||(d.list=this.b[d.id]=[]);d.X?d.X.value=c:(d.X={next:this.a,Ca:this.a.Ca,head:this.a,key:b,value:c},d.list.push(d.X),this.a.Ca.next=d.X,this.a.Ca=d.X,this.size++);return this};f.prototype["delete"]=function(b){b=e(this,b);return b.X&&b.list?(b.list.splice(b.index,1),b.list.length||delete this.b[b.id],b.X.Ca.next=b.X.next,b.X.next.Ca=b.X.Ca,b.X.head=
null,this.size--,!0):!1};f.prototype.clear=function(){this.b={};this.a=this.a.Ca=c();this.size=0};f.prototype.has=function(b){return!!e(this,b).X};f.prototype.get=function(b){return(b=e(this,b).X)&&b.value};f.prototype.entries=function(){return d(this,function(b){return[b.key,b.value]})};f.prototype.keys=function(){return d(this,function(b){return b.key})};f.prototype.values=function(){return d(this,function(b){return b.value})};f.prototype.forEach=function(b,c){for(var d=this.entries(),e;!(e=d.next()).done;)e=
e.value,b.call(c,e[1],e[0],this)};f.prototype[Symbol.iterator]=f.prototype.entries;var h=0;return f});
ia("Set",function(b){function c(b){this.a=new Map;if(b){b=r(b);for(var c;!(c=b.next()).done;)this.add(c.value)}this.size=this.a.size}if(function(){if(!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),e=new b(r([c]));if(!e.has(c)||1!=e.size||e.add(c)!=e||1!=e.size||e.add({x:4})!=e||2!=e.size)return!1;var f=e.entries(),g=f.next();if(g.done||g.value[0]!=c||g.value[1]!=c)return!1;g=f.next();return g.done||g.value[0]==c||4!=g.value[0].x||
g.value[1]!=g.value[0]?!1:f.next().done}catch(h){return!1}}())return b;ca();ea();c.prototype.add=function(b){this.a.set(b,b);this.size=this.a.size;return this};c.prototype["delete"]=function(b){b=this.a["delete"](b);this.size=this.a.size;return b};c.prototype.clear=function(){this.a.clear();this.size=0};c.prototype.has=function(b){return this.a.has(b)};c.prototype.entries=function(){return this.a.entries()};c.prototype.values=function(){return this.a.values()};c.prototype.keys=c.prototype.values;
c.prototype[Symbol.iterator]=c.prototype.values;c.prototype.forEach=function(b,c){var d=this;this.a.forEach(function(e){return b.call(c,e,e,d)})};return c});ia("Object.is",function(b){return b?b:function(b,d){return b===d?0!==b||1/b===1/d:b!==b&&d!==d}});ia("Array.prototype.includes",function(b){return b?b:function(b,d){var c=this;c instanceof String&&(c=String(c));var f=c.length,g=d||0;for(0>g&&(g=Math.max(g+f,0));g<f;g++){var h=c[g];if(h===b||Object.is(h,b))return!0}return!1}});
function La(b,c,d){if(null==b)throw new TypeError("The 'this' value for String.prototype."+d+" must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype."+d+" must not be a regular expression");return b+""}ia("String.prototype.includes",function(b){return b?b:function(b,d){return-1!==La(this,b,"includes").indexOf(b,d||0)}});
ia("Array.from",function(b){return b?b:function(b,d,e){ea();d=null!=d?d:function(b){return b};var c=[],g=b[Symbol.iterator];if("function"==typeof g)for(b=g.call(b);!(g=b.next()).done;)c.push(d.call(e,g.value));else{g=b.length;for(var h=0;h<g;h++)c.push(d.call(e,b[h]))}return c}});ia("String.prototype.startsWith",function(b){return b?b:function(b,d){for(var c=La(this,b,"startsWith"),f=c.length,g=b.length,h=Math.max(0,Math.min(d|0,c.length)),k=0;k<g&&h<f;)if(c[h++]!=b[k++])return!1;return k>=g}});
ia("Array.prototype.find",function(b){return b?b:function(b,d){a:{var c=this;c instanceof String&&(c=String(c));for(var f=c.length,g=0;g<f;g++){var h=c[g];if(b.call(d,h,g,c)){c=h;break a}}c=void 0}return c}});var Ma="function"==typeof Object.assign?Object.assign:function(b,c){for(var d=1;d<arguments.length;d++){var e=arguments[d];if(e)for(var f in e)Ka(e,f)&&(b[f]=e[f])}return b};ia("Object.assign",function(b){return b||Ma});var Na=this;Na.a=!0;
function z(b,c){var d=b.split("."),e=Na;d[0]in e||!e.execScript||e.execScript("var "+d[0]);for(var f;d.length&&(f=d.shift());)d.length||void 0===c?e[f]?e=e[f]:e=e[f]={}:e[f]=c}function Oa(b,c){function d(){}d.prototype=c.prototype;b.sf=c.prototype;b.prototype=new d;b.prototype.constructor=b;b.Gf=function(b,d,g){return c.prototype[d].apply(b,Array.prototype.slice.call(arguments,2))}};/*

 Copyright 2016 Google Inc.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
function Pa(b){this.c=Math.exp(Math.log(.5)/b);this.b=this.a=0}function Qa(b,c,d){var e=Math.pow(b.c,c);d=d*(1-e)+e*b.a;isNaN(d)||(b.a=d,b.b+=c)}function Sa(b){return b.a/(1-Math.pow(b.c,b.b))};function Ta(){this.b=new Pa(2);this.c=new Pa(5);this.a=0}Ta.prototype.getBandwidthEstimate=function(b){return 128E3>this.a?b:Math.min(Sa(this.b),Sa(this.c))};var A={hb:0,nc:function(){},ra:function(){},error:function(){},l:function(){},info:function(){},debug:function(){},A:function(){},I:function(){}};window.console&&window.console.log.bind&&(A.ra=console.warn.bind(console),A.nc=console.error.bind(console),1<=A.hb&&(A.error=console.error.bind(console)),2<=A.hb&&(A.l=console.warn.bind(console)),3<=A.hb&&(A.info=console.info.bind(console)),4<=A.hb&&(A.debug=console.log.bind(console)),5<=A.hb&&(A.A=console.debug.bind(console)),6<=A.hb&&(A.I=console.debug.bind(console)));/*
 @license
 Copyright 2008 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/
var Va=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;/*
 @license
 Copyright 2006 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/
function Wa(b){var c;b instanceof Wa?(Ya(this,b.ta),this.bb=b.bb,this.sa=b.sa,Za(this,b.yb),this.qa=b.qa,$a(this,b.a.clone()),this.Ta=b.Ta):b&&(c=String(b).match(Va))?(Ya(this,c[1]||"",!0),this.bb=ab(c[2]||""),this.sa=ab(c[3]||"",!0),Za(this,c[4]),this.qa=ab(c[5]||"",!0),$a(this,c[6]||"",!0),this.Ta=ab(c[7]||"")):this.a=new bb(null)}l=Wa.prototype;l.ta="";l.bb="";l.sa="";l.yb=null;l.qa="";l.Ta="";
l.toString=function(){var b=[],c=this.ta;c&&b.push(eb(c,fb,!0),":");if(c=this.sa){b.push("//");var d=this.bb;d&&b.push(eb(d,fb,!0),"@");b.push(encodeURIComponent(c).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));c=this.yb;null!=c&&b.push(":",String(c))}if(c=this.qa)this.sa&&"/"!=c.charAt(0)&&b.push("/"),b.push(eb(c,"/"==c.charAt(0)?gb:hb,!0));(c=this.a.toString())&&b.push("?",c);(c=this.Ta)&&b.push("#",eb(c,ib));return b.join("")};
l.resolve=function(b){var c=this.clone();"data"===c.ta&&(c=new Wa);var d=!!b.ta;d?Ya(c,b.ta):d=!!b.bb;d?c.bb=b.bb:d=!!b.sa;d?c.sa=b.sa:d=null!=b.yb;var e=b.qa;if(d)Za(c,b.yb);else if(d=!!b.qa){if("/"!=e.charAt(0))if(this.sa&&!this.qa)e="/"+e;else{var f=c.qa.lastIndexOf("/");-1!=f&&(e=c.qa.substr(0,f+1)+e)}if(".."==e||"."==e)e="";else if(-1!=e.indexOf("./")||-1!=e.indexOf("/.")){f=0==e.lastIndexOf("/",0);e=e.split("/");for(var g=[],h=0;h<e.length;){var k=e[h++];"."==k?f&&h==e.length&&g.push(""):".."==
k?((1<g.length||1==g.length&&""!=g[0])&&g.pop(),f&&h==e.length&&g.push("")):(g.push(k),f=!0)}e=g.join("/")}}d?c.qa=e:d=""!==b.a.toString();d?$a(c,b.a.clone()):d=!!b.Ta;d&&(c.Ta=b.Ta);return c};l.clone=function(){return new Wa(this)};function Ya(b,c,d){b.ta=d?ab(c,!0):c;b.ta&&(b.ta=b.ta.replace(/:$/,""))}function Za(b,c){if(c){c=Number(c);if(isNaN(c)||0>c)throw Error("Bad port number "+c);b.yb=c}else b.yb=null}function $a(b,c,d){c instanceof bb?b.a=c:(d||(c=eb(c,jb)),b.a=new bb(c))}
function ab(b,c){return b?c?decodeURI(b):decodeURIComponent(b):""}function eb(b,c,d){return"string"==typeof b?(b=encodeURI(b).replace(c,kb),d&&(b=b.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b):null}function kb(b){b=b.charCodeAt(0);return"%"+(b>>4&15).toString(16)+(b&15).toString(16)}var fb=/[#\/\?@]/g,hb=/[#\?:]/g,gb=/[#\?]/g,jb=/[#\?@]/g,ib=/#/g;function bb(b){this.a=b||null}l=bb.prototype;l.ga=null;l.Rb=null;
l.add=function(b,c){if(!this.ga&&(this.ga={},this.Rb=0,this.a))for(var d=this.a.split("&"),e=0;e<d.length;e++){var f=d[e].indexOf("="),g=null;if(0<=f){var h=d[e].substring(0,f);g=d[e].substring(f+1)}else h=d[e];h=decodeURIComponent(h.replace(/\+/g," "));g=g||"";this.add(h,decodeURIComponent(g.replace(/\+/g," ")))}this.a=null;(d=this.ga.hasOwnProperty(b)&&this.ga[b])||(this.ga[b]=d=[]);d.push(c);this.Rb++;return this};
l.toString=function(){if(this.a)return this.a;if(!this.ga)return"";var b=[],c;for(c in this.ga)for(var d=encodeURIComponent(c),e=this.ga[c],f=0;f<e.length;f++){var g=d;""!==e[f]&&(g+="="+encodeURIComponent(e[f]));b.push(g)}return this.a=b.join("&")};l.clone=function(){var b=new bb;b.a=this.a;if(this.ga){var c={},d;for(d in this.ga)c[d]=this.ga[d].concat();b.ga=c;b.Rb=this.Rb}return b};function lb(b){this.b=b;this.a=null}lb.prototype.V=function(b){var c=this;this.stop();var d=!0,e=null;this.a=function(){window.clearTimeout(e);d=!1};e=window.setTimeout(function(){d&&c.b()},1E3*b);return this};lb.prototype.stop=function(){this.a&&(this.a(),this.a=null)};function D(b){this.b=b;this.a=null}z("shaka.util.Timer",D);D.prototype.tf=function(){this.stop();this.b();return this};D.prototype.tickNow=D.prototype.tf;D.prototype.V=function(b){var c=this;this.stop();this.a=(new lb(function(){c.b()})).V(b);return this};D.prototype.tickAfter=D.prototype.V;D.prototype.Ea=function(b){var c=this;this.stop();this.a=(new lb(function(){c.a.V(b);c.b()})).V(b);return this};D.prototype.tickEvery=D.prototype.Ea;D.prototype.stop=function(){this.a&&(this.a.stop(),this.a=null)};
D.prototype.stop=D.prototype.stop;var mb=window.performance&&window.performance.now?function(){return window.performance.now()}:function(){return Date.now()};D.now=mb;function nb(b,c){var d=ob();this.i=null==b.maxAttempts?d.maxAttempts:b.maxAttempts;this.f=null==b.baseDelay?d.baseDelay:b.baseDelay;this.h=null==b.fuzzFactor?d.fuzzFactor:b.fuzzFactor;this.g=null==b.backoffFactor?d.backoffFactor:b.backoffFactor;this.a=0;this.b=this.f;if(this.c=void 0===c?!1:c)this.a=1}
function pb(b){return v(function d(){var e,f;return y(d,function(d){switch(d.j){case 1:if(b.a>=b.i)if(b.c)b.a=1,b.b=b.f;else return d["return"](Promise.reject());e=b.a;b.a++;if(0==e)return d["return"]();f=b.b*(1+(2*Math.random()-1)*b.h);return w(d,new Promise(function(b){(new D(b)).V(f/1E3)}),2);case 2:b.b*=b.g,x(d)}})})}function ob(){return{maxAttempts:2,baseDelay:1E3,backoffFactor:2,fuzzFactor:.5,timeout:0}};function F(b,c,d,e){for(var f=[],g=3;g<arguments.length;++g)f[g-3]=arguments[g];this.severity=b;this.category=c;this.code=d;this.data=f;this.handled=!1}z("shaka.util.Error",F);F.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")};F.Severity={RECOVERABLE:1,CRITICAL:2};F.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9};
F.Code={UNSUPPORTED_SCHEME:1E3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,INVALID_TEXT_HEADER:2E3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,BUFFER_READ_OUT_OF_BOUNDS:3E3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,
MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,UNABLE_TO_GUESS_MANIFEST_TYPE:4E3,
DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,
HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_COULD_NOT_PARSE_SEGMENT_START_TIME:4030,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,HLS_AES_128_ENCRYPTION_NOT_SUPPORTED:4034,HLS_INTERNAL_SKIP_STREAM:4035,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6E3,
REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,LOAD_INTERRUPTED:7E3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,
CAST_API_UNAVAILABLE:8E3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9E3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,
MISSING_STORAGE_CELL:9013};function G(){var b,c,d=new Promise(function(d,f){b=d;c=f});d.resolve=b;d.reject=c;return d}G.prototype.resolve=function(){};G.prototype.reject=function(){};function H(b,c){this.promise=b;this.ud=c;this.a=!1}z("shaka.util.AbortableOperation",H);function qb(b){return new H(Promise.reject(b),function(){return Promise.resolve()})}H.failed=qb;function rb(){var b=Promise.reject(new F(2,7,7001));b["catch"](function(){});return new H(b,function(){return Promise.resolve()})}H.aborted=rb;function sb(b){return new H(Promise.resolve(b),function(){return Promise.resolve()})}H.completed=sb;
function vb(b){return new H(b,function(){return b["catch"](function(){})})}H.notAbortable=vb;H.prototype.abort=function(){this.a=!0;return this.ud()};H.prototype.abort=H.prototype.abort;function wb(b){return new H(Promise.all(b.map(function(b){return b.promise})),function(){return Promise.all(b.map(function(b){return b.abort()}))})}H.all=wb;H.prototype["finally"]=function(b){this.promise.then(function(){return b(!0)},function(){return b(!1)});return this};H.prototype["finally"]=H.prototype["finally"];
H.prototype.ca=function(b,c){function d(d){return function(k){if(f.a&&d)g.reject(h);else{var m=d?b:c;m?e=xb(m,k,g):(d?g.resolve:g.reject)(k)}}}function e(){g.reject(h);return f.abort()}var f=this,g=new G,h=new F(2,7,7001);this.promise.then(d(!0),d(!1));return new H(g,function(){return e()})};H.prototype.chain=H.prototype.ca;
function xb(b,c,d){try{var e=b(c);if(e&&e.promise&&e.abort)return d.resolve(e.promise),function(){return e.abort()};d.resolve(e);return function(){return Promise.resolve(e).then(function(){},function(){})}}catch(f){return d.reject(f),function(){return Promise.resolve()}}};function I(b,c){c=void 0===c?{}:c;for(var d in c)this[d]=c[d];this.defaultPrevented=this.cancelable=this.bubbles=!1;this.timeStamp=window.performance&&window.performance.now?window.performance.now():Date.now();this.type=b;this.isTrusted=!1;this.target=this.currentTarget=null;this.a=!1}I.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)};I.prototype.stopImmediatePropagation=function(){this.a=!0};I.prototype.stopPropagation=function(){};function yb(){this.a={}}l=yb.prototype;l.push=function(b,c){this.a.hasOwnProperty(b)?this.a[b].push(c):this.a[b]=[c]};l.get=function(b){return(b=this.a[b])?b.slice():null};l.remove=function(b,c){var d=this.a[b];if(d)for(var e=0;e<d.length;++e)d[e]==c&&(d.splice(e,1),--e)};l.forEach=function(b){for(var c in this.a)b(c,this.a[c])};l.size=function(){return Object.keys(this.a).length};function zb(){this.oc=new yb;this.pd=this}zb.prototype.addEventListener=function(b,c){this.oc.push(b,c)};zb.prototype.removeEventListener=function(b,c){this.oc.remove(b,c)};zb.prototype.dispatchEvent=function(b){for(var c=this.oc.get(b.type)||[],d=0;d<c.length;++d){b.target=this.pd;b.currentTarget=this.pd;var e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(this,b)}catch(f){A.error("Uncaught exception in event handler",f,f?f.message:null,f?f.stack:null)}if(b.a)break}return b.defaultPrevented};function Ab(b){function c(b){switch(typeof b){case "undefined":case "boolean":case "number":case "string":case "symbol":case "function":return b;default:if(!b||b.buffer&&b.buffer.constructor==ArrayBuffer)return b;if(d.has(b))return null;var e=b.constructor==Array;if(b.constructor!=Object&&!e)return null;d.add(b);var g=e?[]:{},h;for(h in b)g[h]=c(b[h]);e&&(g.length=b.length);return g}}var d=new Set;return c(b)};function Bb(b,c){var d=b.indexOf(c);-1<d&&b.splice(d,1)}function Cb(b,c){var d=0;b.forEach(function(b){d+=c(b)?1:0});return d};function Db(){this.a=[]}function Eb(b,c){b.a.push(c["finally"](function(){Bb(b.a,c)}))}Db.prototype.destroy=function(){var b=[];this.a.forEach(function(c){c.promise["catch"](function(){});b.push(c.abort())});this.a=[];return Promise.all(b)};function K(b){zb.call(this);this.g=!1;this.h=new Db;this.c=new Set;this.f=new Set;this.a={};this.b=b||null}Oa(K,zb);z("shaka.net.NetworkingEngine",K);K.RequestType={MANIFEST:0,SEGMENT:1,LICENSE:2,APP:3,TIMING:4};K.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:3};var Fb={};function Gb(b,c,d){d=d||3;var e=Fb[b];if(!e||d>=e.priority)Fb[b]={priority:d,Pc:c}}K.registerScheme=Gb;K.unregisterScheme=function(b){delete Fb[b]};
K.prototype.af=function(b,c,d){d=d||3;var e=this.a[b];if(!e||d>=e.priority)this.a[b]={priority:d,Pc:c}};K.prototype.registerScheme=K.prototype.af;K.prototype.yf=function(b){delete this.a[b]};K.prototype.unregisterScheme=K.prototype.yf;K.prototype.Ze=function(b){this.c.add(b)};K.prototype.registerRequestFilter=K.prototype.Ze;K.prototype.wf=function(b){this.c["delete"](b)};K.prototype.unregisterRequestFilter=K.prototype.wf;K.prototype.Yd=function(){this.c.clear()};
K.prototype.clearAllRequestFilters=K.prototype.Yd;K.prototype.$e=function(b){this.f.add(b)};K.prototype.registerResponseFilter=K.prototype.$e;K.prototype.xf=function(b){this.f["delete"](b)};K.prototype.unregisterResponseFilter=K.prototype.xf;K.prototype.Zd=function(){this.f.clear()};K.prototype.clearAllResponseFilters=K.prototype.Zd;K.defaultRetryParameters=function(){return ob()};
function Hb(b,c,d,e,f){return{uris:b,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:c,licenseRequestType:null,sessionId:null,stream:void 0===d?null:d,streamDataCallback:void 0===e?null:e,zd:void 0===f?null:f}}K.makeRequest=Hb;K.prototype.destroy=function(){this.g=!0;this.c.clear();this.f.clear();this.a={};return this.h.destroy()};K.prototype.destroy=K.prototype.destroy;
K.prototype.request=function(b,c){var d=this,e=new Ib;if(this.g){var f=Promise.reject(new F(2,7,7001));f["catch"](function(){});return new Jb(f,function(){return Promise.resolve()},e,c)}c.method=c.method||"GET";c.headers=c.headers||{};c.retryParameters=c.retryParameters?Ab(c.retryParameters):ob();c.uris=Ab(c.uris);f=Kb(this,b,c);var g=f.ca(function(){return Lb(d,b,c,new nb(c.retryParameters,!1),0,null,e)}),h=g.ca(function(c){return Mb(d,b,c)}),k=Date.now(),m=0;f.promise.then(function(){m=Date.now()-
k},function(){});var n=0;g.promise.then(function(){n=Date.now()},function(){});f=h.ca(function(c){var e=Date.now()-n,f=c.response;f.timeMs+=m;f.timeMs+=e;c.Ae||!d.b||f.fromCache||1!=b||d.b(f.timeMs,f.data.byteLength);return f},function(b){b&&(b.severity=2);throw b;});f=new Jb(f.promise,f.ud,e,c);Eb(this.h,f);return f};K.prototype.request=K.prototype.request;
function Kb(b,c,d){var e=sb(void 0),f={};b=r(b.c);for(var g=b.next();!g.done;f={Uc:f.Uc},g=b.next())f.Uc=g.value,e=e.ca(function(b){return function(){return b.Uc(c,d)}}(f));return e.ca(void 0,function(b){if(b&&7001==b.code)throw b;throw new F(2,1,1006,b);})}
function Lb(b,c,d,e,f,g,h){function k(){J||1!==c||0===B||(b.b(B,C),p=!0,C=B=0)}var m=new Wa(d.uris[f]),n=m.ta,p=!1;n||(n=location.protocol,n=n.slice(0,-1),Ya(m,n),d.uris[f]=m.toString());n=n.toLowerCase();var q=Fb[n],t=q?q.Pc:null;q=q?q.priority:null;var u=b.a[n];n=u?u.Pc:null;u=u?u.priority:null;if(t||n)!t&&n?t=n:t&&n&&u>=q&&(t=n);else return qb(new F(2,1,1E3,m));var E,B=0,C=0,J=!0;return vb(pb(e)).ca(function(){if(b.g)return rb();E=mb();var e=new Uint8Array(0),g=d.streamDataCallback,m,n,q,u,za=
!0,W,Ua=0;g&&(d.streamDataCallback=function(b,c){g(b,c);e=L.concat(e,c);var d=!1,f=0;(new M).F("uuid",function(b){if(b.isComplete){f=b.size+b.start;d=!0;var c=b.reader.Ed();b=b.reader.zb();"c4eac1fc-0ad8-4676-9656-69552eb3252f"===c&&J?(m=b,q=n=mb(),J=!1):"bcfca253-398b-4a5b-9a92-ec8f7d89e61d"===c&&(u=b-m,m=b)}}).F("moof",function(b){b.isComplete&&(f=b.size+b.start,d=!0,C+=b.size)}).F("mdat",function(b){if(!J){if(za){za=!1;W=b.loadedSize;var c=mb(),e=c-q;q=c;e>=u?(B+=e-u,C+=b.loadedSize):50>u&&(B+=
e,C+=b.loadedSize)}else B+=mb()-n,c=b.loadedSize-W,W=b.loadedSize,C+=c;n=mb();b.isComplete&&(za=!0,f=b.size+b.start,d=!0,Ua++)}}).parse(e,!0,!0);k();d&&(e=e.subarray(f))});return t(d.uris[f],d,c,function(d,e,f){b.b&&1===c&&(h.a=f,J&&(b.b(d,e),p=!0))})}).ca(function(b){k();void 0==b.timeMs&&(b.timeMs=mb()-E);return{response:b,Ae:p}},function(k){if(k&&7001==k.code)throw k;if(b.g)return rb();if(k&&1==k.severity){b.dispatchEvent(new I("retry",{error:k instanceof F?k:null}));if(d.zd&&d.zd())throw new F(2,
7,7001);f=(f+1)%d.uris.length;return Lb(b,c,d,e,f,k,h)}throw k||g;})}function Mb(b,c,d){var e=sb(void 0);b=r(b.f);for(var f=b.next();!f.done;f=b.next())e=e.ca(f.value.bind(null,c,d.response));return e.ca(function(){return d},function(b){if(b&&7001==b.code)throw b;var c=2;b instanceof F&&(c=b.severity);throw new F(c,1,1007,b);})}function Ib(){this.a=0}K.NumBytesRemainingClass=Ib;function Jb(b,c,d,e){H.call(this,b,c);this.b=d;this.c=e}var Nb=Jb;Nb.prototype=ma(H.prototype);
Nb.prototype.constructor=Nb;if(sa)sa(Nb,H);else for(var Ob in H)if("prototype"!=Ob)if(Object.defineProperties){var Pb=Object.getOwnPropertyDescriptor(H,Ob);Pb&&Object.defineProperty(Nb,Ob,Pb)}else Nb[Ob]=H[Ob];Nb.sf=H.prototype;K.PendingRequest=Jb;Jb.all=wb;Jb.notAbortable=vb;Jb.completed=sb;Jb.aborted=rb;Jb.failed=qb;function Qb(){}z("shaka.util.IReleasable",Qb);Qb.prototype.release=function(){};function N(){this.a=new yb}z("shaka.util.EventManager",N);N.prototype.release=function(){this.Ib();this.a=null};N.prototype.release=N.prototype.release;N.prototype.B=function(b,c,d,e){this.a&&(b=new Rb(b,c,d,e),this.a.push(c,b))};N.prototype.listen=N.prototype.B;N.prototype.pa=function(b,c,d,e){function f(e){g.ja(b,c,f);d(e)}var g=this;this.B(b,c,f,e)};N.prototype.listenOnce=N.prototype.pa;
N.prototype.ja=function(b,c,d){if(this.a){var e=this.a.get(c)||[];e=r(e);for(var f=e.next();!f.done;f=e.next())f=f.value,f.target!=b||d!=f.listener&&d||(f.ja(),this.a.remove(c,f))}};N.prototype.unlisten=N.prototype.ja;N.prototype.Ib=function(){if(this.a){var b=this.a,c=[],d;for(d in b.a)c.push.apply(c,b.a[d]);b=r(c);for(c=b.next();!c.done;c=b.next())c.value.ja();this.a.a={}}};N.prototype.removeAll=N.prototype.Ib;
function Rb(b,c,d,e){this.target=b;this.type=c;this.listener=d;this.a=Sb(b,e);this.target.addEventListener(c,d,this.a)}Rb.prototype.ja=function(){this.target.removeEventListener(this.type,this.listener,this.a);this.listener=this.target=null;this.a=!1};Rb.prototype.unlisten=Rb.prototype.ja;function Sb(b,c){if(void 0==c)return!1;if("boolean"==typeof c)return c;var d=new Set(["passive","capture"]);Object.keys(c).filter(function(b){return!d.has(b)});return Tb(b)?c:c.capture||!1}
function Tb(b){var c=Ub;if(void 0==c){c=!1;try{var d={},e={get:function(){c=!0;return!1}};Object.defineProperty(d,"passive",e);Object.defineProperty(d,"capture",e);e=function(){};b.addEventListener("test",e,d);b.removeEventListener("test",e,d)}catch(f){c=!1}Ub=c}return c||!1}var Ub=void 0;function Vb(b){b=Yb(b);return(new Wa(b)).sa}z("shaka.util.FairPlayUtils.defaultGetContentId",Vb);function Zb(b,c,d){function e(b){(new DataView(f.buffer)).setUint32(g,b.byteLength,!0);g+=4;f.set(b,g);g+=b.byteLength}if(!d||!d.byteLength)throw new F(2,6,6015);c="string"==typeof c?new Uint8Array($b(c,!0)):new Uint8Array(c);b=Yb(b);b=$b(b,!0);var f=new Uint8Array(12+b.byteLength+c.byteLength+d.byteLength),g=0;e(new Uint8Array(b));e(c);e(new Uint8Array(d));return f}
z("shaka.util.FairPlayUtils.initDataTransform",Zb);function ac(b,c){for(var d=r(b),e=d.next();!e.done;e=d.next())if(!c(e.value))return!1;return!0};function bc(b){var c=new Map;Object.keys(b).forEach(function(d){c.set(d,b[d])});return c}function cc(b){var c={};b.forEach(function(b,e){c[e]=b});return c};function dc(b,c){var d=b;c&&(d+='; codecs="'+c+'"');return d}function ec(b){var c=[b.mimeType];fc.forEach(function(d,e){var f=b[e];f&&c.push(d+'="'+f+'"')});return c.join(";")}function gc(b){b=b.split(".");var c=b[0];b.pop();return[c,b.join(".")]}var fc=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");function hc(){return window.MediaSource&&MediaSource.isTypeSupported?!0:!1}function ic(b){return""!=jc().canPlayType(b)}function kc(){return navigator.userAgent.match(/Edge?\//)?!0:!1}function lc(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!mc("Tizen")}function nc(){if(!lc())return null;var b=navigator.userAgent.match(/Version\/(\d+)/);return b?parseInt(b[1],10):(b=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(b[1],10):null}
function mc(b){return(navigator.userAgent||"").includes(b)}function jc(){if(oc)return oc;pc||(pc=new D(function(){oc=null}));(oc=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(oc=document.createElement("video"));pc.V(1);return oc}var pc=null,oc=null;function qc(b){if(!b)return"";b=new Uint8Array(b);239==b[0]&&187==b[1]&&191==b[2]&&(b=b.subarray(3));b=rc(b);b=escape(b);try{return decodeURIComponent(b)}catch(c){throw new F(2,2,2004);}}z("shaka.util.StringUtils.fromUTF8",qc);
function sc(b,c,d){if(!b)return"";if(!d&&0!=b.byteLength%2)throw A.error("Data has an incorrect length, must be even."),new F(2,2,2004);if(b instanceof ArrayBuffer)var e=b;else d=new Uint8Array(b.byteLength),d.set(new Uint8Array(b)),e=d.buffer;b=Math.floor(b.byteLength/2);d=new Uint16Array(b);e=new DataView(e);for(var f=0;f<b;f++)d[f]=e.getUint16(2*f,c);return rc(d)}z("shaka.util.StringUtils.fromUTF16",sc);
function Yb(b){var c=new Uint8Array(b);if(239==c[0]&&187==c[1]&&191==c[2])return qc(c);if(254==c[0]&&255==c[1])return sc(c.subarray(2),!1);if(255==c[0]&&254==c[1])return sc(c.subarray(2),!0);var d=function(b,c){return b.byteLength<=c||32<=b[c]&&126>=b[c]}.bind(null,c);A.debug("Unable to find byte-order-mark, making an educated guess.");if(0==c[0]&&0==c[2])return sc(b,!1);if(0==c[1]&&0==c[3])return sc(b,!0);if(d(0)&&d(1)&&d(2)&&d(3))return qc(b);throw new F(2,2,2003);}
z("shaka.util.StringUtils.fromBytesAutoDetect",Yb);function tc(b){b=encodeURIComponent(b);b=unescape(b);for(var c=new Uint8Array(b.length),d=0;d<b.length;++d)c[d]=b.charCodeAt(d);return c.buffer}z("shaka.util.StringUtils.toUTF8",tc);function $b(b,c){for(var d=new Uint8Array(2*b.length),e=new DataView(d.buffer),f=0;f<b.length;++f)e.setUint16(2*f,b.charCodeAt(f),c);return d.buffer}z("shaka.util.StringUtils.toUTF16",$b);
function rc(b){if(!uc)for(var c=function(b){try{var c=new Uint8Array(b);return 0<String.fromCharCode.apply(null,c).length}catch(g){return!1}},d={size:65536};0<d.size;d={size:d.size},d.size/=2)if(c(d.size)){uc=function(b){return function(c){for(var d="",e=0;e<c.length;e+=b.size)d+=String.fromCharCode.apply(null,c.subarray(e,e+b.size));return d}}(d);break}return uc(b)}var uc=null;z("shaka.util.StringUtils.resetFromCharCode",function(){uc=null});var L={gc:function(b,c){var d=rc(b);c=void 0==c?!0:c;d=window.btoa(d).replace(/\+/g,"-").replace(/\//g,"_");return c?d:d.replace(/=*$/,"")}};z("shaka.util.Uint8ArrayUtils.toBase64",L.gc);L.Ja=function(b){b=window.atob(b.replace(/-/g,"+").replace(/_/g,"/"));for(var c=new Uint8Array(b.length),d=0;d<b.length;++d)c[d]=b.charCodeAt(d);return c};z("shaka.util.Uint8ArrayUtils.fromBase64",L.Ja);
L.xc=function(b){for(var c=new Uint8Array(b.length/2),d=0;d<b.length;d+=2)c[d/2]=window.parseInt(b.substr(d,2),16);return c};z("shaka.util.Uint8ArrayUtils.fromHex",L.xc);L.hc=function(b){for(var c="",d=0;d<b.length;++d){var e=b[d].toString(16);1==e.length&&(e="0"+e);c+=e}return c};z("shaka.util.Uint8ArrayUtils.toHex",L.hc);L.Ia=function(b,c){if(!b&&!c)return!0;if(!b||!c||b.length!=c.length)return!1;for(var d=0;d<b.length;++d)if(b[d]!=c[d])return!1;return!0};z("shaka.util.Uint8ArrayUtils.equal",L.Ia);
L.concat=function(b){for(var c=[],d=0;d<arguments.length;++d)c[d]=arguments[d];for(var e=d=0;e<c.length;++e)d+=c[e].length;d=new Uint8Array(d);for(var f=e=0;f<c.length;++f)d.set(c[f],e),e+=c[f].length;return d};z("shaka.util.Uint8ArrayUtils.concat",L.concat);function vc(b,c){var d=this;c=void 0===c?1:c;this.C=b;this.u=new Set;this.h=this.m=null;this.ba=!1;this.M=0;this.a=null;this.i=new N;this.b=new Map;this.v=[];this.o=new G;this.f=null;this.g=function(c){d.o.reject(c);b.onError(c)};this.na=new Map;this.fa=new Map;this.Z=new D(function(){return wc(d)});this.c=!1;this.la=new G;this.O=!1;this.K=[];this.ma=!1;this.ka=(new D(function(){xc(d)})).Ea(c);this.o["catch"](function(){})}l=vc.prototype;
l.destroy=function(){var b=this;return v(function d(){return y(d,function(d){switch(d.j){case 1:if(b.c)return w(d,b.la,0);b.c=!0;return w(d,yc(b),4);case 4:b.la.resolve(),d.j=0}})})};
function yc(b){return v(function d(){return y(d,function(d){switch(d.j){case 1:return b.i.release(),b.i=null,b.o.reject(),b.ka.stop(),b.ka=null,b.Z.stop(),b.Z=null,w(d,zc(b),2);case 2:if(!b.h){d.j=3;break}d.U=4;return w(d,b.h.setMediaKeys(null),6);case 6:wa(d,5);break;case 4:Ba(d);case 5:b.h=null;case 3:b.a=null,b.u.clear(),b.m=null,b.v=[],b.f=null,b.g=null,b.C=null,x(d)}})})}l.configure=function(b){this.f=b};function Ac(b,c,d){b.v=d;b.O=0<d.length;return Bc(b,c)}
function Bc(b,c){var d=Cc(b);if(d)for(var e=r(c),f=e.next();!f.done;f=e.next())f.value.drmInfos=[d];d=c.some(function(b){return 0<b.drmInfos.length});d||(f=bc(b.f.servers),Dc(c,f));e=r(c);for(f=e.next();!f.done;f=e.next()){f=r(f.value.drmInfos);for(var g=f.next();!g.done;g=f.next())Ec(g.value,bc(b.f.servers),bc(b.f.advanced||{}))}f=Fc(b,c);if(!f.size)return b.ba=!0,Promise.resolve();f=Gc(b,f);return d?f:f["catch"](function(){})}
l.Cb=function(b){var c=this;if(!this.m)return this.i.pa(b,"encrypted",function(){c.g(new F(2,6,6010))}),Promise.resolve();this.h=b;this.i.pa(this.h,"play",function(){for(var b=0;b<c.K.length;b++)Hc(c,c.K[b]);c.ma=!0;c.K=[]});"webkitCurrentPlaybackTargetIsWireless"in this.h&&this.i.B(this.h,"webkitcurrentplaybacktargetiswirelesschanged",function(){return zc(c)});b=this.h.setMediaKeys(this.m);b=b["catch"](function(b){return Promise.reject(new F(2,6,6003,b.message))});var d=Ic(this);return Promise.all([b,
d]).then(function(){if(c.c)return Promise.reject();Jc(c);c.a.initData.length||c.v.length||c.i.B(c.h,"encrypted",function(b){return Kc(c,b.initDataType,new Uint8Array(b.initData))})})["catch"](function(b){if(!c.c)return Promise.reject(b)})};
function Ic(b){return v(function d(){var e,f;return y(d,function(d){switch(d.j){case 1:if(!(b.m&&b.a&&b.a.serverCertificate&&b.a.serverCertificate.length)){d.j=0;break}d.U=3;return w(d,b.m.setServerCertificate(b.a.serverCertificate),5);case 5:(e=d.N)||A.l("Server certificates are not supported by the key system.  The server certificate has been ignored.");wa(d,0);break;case 3:return f=Ba(d),d["return"](Promise.reject(new F(2,6,6004,f.message)))}})})}
function Jc(b){var c=b.a?b.a.initData:[];c.forEach(function(c){return Kc(b,c.initDataType,c.initData)});b.v.forEach(function(c){return Lc(b,c)});c.length||b.v.length||b.o.resolve()}function Kc(b,c,d){var e=b.b.values();e=r(e);for(var f=e.next();!f.done;f=e.next())if(L.Ia(d,f.value.initData)&&!mc("Tizen 2")){A.debug("Ignoring duplicate init data.");return}Mc(b,c,d)}function Nc(b){return b?b.keySystem:""}
l.Ac=function(){var b=Infinity,c=this.b.keys();c=r(c);for(var d=c.next();!d.done;d=c.next())d=d.value,isNaN(d.expiration)||(b=Math.min(b,d.expiration));return b};
function Fc(b,c){for(var d=new Set,e=r(c),f=e.next();!f.done;f=e.next()){var g=r(f.value.drmInfos);for(f=g.next();!f.done;f=g.next())d.add(f.value)}e=r(d);for(f=e.next();!f.done;f=e.next())Ec(f.value,bc(b.f.servers),bc(b.f.advanced||{}));g=b.O?"required":"optional";var h=b.O?["persistent-license"]:["temporary"];e=new Map;d=r(d);for(f=d.next();!f.done;f=d.next())f=f.value,e.set(f.keySystem,{audioCapabilities:[],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:g,sessionTypes:h,
label:f.keySystem,drmInfos:[]});d=r(c);for(f=d.next();!f.done;f=d.next()){f=f.value;g=f.audio;h=f.video;var k=g?dc(g.mimeType,g.codecs):"",m=h?dc(h.mimeType,h.codecs):"",n=r(f.drmInfos);for(f=n.next();!f.done;f=n.next()){f=f.value;var p=e.get(f.keySystem);p.drmInfos.push(f);f.distinctiveIdentifierRequired&&(p.distinctiveIdentifier="required");f.persistentStateRequired&&(p.persistentState="required");g&&p.audioCapabilities.push({robustness:f.audioRobustness||"",contentType:k});h&&p.videoCapabilities.push({robustness:f.videoRobustness||
"",contentType:m})}}return e}
function Gc(b,c){if(1==c.size&&c.has(""))return Promise.reject(new F(2,6,6E3));for(var d=r(c.values()),e=d.next();!e.done;e=d.next())e=e.value,0==e.audioCapabilities.length&&delete e.audioCapabilities,0==e.videoCapabilities.length&&delete e.videoCapabilities;var f=d=new G;[!0,!1].forEach(function(b){var d=this;c.forEach(function(c,e){c.drmInfos.some(function(b){return!!b.licenseServerUri})==b&&(f=f["catch"](function(){if(!this.c)return navigator.requestMediaKeySystemAccess(e,[c])}.bind(d)))})}.bind(b));
f=f["catch"](function(){return Promise.reject(new F(2,6,6001))});f=f.then(function(b){if(this.c)return Promise.reject();this.u.clear();var d=b.getConfiguration(),e=d.videoCapabilities||[],f=r(d.audioCapabilities||[]);for(d=f.next();!d.done;d=f.next())this.u.add(d.value.contentType.toLowerCase());e=r(e);for(d=e.next();!d.done;d=e.next())this.u.add(d.value.contentType.toLowerCase());e=b.keySystem;d=c.get(b.keySystem);f=[];var g=[],p=[],q=[];Pc(d.drmInfos,f,g,p,q);1<g.length&&A.l("Multiple unique server certificates found! Only the first will be used.");
1<f.length&&A.l("Multiple unique license server URIs found! Only the first will be used.");this.a={keySystem:e,licenseServerUri:f[0],distinctiveIdentifierRequired:"required"==d.distinctiveIdentifier,persistentStateRequired:"required"==d.persistentState,audioRobustness:(d.audioCapabilities?d.audioCapabilities[0].robustness:"")||"",videoRobustness:(d.videoCapabilities?d.videoCapabilities[0].robustness:"")||"",serverCertificate:g[0],initData:p,keyIds:q};return this.a.licenseServerUri?b.createMediaKeys():
Promise.reject(new F(2,6,6012,this.a.keySystem))}.bind(b)).then(function(b){if(this.c)return Promise.reject();A.info("Created MediaKeys object for key system",this.a.keySystem);this.m=b;this.ba=!0}.bind(b))["catch"](function(b){if(!this.c)return this.a=null,this.u.clear(),b instanceof F?Promise.reject(b):Promise.reject(new F(2,6,6002,b.message))}.bind(b));d.reject();return f}
function Cc(b){b=bc(b.f.clearKeys);if(0==b.size)return null;var c=[],d=[];b.forEach(function(b,e){var f=L.xc(e),g=L.xc(b);f={kty:"oct",kid:L.gc(f,!1),k:L.gc(g,!1)};c.push(f);d.push(f.kid)});b=JSON.stringify({keys:c});var e=JSON.stringify({kids:d});e=[{initData:new Uint8Array(tc(e)),initDataType:"keyids"}];return{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+window.btoa(b),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",
serverCertificate:null,initData:e,keyIds:[]}}
function Lc(b,c){try{A.A("Attempting to load an offline session",c);var d=b.m.createSession("persistent-license")}catch(g){var e=new F(2,6,6005,g.message);b.g(e);return Promise.reject(e)}b.i.B(d,"message",b.Ad.bind(b));b.i.B(d,"keystatuseschange",b.yd.bind(b));var f={initData:null,loaded:!1,Nc:Infinity,Pa:null};b.b.set(d,f);return d.load(c).then(function(b){if(this.c)return Promise.reject();A.I("Loaded offline session",c,b);if(b)return f.loaded=!0,Qc(this)&&this.o.resolve(),d;this.b["delete"](d);
this.g(new F(2,6,6013))}.bind(b),function(b){this.c||(this.b["delete"](d),this.g(new F(2,6,6005,b.message)))}.bind(b))}
function Mc(b,c,d){try{if(b.O){A.A("Creating new persistent session");var e=b.m.createSession("persistent-license")}else A.A("Creating new temporary session"),e=b.m.createSession()}catch(f){b.g(new F(2,6,6005,f.message));return}b.i.B(e,"message",b.Ad.bind(b));b.i.B(e,"keystatuseschange",b.yd.bind(b));b.b.set(e,{initData:d,loaded:!1,Nc:Infinity,Pa:null});try{d=b.f.initDataTransform(d,b.a)}catch(f){c=f;f instanceof F||(c=new F(2,6,6016,f));b.g(c);return}e.generateRequest(c,d)["catch"](function(c){if(!b.c){b.b["delete"](e);
if(c.errorCode&&c.errorCode.systemCode){var d=c.errorCode.systemCode;0>d&&(d+=Math.pow(2,32));d="0x"+d.toString(16)}b.g(new F(2,6,6006,c.message,c,d))}})}function Rc(b,c){if(Nc(c).startsWith("com.apple.fps")){var d=c.serverCertificate,e=Vb(b);b=Zb(b,e,d)}return b}l.Ad=function(b){this.h&&this.f.delayLicenseRequestUntilPlayed&&this.h.paused&&!this.ma?this.K.push(b):Hc(this,b)};
function Hc(b,c){var d=c.target;A.A("Sending license request for session",d.sessionId,"of type",c.messageType);var e=b.b.get(d),f=b.a.licenseServerUri,g=b.f.advanced[b.a.keySystem];"individualization-request"==c.messageType&&g&&g.individualizationServer&&(f=g.individualizationServer);f=Hb([f],b.f.retryParameters);f.body=c.message;f.method="POST";f.licenseRequestType=c.messageType;f.sessionId=d.sessionId;"com.microsoft.playready"!=b.a.keySystem&&"com.chromecast.playready"!=b.a.keySystem||Sc(f);b.a.keySystem.startsWith("com.apple.fps")&&
b.f.fairPlayTransform&&Tc(f);var h=Date.now();b.C.Zb.request(2,f).promise.then(function(b){if(this.c)return Promise.reject();this.a.keySystem.startsWith("com.apple.fps")&&this.f.fairPlayTransform&&Uc(b);this.M+=(Date.now()-h)/1E3;A.A("Updating session",d.sessionId);return d.update(b.data).then(function(){var b=this;this.C.onEvent(new I("drmsessionupdate"));e&&(e.Pa&&e.Pa.resolve(),(new D(function(){e.loaded=!0;Qc(b)&&b.o.resolve()})).V(Vc))}.bind(this))}.bind(b),function(b){this.c||(b=new F(2,6,6007,
b),this.g(b),e&&e.Pa&&e.Pa.reject(b))}.bind(b))["catch"](function(b){this.c||(b=new F(2,6,6008,b.message),this.g(b),e&&e.Pa&&e.Pa.reject(b))}.bind(b))}
function Sc(b){var c=sc(b.body,!0,!0);if(c.includes("PlayReadyKeyMessage")){A.debug("Unwrapping PlayReady request.");c=(new DOMParser).parseFromString(c,"application/xml");for(var d=c.getElementsByTagName("HttpHeader"),e=0;e<d.length;++e)b.headers[d[e].getElementsByTagName("name")[0].textContent]=d[e].getElementsByTagName("value")[0].textContent;b.body=L.Ja(c.getElementsByTagName("Challenge")[0].textContent).buffer}else A.debug("PlayReady request is already unwrapped."),b.headers["Content-Type"]=
"text/xml; charset=utf-8"}function Tc(b){var c=new Uint8Array(b.body);c="spc="+L.gc(c);b.headers["Content-Type"]="application/x-www-form-urlencoded";b.body=tc(c)}function Uc(b){try{var c=qc(b.data)}catch(d){return}c=c.trim();"<ckc>"===c.substr(0,5)&&"</ckc>"===c.substr(-6)&&(c=c.slice(5,-6));try{c=JSON.parse(c).ckc}catch(d){}b.data=L.Ja(c).buffer}
l.yd=function(b){b=b.target;A.I("Key status changed for session",b.sessionId);var c=this.b.get(b),d=!1;b.keyStatuses.forEach(function(b,e){if("string"==typeof e){var f=e;e=b;b=f}if("com.microsoft.playready"==this.a.keySystem&&16==e.byteLength&&(mc("Trident/")||kc())){f=new DataView(e);var g=f.getUint32(0,!0),m=f.getUint16(4,!0),n=f.getUint16(6,!0);f.setUint32(0,g,!1);f.setUint16(4,m,!1);f.setUint16(6,n,!1)}"com.microsoft.playready"==this.a.keySystem&&"status-pending"==b&&(b="usable");"status-pending"!=
b&&(c.loaded=!0);"expired"==b&&(d=!0);f=L.hc(new Uint8Array(e));this.na.set(f,b)}.bind(this));var e=b.expiration-Date.now();(0>e||d&&1E3>e)&&c&&!c.Pa&&(A.debug("Session has expired",b.sessionId),this.b["delete"](b),b.close()["catch"](function(){}));Qc(this)&&(this.o.resolve(),this.Z.V(Wc))};function wc(b){var c=b.na,d=b.fa;d.clear();c.forEach(function(b,c){return d.set(c,b)});c=Array.from(d.values());c.length&&c.every(function(b){return"expired"==b})&&b.g(new F(2,6,6014));b.C.xd(cc(d))}
function Xc(){function b(b){return v(function h(){var c,f,n;return y(h,function(h){switch(h.j){case 1:return h.U=2,w(h,navigator.requestMediaKeySystemAccess(b,d),4);case 4:return c=h.N,n=(f=c.getConfiguration().sessionTypes)?f.includes("persistent-license"):!1,mc("Tizen 3")&&(n=!1),e.set(b,{persistentState:n}),w(h,c.createMediaKeys(),5);case 5:wa(h,0);break;case 2:Ba(h),e.set(b,null),x(h)}})})}var c=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],d=[{videoCapabilities:c,
persistentState:"required",sessionTypes:["persistent-license"]},{videoCapabilities:c}],e=new Map;c="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.apple.fps.3_0 com.apple.fps.2_0 com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" ").map(function(c){return b(c)});return Promise.all(c).then(function(){return cc(e)})}
function Yc(b,c){var d=c.audio,e=c.video;if(d&&d.encrypted&&!kc()&&!b.u.has(dc(d.mimeType,d.codecs).toLowerCase())||e&&e.encrypted&&!kc()&&!b.u.has(dc(e.mimeType,e.codecs).toLowerCase()))return!1;var f=Nc(b.a);return 0==c.drmInfos.length||c.drmInfos.some(function(b){return b.keySystem==f})}
function Zc(b,c){if(!b.length)return c;if(!c.length)return b;for(var d=[],e=0;e<b.length;e++)for(var f=0;f<c.length;f++)if(b[e].keySystem==c[f].keySystem){var g=b[e];f=c[f];var h=[];h=h.concat(g.initData||[]);h=h.concat(f.initData||[]);var k=[];k=k.concat(g.keyIds);k=k.concat(f.keyIds);d.push({keySystem:g.keySystem,licenseServerUri:g.licenseServerUri||f.licenseServerUri,distinctiveIdentifierRequired:g.distinctiveIdentifierRequired||f.distinctiveIdentifierRequired,persistentStateRequired:g.persistentStateRequired||
f.persistentStateRequired,videoRobustness:g.videoRobustness||f.videoRobustness,audioRobustness:g.audioRobustness||f.audioRobustness,serverCertificate:g.serverCertificate||f.serverCertificate,initData:h,keyIds:k});break}return d}
function $c(b){return v(function d(){var e;return y(d,function(d){switch(d.j){case 1:return e=new Promise(function(b,d){(new D(d)).V(ad)}),d.U=2,w(d,Promise.race([Promise.all([b.close(),b.closed]),e]),4);case 4:wa(d,0);break;case 2:Ba(d),A.l("Timeout waiting for session close"),x(d)}})})}
function zc(b){return v(function d(){var e;return y(d,function(d){switch(d.j){case 1:return e=Array.from(b.b.keys()),b.b.clear(),w(d,Promise.all(e.map(function(b){return v(function k(){return y(k,function(d){switch(d.j){case 1:return A.A("Closing session",b.sessionId),d.U=2,w(d,$c(b),4);case 4:wa(d,0);break;case 2:Ba(d),x(d)}})})})),0)}})})}function xc(b){b.b.forEach(function(c,d){var e=c.Nc,f=d.expiration;isNaN(f)&&(f=Infinity);f!=e&&(b.C.onExpirationUpdated(d.sessionId,f),c.Nc=f)})}
function Qc(b){b=b.b.values();return ac(b,function(b){return b.loaded})}function Dc(b,c){var d=[];c.forEach(function(b,c){d.push({keySystem:c,licenseServerUri:b,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],keyIds:[]})});for(var e=r(b),f=e.next();!f.done;f=e.next())f.value.drmInfos=d}
function Pc(b,c,d,e,f){b.forEach(function(b){c.includes(b.licenseServerUri)||c.push(b.licenseServerUri);b.serverCertificate&&(d.some(function(c){return L.Ia(c,b.serverCertificate)})||d.push(b.serverCertificate));b.initData&&b.initData.forEach(function(b){e.some(function(c){return c.keyId&&c.keyId==b.keyId?!0:c.initDataType==b.initDataType&&L.Ia(c.initData,b.initData)})||e.push(b)});if(b.keyIds)for(var g=0;g<b.keyIds.length;++g)f.includes(b.keyIds[g])||f.push(b.keyIds[g])})}
function Ec(b,c,d){if(b.keySystem&&("org.w3.clearkey"!=b.keySystem||!b.licenseServerUri)){c.size&&(c=c.get(b.keySystem)||"",b.licenseServerUri=c);b.keyIds||(b.keyIds=[]);if(d=d.get(b.keySystem))b.distinctiveIdentifierRequired||(b.distinctiveIdentifierRequired=d.distinctiveIdentifierRequired),b.persistentStateRequired||(b.persistentStateRequired=d.persistentStateRequired),b.videoRobustness||(b.videoRobustness=d.videoRobustness),b.audioRobustness||(b.audioRobustness=d.audioRobustness),b.serverCertificate||
(b.serverCertificate=d.serverCertificate);window.cast&&window.cast.__platform__&&"com.microsoft.playready"==b.keySystem&&(b.keySystem="com.chromecast.playready")}}var ad=1,Vc=5,Wc=.5;function bd(){this.a=new muxjs.mp4.CaptionParser;this.g=[];this.f={}}bd.prototype.init=function(b){var c=muxjs.mp4.probe;b=new Uint8Array(b);this.g=c.videoTrackIds(b);this.f=c.timescale(b);this.a.init()};bd.prototype.b=function(b,c){var d=new Uint8Array(b);(d=this.a.parse(d,this.g,this.f))&&d.captions&&c(d.captions);this.a.clearParsedCaptions()};bd.prototype.c=function(){this.a.resetCaptionStream()};function cd(){}cd.prototype.init=function(){};cd.prototype.b=function(){};cd.prototype.c=function(){};function dd(b){return!b||1==b.length&&1E-6>b.end(0)-b.start(0)?null:b.length?b.end(b.length-1):null}function ed(b,c,d){d=void 0===d?0:d;return!b||!b.length||1==b.length&&1E-6>b.end(0)-b.start(0)||c>b.end(b.length-1)?!1:c+d>=b.start(0)}function fd(b,c){if(!b||!b.length||1==b.length&&1E-6>b.end(0)-b.start(0))return 0;for(var d=0,e=b.length-1;0<=e&&b.end(e)>c;--e)d+=b.end(e)-Math.max(b.start(e),c);return d}
function gd(b){if(!b)return[];for(var c=[],d=0;d<b.length;d++)c.push({start:b.start(d),end:b.end(d)});return c};var hd={$d:function(b,c){return b.reduce(function(b,c,f){return c["catch"](b.bind(null,f))}.bind(null,c),Promise.reject())},hd:function(b,c){return b.concat(c)},$b:function(){},Ka:function(b){return null!=b}};function O(b,c){if(0==c.length)return b;var d=c.map(function(b){return new Wa(b)});return b.map(function(b){return new Wa(b)}).map(function(b){return d.map(b.resolve.bind(b))}).reduce(hd.hd,[]).map(function(b){return b.toString()})}function id(b,c){return{keySystem:b,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:c||[],keyIds:[]}}
var jd={gd:"video",Sd:"audio",xa:"text",Ef:"image",Cf:"application"},kd=1/15;function ld(){this.a=new muxjs.mp4.Transmuxer({keepOriginalTimestamps:!0});this.b=null;this.g=[];this.c=[];this.f=!1;this.a.on("data",this.i.bind(this));this.a.on("done",this.h.bind(this))}ld.prototype.destroy=function(){this.a.dispose();this.a=null;return Promise.resolve()};function md(b,c){return window.muxjs&&"mp2t"==b.toLowerCase().split(";")[0].split("/")[1]?c?MediaSource.isTypeSupported(nd(c,b)):MediaSource.isTypeSupported(nd("audio",b))||MediaSource.isTypeSupported(nd("video",b)):!1}
function nd(b,c){var d=c.replace(/mp2t/i,"mp4");"audio"==b&&(d=d.replace("video","audio"));var e=/avc1\.(66|77|100)\.(\d+)/.exec(d);if(e){var f="avc1.",g=e[1],h=Number(e[2]);f=("66"==g?f+"4200":"77"==g?f+"4d00":f+"6400")+(h>>4).toString(16);f+=(h&15).toString(16);d=d.replace(e[0],f)}return d}function od(b,c){b.f=!0;b.b=new G;b.g=[];b.c=[];var d=new Uint8Array(c);b.a.push(d);b.a.flush();b.f&&b.b.reject(new F(2,3,3018));return b.b}
ld.prototype.i=function(b){this.c=b.captions;var c=new Uint8Array(b.data.byteLength+b.initSegment.byteLength);c.set(b.initSegment,0);c.set(b.data,b.initSegment.byteLength);this.g.push(c)};ld.prototype.h=function(){var b={data:L.concat.apply(null,this.g),captions:this.c};this.b.resolve(b);this.f=!1};function pd(b,c,d){this.startTime=b;this.direction=qd;this.endTime=c;this.payload=d;this.region=new rd;this.position=null;this.positionAlign=sd;this.size=0;this.textAlign=td;this.writingMode=ud;this.lineInterpretation=vd;this.line=null;this.lineHeight="";this.lineAlign=wd;this.displayAlign=xd;this.fontSize=this.backgroundImage=this.backgroundColor=this.color="";this.fontWeight=yd;this.fontStyle=Bd;this.fontFamily="";this.textDecoration=[];this.wrapLine=!0;this.id="";this.nestedCues=[];this.spacer=
!1}z("shaka.text.Cue",pd);pd.prototype.clone=function(){var b=new pd(0,0,""),c;for(c in this)b[c]=this[c],b[c]&&b[c].constructor==Array&&(b[c]=b[c].slice());return b};var sd="auto";pd.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:sd};var td="center",Cd={LEFT:"left",RIGHT:"right",CENTER:td,START:"start",END:"end"};pd.textAlign=Cd;var xd="after",Dd={BEFORE:"before",CENTER:"center",AFTER:xd};pd.displayAlign=Dd;var qd="ltr";pd.direction={HORIZONTAL_LEFT_TO_RIGHT:qd,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};
var ud="horizontal-tb";pd.writingMode={HORIZONTAL_TOP_TO_BOTTOM:ud,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var vd=0;pd.lineInterpretation={LINE_NUMBER:vd,PERCENTAGE:1};var wd="start",Ed={CENTER:"center",START:wd,END:"end"};pd.lineAlign=Ed;var yd=400;pd.fontWeight={NORMAL:yd,BOLD:700};var Bd="normal",Fd={NORMAL:Bd,ITALIC:"italic",OBLIQUE:"oblique"};pd.fontStyle=Fd;pd.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"};
function rd(){this.id="";this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0;this.height=this.width=100;this.viewportAnchorUnits=this.widthUnits=this.heightUnits=Gd;this.scroll=Hd}z("shaka.text.CueRegion",rd);var Gd=1;rd.units={PX:0,PERCENTAGE:Gd,LINES:2};var Hd="";rd.scrollMode={NONE:Hd,UP:"up"};function Id(b){this.g=null;this.c=b;this.f=this.o=0;this.h=Infinity;this.b=this.a=null;this.m="";this.i=new Map}var Jd={};z("shaka.text.TextEngine.registerParser",function(b,c){Jd[b]=c});z("shaka.text.TextEngine.unregisterParser",function(b){delete Jd[b]});function Kd(b){return Jd[b]||window.muxjs&&"application/cea-608"==b?!0:!1}Id.prototype.destroy=function(){this.c=this.g=null;this.i.clear();return Promise.resolve()};
Id.prototype.Cc=function(b){var c={periodStart:0,segmentStart:null,segmentEnd:0};try{return this.g.parseMedia(new Uint8Array(b),c)[0].startTime}catch(d){throw new F(2,2,2009,d);}};
function Ld(b,c,d,e){return Promise.resolve().then(function(){if(this.g&&this.c)if(null==d||null==e)this.g.parseInit(new Uint8Array(c));else{var b={periodStart:this.o,segmentStart:d,segmentEnd:e};b=this.g.parseMedia(new Uint8Array(c),b).filter(function(b){return b.startTime>=this.f&&b.startTime<this.h}.bind(this));this.c.append(b);null==this.a&&(this.a=Math.max(d,this.f));this.b=Math.min(e,this.h)}}.bind(b))}
Id.prototype.remove=function(b,c){return Promise.resolve().then(function(){!this.c||!this.c.remove(b,c)||null==this.a||c<=this.a||b>=this.b||(b<=this.a&&c>=this.b?this.a=this.b=null:b<=this.a&&c<this.b?this.a=c:b>this.a&&c>=this.b&&(this.b=b))}.bind(this))};function Md(b,c,d){b.m=c;if(c=b.i.get(c))for(var e=r(c.keys()),f=e.next();!f.done;f=e.next())(f=c.get(f.value).filter(function(b){return b.endTime<=d}))&&b.c.append(f)}
function Nd(b,c,d,e,f){var g=d+" "+e,h=new Map;c=r(c);for(var k=c.next();!k.done;k=c.next()){var m=k.value;k=m.stream;h.has(k)||h.set(k,new Map);h.get(k).has(g)||h.get(k).set(g,[]);m.startTime+=f;m.endTime+=f;m.startTime>=b.f&&m.startTime<b.h&&(m=new pd(m.startTime,m.endTime,m.text),h.get(k).get(g).push(m),k==b.m&&b.c.append([m]))}f=r(h.keys());for(g=f.next();!g.done;g=f.next())for(g=g.value,b.i.has(g)||b.i.set(g,new Map),c=r(h.get(g).keys()),k=c.next();!k.done;k=c.next())k=k.value,m=h.get(g).get(k),
b.i.get(g).set(k,m);b.a=null==b.a?Math.max(d,b.f):Math.min(b.a,Math.max(d,b.f));b.b=Math.max(b.b,Math.min(e,b.h))};function Od(b,c,d){this.f=b;this.g=d;this.b={};this.a=null;this.c={};this.i=new N;this.v=!1;this.m={};this.o=c;b=this.u=new G;c=new MediaSource;this.i.pa(c,"sourceopen",b.resolve);this.f.src=Pd(c);this.h=c}var Pd=window.URL.createObjectURL;function Qd(b){var c=dc(b.mimeType,b.codecs),d=ec(b);return Kd(c)||MediaSource.isTypeSupported(d)||md(c,b.type)}l=Od.prototype;
l.destroy=function(){var b=this;this.v=!0;var c=[],d;for(d in this.c){var e=this.c[d],f=e[0];this.c[d]=e.slice(0,1);f&&c.push(f.p["catch"](hd.$b));for(f=1;f<e.length;++f)e[f].p.reject()}this.a&&c.push(this.a.destroy());this.g&&c.push(this.g.destroy());for(var g in this.m)c.push(this.m[g].destroy());return Promise.all(c).then(function(){b.i&&(b.i.release(),b.i=null);b.f&&(b.f.removeAttribute("src"),b.f.load(),b.f=null);b.h=null;b.a=null;b.g=null;b.b={};b.m={};b.o=null;b.c={}})};
l.init=function(b,c){var d=this;return v(function f(){var g;return y(f,function(f){switch(f.j){case 1:return g=jd,w(f,d.u,2);case 2:b.forEach(function(b,f){var h=dc(b.mimeType,b.codecs);f==g.xa?Rd(d,h):(!c&&MediaSource.isTypeSupported(h)||!md(h,f)||(d.m[f]=new ld,h=nd(f,h)),h=d.h.addSourceBuffer(h),d.i.B(h,"error",d.rf.bind(d,f)),d.i.B(h,"updateend",d.vb.bind(d,f)),d.b[f]=h,d.c[f]=[])}),x(f)}})})};function Rd(b,c){b.a||(b.a=new Id(b.g));"application/cea-608"!=c&&(b.a.g=new Jd[c])}
function Sd(b){return b.h?"ended"==b.h.readyState:!0}function Td(b,c){if("text"==c)var d=b.a.a;else d=Ud(b,c),d=!d||1==d.length&&1E-6>d.end(0)-d.start(0)?null:1==d.length&&0>d.start(0)?0:d.length?d.start(0):null;return d}function Vd(b,c){return"text"==c?b.a.b:dd(Ud(b,c))}function Wd(b,c,d){if("text"==c)return b=b.a,null==b.b||b.b<d?0:b.b-Math.max(d,b.a);b=Ud(b,c);return fd(b,d)}
l.yc=function(b){b.total=gd(this.f.buffered);b.audio=gd(Ud(this,"audio"));b.video=gd(Ud(this,"video"));b.text=[];if(this.a){var c=this.a.a,d=this.a.b;null!=c&&null!=d&&b.text.push({start:c,end:d})}};function Ud(b,c){try{return b.b[c].buffered}catch(d){return c in b.b&&A.error("failed to get buffered range for "+c,d),null}}
function Xd(b,c,d,e,f,g){if("text"==c)return Ld(b.a,d,e,f);if(b.m[c])return od(b.m[c],d).then(function(b){this.a||Rd(this,"text/vtt");b.captions&&b.captions.length&&Nd(this.a,b.captions,e,f,this.b.video.timestampOffset);return Yd(this,c,this.Qd.bind(this,c,b.data.buffer))}.bind(b));g&&window.muxjs&&(b.a||Rd(b,"text/vtt"),null==e&&null==f?b.o.init(d):b.o.b(d,function(c){c.length&&Nd(b.a,c,e,f,b.b.video.timestampOffset)}));return Yd(b,c,b.Qd.bind(b,c,d))}
function Zd(b,c){var d=Vd(b,"video")||0;Md(b.a,c,d)}l.remove=function(b,c,d){return"text"==b?this.a.remove(c,d):Yd(this,b,this.Id.bind(this,b,c,d))};function $d(b,c){if("text"==c){if(!b.a)return Promise.resolve();b.o.c();return b.a.remove(0,Infinity)}return Yd(b,c,b.Id.bind(b,c,0,b.h.duration))}l.flush=function(b){return"text"==b?Promise.resolve():Yd(this,b,this.de.bind(this,b))};
function ae(b,c,d,e,f){return"text"==c?(b.a.o=d,b=b.a,b.f=e,b.h=f,Promise.resolve()):Promise.all([Yd(b,c,b.Ud.bind(b,c)),Yd(b,c,b.qf.bind(b,c,d)),Yd(b,c,b.lf.bind(b,c,e,f))])}l.endOfStream=function(b){return be(this,function(){Sd(this)||(b?this.h.endOfStream(b):this.h.endOfStream())}.bind(this))};l.$a=function(b){return be(this,function(){this.h.duration=b}.bind(this))};l.da=function(){return this.h.duration};l.Qd=function(b,c){this.b[b].appendBuffer(c)};
l.Id=function(b,c,d){d<=c?this.vb(b):this.b[b].remove(c,d)};l.Ud=function(b){var c=this.b[b].appendWindowStart,d=this.b[b].appendWindowEnd;this.b[b].abort();this.b[b].appendWindowStart=c;this.b[b].appendWindowEnd=d;this.vb(b)};l.de=function(b){this.f.currentTime-=.001;this.vb(b)};l.qf=function(b,c){0>c&&(c+=.001);this.b[b].timestampOffset=c;this.vb(b)};l.lf=function(b,c,d){this.b[b].appendWindowStart=0;this.b[b].appendWindowEnd=d;this.b[b].appendWindowStart=c;this.vb(b)};
l.rf=function(b){this.c[b][0].p.reject(new F(2,3,3014,this.f.error?this.f.error.code:0))};l.vb=function(b){var c=this.c[b][0];c&&(c.p.resolve(),ce(this,b))};function Yd(b,c,d){if(b.v)return Promise.reject();d={start:d,p:new G};b.c[c].push(d);if(1==b.c[c].length)try{d.start()}catch(e){"QuotaExceededError"==e.name?d.p.reject(new F(2,3,3017,c)):d.p.reject(new F(2,3,3015,e)),ce(b,c)}return d.p}
function be(b,c){if(b.v)return Promise.reject();var d=[],e;for(e in b.b){var f=new G,g={start:function(b){b.resolve()}.bind(null,f),p:f};b.c[e].push(g);d.push(f);1==b.c[e].length&&g.start()}return Promise.all(d).then(function(){try{c()}catch(m){var b=Promise.reject(new F(2,3,3015,m))}for(var d in this.b)ce(this,d);return b}.bind(b),function(b){throw b;}.bind(b))}function ce(b,c){b.c[c].shift();var d=b.c[c][0];if(d)try{d.start()}catch(e){d.p.reject(new F(2,3,3015,e)),ce(b,c)}};function de(b,c){b=P(b);c=P(c);return b.split("-")[0]==c.split("-")[0]}function ee(b,c){b=P(b);c=P(c);var d=b.split("-"),e=c.split("-");return d[0]==e[0]&&1==d.length&&2==e.length}function P(b){b=b.split("-");b=r(b);var c=b.next().value;c=void 0===c?"":c;var d=b.next().value;d=void 0===d?"":d;b=la(b);c=c.toLowerCase();c=fe.get(c)||c;d=d.toUpperCase();return[d?c+"-"+d:c].concat(b instanceof Array?b:la(r(b))).join("-")}
function ge(b){return b.language?P(b.language):b.audio&&b.audio.language?P(b.audio.language):b.video&&b.video.language?P(b.video.language):"und"}
function he(b,c){for(var d=P(b),e=new Set,f=r(c),g=f.next();!g.done;g=f.next())e.add(P(g.value));f=r(e);for(g=f.next();!g.done;g=f.next())if(g=g.value,g==d)return g;f=r(e);for(g=f.next();!g.done;g=f.next())if(g=g.value,ee(g,d))return g;f=r(e);for(g=f.next();!g.done;g=f.next()){var h=g=g.value,k=d;h=P(h);k=P(k);h=h.split("-");k=k.split("-");if(2==h.length&&2==k.length&&h[0]==k[0])return g}e=r(e);for(g=e.next();!g.done;g=e.next())if(f=g.value,ee(d,f))return f;return null}
var fe=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze",
"cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice",
"is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao",
"mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san",
"sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie",
"vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);function ie(b,c){var d=b.periods.reduce(function(b,c){return b.concat(c.variants)},[]);d=je(d,c);var e=new yb;d=r(d);for(var f=d.next();!f.done;f=d.next()){f=f.value;var g=ke(f);e.push(g,f)}e=le(e);var h=me(e);e=r(b.periods);for(d=e.next();!d.done;d=e.next())d=d.value,d.variants=d.variants.filter(function(b){if(ke(b)==h)return!0;A.debug("Dropping Variant (better codec available)",b);return!1})}
function ke(b){var c="";b.video&&(c=gc(b.video.codecs)[0]);var d="";b.audio&&(d=gc(b.audio.codecs)[0]);return c+"-"+d}function me(b){var c="",d=Infinity;b.forEach(function(b,f){for(var e=0,h=0,k=r(f),m=k.next();!m.done;m=k.next())e+=m.value.bandwidth||0,++h;e/=h;A.debug("codecs",b,"avg bandwidth",e);e<d&&(c=b,d=e)});return c}
function le(b){var c=new Map;b.forEach(function(b,d){for(var e=r(d),f=e.next();!f.done;f=e.next())f=f.value,f.video&&(f=f.video.height,c.has(f)||c.set(f,new Set),c.get(f).add(b))});var d=b.size(),e=new yb;b.forEach(function(b,g){for(var f=r(g),k=f.next();!k.done;k=f.next())k=k.value,k.video&&c.has(k.video.height)&&c.get(k.video.height).size!==d||e.push(b,k)});return e}
function ne(b,c,d){function e(b,c,d){return b>=c&&b<=d}var f=b.video;return f&&f.width&&f.height&&(!e(f.width,c.minWidth,Math.min(c.maxWidth,d.width))||!e(f.height,c.minHeight,Math.min(c.maxHeight,d.height))||!e(f.width*f.height,c.minPixels,c.maxPixels))||b&&b.video&&b.video.frameRate&&!e(b.video.frameRate,c.minFrameRate,c.maxFrameRate)||!e(b.bandwidth,c.minBandwidth,c.maxBandwidth)?!1:!0}
function oe(b,c,d){var e=!1;b.forEach(function(b){var f=b.allowedByApplication;b.allowedByApplication=ne(b,c,d);f!=b.allowedByApplication&&(e=!0)});return e}
function pe(b,c,d,e){e.variants=e.variants.filter(function(e){if(b&&b.ba&&!Yc(b,e))return A.debug("Dropping variant - not compatible with key system",e),!1;var f=e.audio;e=e.video;return f&&!Qd(f)?(A.debug("Dropping variant - audio not compatible with platform",qe(f)),!1):e&&!Qd(e)?(A.debug("Dropping variant - video not compatible with platform",qe(e)),!1):f&&c&&!re(f,c)?(A.debug("Droping variant - not compatible with active audio","active audio",qe(c),"variant.audio",qe(f)),!1):e&&d&&!re(e,d)?(A.debug("Droping variant - not compatible with active video",
"active video",qe(d),"variant.video",qe(e)),!1):!0});e.textStreams=e.textStreams.filter(function(b){var c=Kd(dc(b.mimeType,b.codecs));c||A.debug("Dropping text stream. Is not supported by the platform.",b);return c})}function re(b,c){return b.mimeType!=c.mimeType||b.codecs.split(".")[0]!=c.codecs.split(".")[0]?!1:!0}
function se(b){var c=b.audio,d=b.video,e=c?c.codecs:null,f=d?d.codecs:null,g=[];f&&g.push(f);e&&g.push(e);var h=[];d&&h.push(d.mimeType);c&&h.push(c.mimeType);h=h[0]||null;var k=[];c&&k.push(c.kind);d&&k.push(d.kind);k=k[0]||null;var m=new Set;c&&c.roles.forEach(function(b){return m.add(b)});d&&d.roles.forEach(function(b){return m.add(b)});b={id:b.id,active:!1,type:"variant",bandwidth:b.bandwidth,language:b.language,label:null,kind:k,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:h,
codecs:g.join(", "),audioCodec:e,videoCodec:f,primary:b.primary,roles:Array.from(m),audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null};d&&(b.videoId=d.id,b.originalVideoId=d.originalId,b.width=d.width||null,b.height=d.height||null,b.frameRate=d.frameRate||null,b.pixelAspectRatio=d.pixelAspectRatio||null,b.videoBandwidth=d.bandwidth||null);c&&(b.audioId=c.id,b.originalAudioId=
c.originalId,b.channelsCount=c.channelsCount,b.audioSamplingRate=c.audioSamplingRate,b.audioBandwidth=c.bandwidth||null,b.label=c.label,b.audioRoles=c.roles);return b}
function te(b){return{id:b.id,active:!1,type:"text",bandwidth:0,language:b.language,label:b.label,kind:b.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:b.mimeType,codecs:b.codecs||null,audioCodec:null,videoCodec:null,primary:b.primary,roles:b.roles,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:b.originalId}}
function ue(b){b.__shaka_id||(b.__shaka_id=ve++);return b.__shaka_id}var ve=0;function we(b){var c=xe(b);c.active=b.enabled;c.type="variant";c.originalAudioId=b.id;"main"==b.kind&&(c.primary=!0);b.kind&&(c.roles=[b.kind],c.audioRoles=[b.kind]);return c}
function xe(b){return{id:ue(b),active:!1,type:"",bandwidth:0,language:P(b.language),label:b.label,kind:b.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null}}
function ye(b){return b.allowedByApplication&&b.allowedByKeySystem}function je(b,c){var d=b.filter(function(b){return b.audio&&b.audio.channelsCount}),e=new Map;d=r(d);for(var f=d.next();!f.done;f=d.next()){f=f.value;var g=f.audio.channelsCount;e.has(g)||e.set(g,[]);e.get(g).push(f)}d=Array.from(e.keys());if(0==d.length)return b;f=d.filter(function(b){return b<=c});return f.length?e.get(Math.max.apply(null,f)):e.get(Math.min.apply(null,d))}
function ze(b,c,d){var e=b,f=b.filter(function(b){return b.primary});f.length&&(e=f);var g=e.length?e[0].language:"";e=e.filter(function(b){return b.language==g});if(c){var h=he(P(c),b.map(function(b){return b.language}));h&&(e=b.filter(function(b){return P(b.language)==h}))}if(d){b=Ae(e,d);if(b.length)return b;A.l("No exact match for the text role could be found.")}else if(b=e.filter(function(b){return 0==b.roles.length}),b.length)return b;b=e.map(function(b){return b.roles}).reduce(hd.hd,[]);return b.length?
Ae(e,b[0]):e}function Ae(b,c){return b.filter(function(b){return b.roles.includes(c)})}function Be(b,c,d){for(var e=0;e<d.length;e++)if(d[e].audio==b&&d[e].video==c)return d[e];return null}function Ce(b){var c=[];b.audio&&c.push(b.audio);b.video&&c.push(b.video);return c}
function qe(b){return"audio"==b.type?"type=audio codecs="+b.codecs+" bandwidth="+b.bandwidth+" channelsCount="+b.channelsCount+" audioSamplingRate="+b.audioSamplingRate:"video"==b.type?"type=video codecs="+b.codecs+" bandwidth="+b.bandwidth+" frameRate="+b.frameRate+" width="+b.width+" height="+b.height:"unexpected stream type"};function Q(){this.h=null;this.c=!1;this.b=new Ta;this.g=[];this.i=!1;this.a=this.f=null}z("shaka.abr.SimpleAbrManager",Q);Q.prototype.stop=function(){this.h=null;this.c=!1;this.g=[];this.f=null};Q.prototype.stop=Q.prototype.stop;Q.prototype.init=function(b){this.h=b};Q.prototype.init=Q.prototype.init;
Q.prototype.chooseVariant=function(){var b=De(this.a.restrictions,this.g),c=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate);this.g.length&&!b.length&&(A.l("No variants met the ABR restrictions. Choosing a variant by lowest bandwidth."),b=De(null,this.g),b=[b[0]]);for(var d=b[0]||null,e=0;e<b.length;++e){var f=b[e],g=f.bandwidth/this.a.bandwidthDowngradeTarget,h=(b[e+1]||{bandwidth:Infinity}).bandwidth/this.a.bandwidthUpgradeTarget;A.I("Bandwidth ranges:",(f.bandwidth/1E6).toFixed(3),
(g/1E6).toFixed(3),(h/1E6).toFixed(3));c>=g&&c<=h&&(d=f)}this.f=Date.now();return d};Q.prototype.chooseVariant=Q.prototype.chooseVariant;Q.prototype.enable=function(){this.c=!0};Q.prototype.enable=Q.prototype.enable;Q.prototype.disable=function(){this.c=!1};Q.prototype.disable=Q.prototype.disable;
Q.prototype.segmentDownloaded=function(b,c){A.I("Segment downloaded:","deltaTimeMs="+b,"numBytes="+c,"lastTimeChosenMs="+this.f,"enabled="+this.c);var d=this.b;if(!(16E3>c)){var e=8E3*c/b,f=b/1E3;d.a+=c;Qa(d.b,f,e);Qa(d.c,f,e)}if(null!=this.f&&this.c)a:{A.I("Suggesting Streams...");if(!this.i){if(!(128E3<=this.b.a)){A.I("Still waiting for a good estimate...");break a}this.i=!0}else if(Date.now()-this.f<1E3*this.a.switchInterval){A.I("Still within switch interval...");break a}d=this.chooseVariant();
e=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate);A.debug("Calling switch_(), bandwidth="+Math.round(e/1E3)+" kbps");this.h(d)}};Q.prototype.segmentDownloaded=Q.prototype.segmentDownloaded;Q.prototype.getBandwidthEstimate=function(){return this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate)};Q.prototype.getBandwidthEstimate=Q.prototype.getBandwidthEstimate;Q.prototype.setVariants=function(b){this.g=b};Q.prototype.setVariants=Q.prototype.setVariants;
Q.prototype.configure=function(b){this.a=b};Q.prototype.configure=Q.prototype.configure;function De(b,c){b&&(c=c.filter(function(c){return ne(c,b,{width:Infinity,height:Infinity})}));return c.sort(function(b,c){return b.bandwidth-c.bandwidth})};function R(b,c){this.G=b;this.b=c==Ee;this.a=0}z("shaka.util.DataViewReader",R);var Ee=1;R.Endianness={Df:0,Ff:Ee};R.prototype.ua=function(){return this.a<this.G.byteLength};R.prototype.hasMoreData=R.prototype.ua;R.prototype.$=function(){return this.a};R.prototype.getPosition=R.prototype.$;R.prototype.ke=function(){return this.G.byteLength};R.prototype.getLength=R.prototype.ke;R.prototype.Rc=function(){try{var b=this.G.getUint8(this.a);this.a+=1;return b}catch(c){Fe()}};R.prototype.readUint8=R.prototype.Rc;
R.prototype.Fd=function(){try{var b=this.G.getUint16(this.a,this.b);this.a+=2;return b}catch(c){Fe()}};R.prototype.readUint16=R.prototype.Fd;R.prototype.H=function(){try{var b=this.G.getUint32(this.a,this.b);this.a+=4;return b}catch(c){Fe()}};R.prototype.readUint32=R.prototype.H;R.prototype.Dd=function(){try{var b=this.G.getInt32(this.a,this.b);this.a+=4;return b}catch(c){Fe()}};R.prototype.readInt32=R.prototype.Dd;
R.prototype.zb=function(){try{if(this.b){var b=this.G.getUint32(this.a,!0);var c=this.G.getUint32(this.a+4,!0)}else c=this.G.getUint32(this.a,!1),b=this.G.getUint32(this.a+4,!1)}catch(d){Fe()}if(2097151<c)throw new F(2,3,3001);this.a+=8;return c*Math.pow(2,32)+b};R.prototype.readUint64=R.prototype.zb;R.prototype.Da=function(b){this.a+b>this.G.byteLength&&Fe();var c=new Uint8Array(this.G.buffer,this.G.byteOffset+this.a,b);this.a+=b;return c};R.prototype.readBytes=R.prototype.Da;
R.prototype.S=function(b){this.a+b>this.G.byteLength&&Fe();this.a+=b};R.prototype.skip=R.prototype.S;R.prototype.gf=function(b){this.a<b&&Fe();this.a-=b};R.prototype.rewind=R.prototype.gf;R.prototype.seek=function(b){(0>b||b>this.G.byteLength)&&Fe();this.a=b};R.prototype.seek=R.prototype.seek;R.prototype.Qc=function(){for(var b=this.a;this.ua()&&0!=this.G.getUint8(this.a);)this.a+=1;b=new Uint8Array(this.G.buffer,this.G.byteOffset+b,this.a-b);this.a+=1;return qc(b)};
R.prototype.readTerminatedString=R.prototype.Qc;function Fe(){throw new F(2,3,3E3);}var Ge=Array.from({length:256},function(b,c){return(c+256).toString(16).substr(1)});R.prototype.Ed=function(){var b=this.Da(16);return(Ge[b[0]]+Ge[b[1]]+Ge[b[2]]+Ge[b[3]]+"-"+Ge[b[4]]+Ge[b[5]]+"-"+Ge[b[6]]+Ge[b[7]]+"-"+Ge[b[8]]+Ge[b[9]]+"-"+Ge[b[10]]+Ge[b[11]]+Ge[b[12]]+Ge[b[13]]+Ge[b[14]]+Ge[b[15]]).toLowerCase()};R.prototype.readUUID=R.prototype.Ed;function M(){this.c=[];this.b=[];this.a=!1}z("shaka.util.Mp4Parser",M);M.prototype.F=function(b,c){var d=He(b);this.c[d]=0;this.b[d]=c;return this};M.prototype.box=M.prototype.F;M.prototype.oa=function(b,c){var d=He(b);this.c[d]=1;this.b[d]=c;return this};M.prototype.fullBox=M.prototype.oa;M.prototype.stop=function(){this.a=!0};M.prototype.stop=M.prototype.stop;
M.prototype.parse=function(b,c,d){b=new Uint8Array(b);b=new R(new DataView(b.buffer,b.byteOffset,b.byteLength),0);for(this.a=!1;b.ua()&&!this.a;)this.dc(0,b,c,d)};M.prototype.parse=M.prototype.parse;
M.prototype.dc=function(b,c,d,e){var f=c.$(),g=c.H(),h=c.H();A.I("Parsing MP4 box",Ie(h));switch(g){case 0:g=c.G.byteLength-f;break;case 1:g=c.zb()}var k=this.b[h];if(k){var m=null,n=null;1==this.c[h]&&(n=c.H(),m=n>>>24,n&=16777215);var p=f+g;h=!0;d&&p>c.G.byteLength&&(p=c.G.byteLength,h=!1);e&&p>c.G.byteLength?this.a=!0:(e=p-c.$(),e=0<e?c.Da(e):new Uint8Array(0),e=new R(new DataView(e.buffer,e.byteOffset,e.byteLength),0),k({parser:this,partialOkay:d||!1,version:m,flags:n,reader:e,size:g,loadedSize:c.$()-
f,start:f+b,isComplete:h}))}else c.S(Math.min(f+g-c.$(),c.G.byteLength-c.$()))};M.prototype.parseNext=M.prototype.dc;function Je(b){for(var c=null!=b.flags?12:8;b.reader.ua()&&!b.parser.a;)b.parser.dc(b.start+c,b.reader,b.partialOkay)}M.children=Je;function Ke(b){for(var c=null!=b.flags?12:8,d=b.reader.H();0<d&&!b.parser.a;--d)b.parser.dc(b.start+c,b.reader,b.partialOkay)}M.sampleDescription=Ke;function Le(b){return function(c){b(c.reader.Da(c.reader.G.byteLength-c.reader.$()))}}M.allData=Le;
function He(b){for(var c=0,d=0;d<b.length;d++)c=c<<8|b.charCodeAt(d);return c}function Ie(b){return String.fromCharCode(b>>24&255,b>>16&255,b>>8&255,b&255)}M.typeToString=Ie;function Me(b){var c=this;this.b=[];this.a=[];this.data=[];(new M).F("moov",Je).oa("pssh",function(b){if(1<b.version)A.l("Unrecognized PSSH version found!");else{var d=b.reader.G;d=new Uint8Array(d.buffer,d.byteOffset-12,b.size);c.data.push(d);c.b.push(L.hc(b.reader.Da(16)));if(0<b.version){d=b.reader.H();for(var f=0;f<d;++f){var g=L.hc(b.reader.Da(16));c.a.push(g)}}}}).parse(b);0==this.data.length&&A.l("No pssh box found!")}
function Ne(b){if(!b)return b;var c=new Me(b);if(1>=c.data.length)return b;b=[];var d={};c=r(c.data);for(var e=c.next();!e.done;d={Wb:d.Wb},e=c.next())d.Wb=e.value,b.some(function(b){return function(c){return L.Ia(c,b.Wb)}}(d))||b.push(d.Wb);return L.concat.apply(L,b instanceof Array?b:la(r(b)))};var S={Sb:function(b,c){var d=S.R(b,c);return 1!=d.length?null:d[0]},wc:function(b,c,d){b=S.md(b,c,d);return 1!=b.length?null:b[0]},R:function(b,c){return Array.prototype.filter.call(b.childNodes,function(b){return b instanceof Element&&b.tagName==c})},md:function(b,c,d){return Array.prototype.filter.call(b.childNodes,function(b){return b instanceof Element&&b.localName==d&&b.namespaceURI==c})},getAttributeNS:function(b,c,d){return b.hasAttributeNS(c,d)?b.getAttributeNS(c,d):null},Tb:function(b){return Array.prototype.every.call(b.childNodes,
function(b){return b.nodeType==Node.TEXT_NODE||b.nodeType==Node.CDATA_SECTION_NODE})?b.textContent.trim():null},D:function(b,c,d,e){e=void 0===e?null:e;var f=null;b=b.getAttribute(c);null!=b&&(f=d(b));return null==f?e:f},Ue:function(b){if(!b)return null;/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(b)&&(b+="Z");b=Date.parse(b);return isNaN(b)?null:Math.floor(b/1E3)},Ba:function(b){if(!b)return null;var c=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(b);
if(!c)return A.l("Invalid duration string:",b),null;b=31536E3*Number(c[1]||null)+2592E3*Number(c[2]||null)+86400*Number(c[3]||null)+3600*Number(c[4]||null)+60*Number(c[5]||null)+Number(c[6]||null);return isFinite(b)?b:null},fc:function(b){var c=/([0-9]+)-([0-9]+)/.exec(b);if(!c)return null;b=Number(c[1]);if(!isFinite(b))return null;c=Number(c[2]);return isFinite(c)?{start:b,end:c}:null},parseInt:function(b){b=Number(b);return 0===b%1?b:null},ec:function(b){b=Number(b);return 0===b%1&&0<b?b:null},
wb:function(b){b=Number(b);return 0===b%1&&0<=b?b:null},parseFloat:function(b){b=Number(b);return isNaN(b)?null:b},be:function(b){var c;b=(c=b.match(/^(\d+)\/(\d+)$/))?Number(c[1])/Number(c[2]):Number(b);return isNaN(b)?null:b},Cd:function(b,c){var d=new DOMParser;try{var e=d.parseFromString(b,"text/xml")}catch(g){}if(e&&e.documentElement.tagName==c)var f=e.documentElement;return f&&0<f.getElementsByTagName("parsererror").length?null:f},Bd:function(b,c){try{var d=qc(b);return S.Cd(d,c)}catch(e){}}};var Oe=(new Map).set("urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b","org.w3.clearkey").set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine.alpha").set("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb","com.adobe.primetime");
function Pe(b,c,d){var e=Qe(b),f=null;b=[];var g=[],h=new Set(e.map(function(b){return b.keyId}));h["delete"](null);if(1<h.size)throw new F(2,4,4010);d||(g=e.filter(function(b){return"urn:mpeg:dash:mp4protection:2011"==b.Jd?(f=b.init||f,!1):!0}),g.length&&(b=Re(f,c,g),0==b.length&&(b=[id("",f)])));if(e.length&&(d||!g.length))for(b=[],c=r(Oe.values()),d=c.next();!d.done;d=c.next())d=d.value,"org.w3.clearkey"!=d&&b.push(id(d,f));if(h=Array.from(h)[0]||null)for(c=r(b),d=c.next();!d.done;d=c.next())for(d=
r(d.value.initData),e=d.next();!e.done;e=d.next())e.value.keyId=h;return{jd:h,Hf:f,drmInfos:b,nd:!0}}function Se(b,c,d,e){var f=Pe(b,c,e);if(d.nd){b=1==d.drmInfos.length&&!d.drmInfos[0].keySystem;c=0==f.drmInfos.length;if(0==d.drmInfos.length||b&&!c)d.drmInfos=f.drmInfos;d.nd=!1}else if(0<f.drmInfos.length&&(d.drmInfos=d.drmInfos.filter(function(b){return f.drmInfos.some(function(c){return c.keySystem==b.keySystem})}),0==d.drmInfos.length))throw new F(2,4,4008);return f.jd||d.jd}
function Te(b){var c=0,d=(new DataView(b)).getUint32(c,!0);c+=4;if(d!==b.byteLength)return A.l("PlayReady Object with invalid length encountered."),[];c+=2;d=[];for(var e=new DataView(b);c<b.byteLength-1;){var f=e.getUint16(c,!0);c+=2;var g=e.getUint16(c,!0);c+=2;var h=new Uint8Array(b,c,g);d.push({type:f,value:h});c+=g}return d}
function Ue(b){b=r(b.getElementsByTagName("DATA"));for(var c=b.next();!c.done;c=b.next()){c=r(c.value.childNodes);for(var d=c.next();!d.done;d=c.next())if(d=d.value,d instanceof Element&&"LA_URL"==d.tagName)return d.textContent}return""}
function Re(b,c,d){var e=[];d=r(d);for(var f=d.next();!f.done;f=d.next()){f=f.value;var g=Oe.get(f.Jd);if(g){var h;if(h=S.wc(f.node,"urn:microsoft:playready","pro")){h=L.Ja(h.textContent);var k=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),m=h.length,n=k.length+16+m,p=new ArrayBuffer(n),q=new Uint8Array(p);p=new DataView(p);var t=0;p.setUint32(t,n);t+=4;p.setUint32(t,1886614376);t+=4;p.setUint32(t,0);t+=4;q.set(k,t);t+=k.length;p.setUint32(t,m);t+=4;q.set(h,t);h=[{initData:q,
initDataType:"cenc",keyId:f.keyId}]}else h=null;h=id(g,f.init||b||h);if(g=Ve.get(g))h.licenseServerUri=g(f);e.push(h)}else for(f=c(f.node)||[],f=r(f),g=f.next();!g.done;g=f.next())e.push(g.value)}return e}
var Ve=(new Map).set("com.widevine.alpha",function(b){return(b=S.wc(b.node,"urn:microsoft","laurl"))?b.getAttribute("licenseUrl")||"":""}).set("com.microsoft.playready",function(b){b=S.wc(b.node,"urn:microsoft:playready","pro");if(!b)return"";b=L.Ja(b.textContent);b=Te(b.buffer).filter(function(b){return 1===b.type})[0];if(!b)return"";b=sc(b.value,!0);return(b=S.Cd(b,"WRMHEADER"))?Ue(b):""});function Qe(b){var c=[];b=r(b);for(var d=b.next();!d.done;d=b.next())(d=We(d.value))&&c.push(d);return c}
function We(b){var c=b.getAttribute("schemeIdUri"),d=S.getAttributeNS(b,"urn:mpeg:cenc:2013","default_KID"),e=S.md(b,"urn:mpeg:cenc:2013","pssh").map(S.Tb);if(!c)return A.error("Missing required schemeIdUri attribute on","ContentProtection element",b),null;c=c.toLowerCase();if(d&&(d=d.replace(/-/g,"").toLowerCase(),d.includes(" ")))throw new F(2,4,4009);var f=[];try{f=e.map(function(b){return{initDataType:"cenc",initData:L.Ja(b),keyId:null}})}catch(g){throw new F(2,4,4007);}return{node:b,Jd:c,keyId:d,
init:0<f.length?f:null}};function Xe(b,c,d,e,f){var g={RepresentationID:c,Number:d,Bandwidth:e,Time:f};return b.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(c,d,e,f){if("$$"==c)return"$";var h=g[d];if(null==h)return A.l("URL template does not have an available substitution for identifier",'"'+d+'":',b),c;"RepresentationID"==d&&e&&(A.l("URL template should not contain a width specifier for identifier",'"RepresentationID":',b),e=void 0);"Time"==d&&(h=Math.round(h));switch(f){case void 0:case "d":case "i":case "u":c=
h.toString();break;case "o":c=h.toString(8);break;case "x":c=h.toString(16);break;case "X":c=h.toString(16).toUpperCase();break;default:c=h.toString()}e=window.parseInt(e,10)||1;return Array(Math.max(0,e-c.length)+1).join("0")+c})}
function Ye(b,c){var d=Ze(b,c,"timescale"),e=1;d&&(e=S.ec(d)||1);d=Ze(b,c,"duration");(d=S.ec(d||""))&&(d/=e);var f=Ze(b,c,"startNumber"),g=Number(Ze(b,c,"presentationTimeOffset"))||0,h=S.wb(f||"");if(null==f||null==h)h=1;var k=$e(b,c,"SegmentTimeline");f=null;if(k){f=e;var m=b.T.duration||Infinity;k=S.R(k,"S");for(var n=[],p=-g,q=0;q<k.length;++q){var t=k[q],u=S.D(t,"t",S.wb),E=S.D(t,"d",S.wb),B=S.D(t,"r",S.parseInt);null!=u&&(u-=g);if(!E){A.l('"S" element must have a duration:','ignoring the remaining "S" elements.',
t);break}u=null!=u?u:p;B=B||0;if(0>B)if(q+1<k.length){B=S.D(k[q+1],"t",S.wb);if(null==B){A.l('An "S" element cannot have a negative repeat','if the next "S" element does not have a valid start time:','ignoring the remaining "S" elements.',t);break}else if(u>=B){A.l('An "S" element cannot have a negative repeat','if its start time exceeds the next "S" element\'s start time:','ignoring the remaining "S" elements.',t);break}B=Math.ceil((B-u)/E)-1}else{if(Infinity==m){A.l('The last "S" element cannot have a negative repeat',
"if the Period has an infinite duration:",'ignoring the last "S" element.',t);break}else if(u/f>=m){A.l('The last "S" element cannot have a negative repeat',"if its start time exceeds the Period's duration:",'igoring the last "S" element.',t);break}B=Math.ceil((m*f-u)/E)-1}0<n.length&&u!=p&&(Math.abs((u-p)/f)>=kd&&A.l("SegmentTimeline contains a large gap/overlap:","the content may have errors in it.",t),n[n.length-1].end=u/f);for(t=0;t<=B;++t)p=u+E,n.push({start:u/f,end:p/f,zf:u}),u=p}f=n}return{timescale:e,
Y:d,ab:h,ia:g/e||0,fd:g,L:f}}function Ze(b,c,d){return[c(b.w),c(b.W),c(b.ea)].filter(hd.Ka).map(function(b){return b.getAttribute(d)}).reduce(function(b,c){return b||c})}function $e(b,c,d){return[c(b.w),c(b.W),c(b.ea)].filter(hd.Ka).map(function(b){return S.Sb(b,d)}).reduce(function(b,c){return b||c})}
function af(b,c,d,e,f,g){for(var h=S.getAttributeNS(b,"http://www.w3.org/1999/xlink","href"),k=S.getAttributeNS(b,"http://www.w3.org/1999/xlink","actuate")||"onRequest",m=0;m<b.attributes.length;m++){var n=b.attributes[m];"http://www.w3.org/1999/xlink"==n.namespaceURI&&(b.removeAttributeNS(n.namespaceURI,n.localName),--m)}if(5<=g)return qb(new F(2,4,4028));if("onLoad"!=k)return qb(new F(2,4,4027));var p=O([e],[h]);return f.request(0,Hb(p,c)).ca(function(e){e=S.Bd(e.data,b.tagName);if(!e)return qb(new F(2,
4,4001,h));for(;b.childNodes.length;)b.removeChild(b.childNodes[0]);for(;e.childNodes.length;){var k=e.childNodes[0];e.removeChild(k);b.appendChild(k)}for(k=0;k<e.attributes.length;k++){var m=e.attributes[k].nodeName,n=e.getAttribute(m);b.setAttribute(m,n)}return bf(b,c,d,p[0],f,g+1)})}
function bf(b,c,d,e,f,g){g=void 0===g?0:g;if(S.getAttributeNS(b,"http://www.w3.org/1999/xlink","href")){var h=af(b,c,d,e,f,g);d&&(h=h.ca(void 0,function(){return bf(b,c,d,e,f,g)}));return h}h=[];for(var k=0;k<b.childNodes.length;k++){var m=b.childNodes[k];m instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==S.getAttributeNS(m,"http://www.w3.org/1999/xlink","href")?(b.removeChild(m),--k):"SegmentTimeline"!=m.tagName&&h.push(bf(m,c,d,e,f,g)))}return wb(h).ca(function(){return b})};function cf(b,c,d){this.c=b;this.b=c;this.a=d}z("shaka.media.InitSegmentReference",cf);cf.prototype.rc=function(){return this.c()};cf.prototype.createUris=cf.prototype.rc;cf.prototype.Bc=function(){return this.b};cf.prototype.getStartByte=cf.prototype.Bc;cf.prototype.zc=function(){return this.a};cf.prototype.getEndByte=cf.prototype.zc;function T(b,c,d,e,f,g){this.position=b;this.startTime=c;this.endTime=d;this.c=e;this.b=f;this.a=g}z("shaka.media.SegmentReference",T);T.prototype.$=function(){return this.position};
T.prototype.getPosition=T.prototype.$;T.prototype.Cc=function(){return this.startTime};T.prototype.getStartTime=T.prototype.Cc;T.prototype.ie=function(){return this.endTime};T.prototype.getEndTime=T.prototype.ie;T.prototype.rc=function(){return this.c()};T.prototype.createUris=T.prototype.rc;T.prototype.Bc=function(){return this.b};T.prototype.getStartByte=T.prototype.Bc;T.prototype.zc=function(){return this.a};T.prototype.getEndByte=T.prototype.zc;function df(b,c,d,e){var f,g=(new M).oa("sidx",function(b){f=ef(c,e,d,b)});b&&g.parse(b);if(f)return f;A.error('Invalid box type, expected "sidx".');throw new F(2,3,3004);}
function ef(b,c,d,e){var f=[];e.reader.S(4);var g=e.reader.H();if(0==g)throw A.error("Invalid timescale."),new F(2,3,3005);if(0==e.version){var h=e.reader.H();var k=e.reader.H()}else h=e.reader.zb(),k=e.reader.zb();e.reader.S(2);var m=e.reader.Fd();b=b+e.size+k;for(k=0;k<m;k++){var n=e.reader.H(),p=(n&2147483648)>>>31;n&=2147483647;var q=e.reader.H();e.reader.S(4);if(1==p)throw A.error("Heirarchical SIDXs are not supported."),new F(2,3,3006);f.push(new T(f.length,h/g-c,(h+q)/g-c,function(){return d},
b,b+n-1));h+=q;b+=n}e.parser.stop();return f};function U(b){this.a=b}z("shaka.media.SegmentIndex",U);U.prototype.destroy=function(){this.a=null;return Promise.resolve()};U.prototype.destroy=U.prototype.destroy;U.prototype.find=function(b){for(var c=this.a.length-1;0<=c;--c){var d=this.a[c];if(b>=d.startTime&&b<d.endTime)return d.position}return this.a.length&&b<this.a[0].startTime?this.a[0].position:null};U.prototype.find=U.prototype.find;
U.prototype.get=function(b){if(0==this.a.length)return null;b-=this.a[0].position;return 0>b||b>=this.a.length?null:this.a[b]};U.prototype.get=U.prototype.get;U.prototype.offset=function(b){for(var c=0;c<this.a.length;++c)this.a[c].startTime+=b,this.a[c].endTime+=b};U.prototype.offset=U.prototype.offset;
U.prototype.Jc=function(b){for(var c=[],d=0,e=0;d<this.a.length&&e<b.length;){var f=this.a[d],g=b[e];f.startTime<g.startTime?(c.push(f),d++):(f.startTime>g.startTime?0==d?c.push(g):A.l("Refusing to rewrite original references on update!"):(.1<Math.abs(f.endTime-g.endTime)?c.push(new T(f.position,g.startTime,g.endTime,g.c,g.b,g.a)):c.push(f),d++),e++)}for(;d<this.a.length;)c.push(this.a[d++]);if(c.length)for(d=c[c.length-1].position+1;e<b.length;)f=b[e++],f=new T(d++,f.startTime,f.endTime,f.c,f.b,
f.a),c.push(f);else c=b;this.a=c};U.prototype.merge=U.prototype.Jc;U.prototype.uc=function(b){for(var c=0;c<this.a.length;++c)if(this.a[c].endTime>b){this.a.splice(0,c);return}this.a=[]};U.prototype.evict=U.prototype.uc;function ff(b,c){for(;b.a.length;)if(b.a[b.a.length-1].startTime>=c)b.a.pop();else break;for(;b.a.length;)if(0>=b.a[0].endTime)b.a.shift();else break;if(0!=b.a.length){var d=b.a[b.a.length-1];b.a[b.a.length-1]=new T(d.position,d.startTime,c,d.c,d.b,d.a)}};function kf(b){this.b=b;this.a=new R(b,0);lf||(lf=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}var lf;kf.prototype.ua=function(){return this.a.ua()};
function mf(b){var c=nf(b);if(7<c.length)throw new F(2,3,3002);for(var d=0,e=0;e<c.length;e++)d=256*d+c[e];c=d;d=nf(b);a:{e=L.Ia;for(var f=0;f<lf.length;f++)if(e(d,lf[f])){e=!0;break a}e=!1}if(e)d=b.b.byteLength-b.a.$();else{if(8==d.length&&d[1]&224)throw new F(2,3,3001);e=d[0]&(1<<8-d.length)-1;for(f=1;f<d.length;f++)e=256*e+d[f];d=e}d=b.a.$()+d<=b.b.byteLength?d:b.b.byteLength-b.a.$();e=new DataView(b.b.buffer,b.b.byteOffset+b.a.$(),d);b.a.S(d);return new of(c,e)}
function nf(b){var c=b.a.Rc(),d;for(d=1;8>=d&&!(c&1<<8-d);d++);if(8<d)throw new F(2,3,3002);var e=new Uint8Array(d);e[0]=c;for(c=1;c<d;c++)e[c]=b.a.Rc();return e}function of(b,c){this.id=b;this.a=c}function pf(b){if(8<b.a.byteLength)throw new F(2,3,3002);if(8==b.a.byteLength&&b.a.getUint8(0)&224)throw new F(2,3,3001);for(var c=0,d=0;d<b.a.byteLength;d++){var e=b.a.getUint8(d);c=256*c+e}return c};function qf(){}
qf.prototype.parse=function(b,c,d,e){var f;c=new kf(new DataView(c));if(440786851!=mf(c).id)throw A.error("Not an EBML element."),new F(2,3,3008);var g=mf(c);if(408125543!=g.id)throw A.error("Not a Segment element."),new F(2,3,3009);c=g.a.byteOffset;g=new kf(g.a);for(f=null;g.ua();){var h=mf(g);if(357149030==h.id){f=h;break}}if(!f)throw A.error("Not an Info element."),new F(2,3,3010);g=new kf(f.a);f=1E6;for(h=null;g.ua();){var k=mf(g);if(2807729==k.id)f=pf(k);else if(17545==k.id)if(h=k,4==h.a.byteLength)h=
h.a.getFloat32(0);else if(8==h.a.byteLength)h=h.a.getFloat64(0);else throw new F(2,3,3003);}if(null==h)throw new F(2,3,3011);g=f/1E9;f=h*g;b=mf(new kf(new DataView(b)));if(475249515!=b.id)throw A.error("Not a Cues element."),new F(2,3,3007);return rf(b,c,g,f,d,e)};
function rf(b,c,d,e,f,g){function h(){return f}var k=[];b=new kf(b.a);for(var m=null,n=null;b.ua();){var p=mf(b);if(187==p.id){var q=sf(p);q&&(p=d*q.Af,q=c+q.bf,null!=m&&k.push(new T(k.length,m-g,p-g,h,n,q-1)),m=p,n=q)}}null!=m&&k.push(new T(k.length,m-g,e-g,h,n,null));return k}
function sf(b){var c=new kf(b.a);b=mf(c);if(179!=b.id)throw A.l("Not a CueTime element."),new F(2,3,3013);b=pf(b);c=mf(c);if(183!=c.id)throw A.l("Not a CueTrackPositions element."),new F(2,3,3012);c=new kf(c.a);for(var d=0;c.ua();){var e=mf(c);if(241==e.id){d=pf(e);break}}return{Af:b,bf:d}};function tf(b,c){var d=$e(b,c,"Initialization");if(!d)return null;var e=O(b.P.Ha,b.w.P),f=d.getAttribute("sourceURL");f&&(e=O(e,[f]));f=0;var g=null;if(d=S.D(d,"range",S.fc))f=d.start,g=d.end;return new cf(function(){return e},f,g)}
function uf(b,c){var d=Number(Ze(b,vf,"presentationTimeOffset"))||0,e=Ze(b,vf,"timescale"),f=1;e&&(f=S.ec(e)||1);d=d/f||0;e=tf(b,vf);var g=b.w.contentType;f=b.w.mimeType.split("/")[1];if("text"!=g&&"mp4"!=f&&"webm"!=f)throw A.error("SegmentBase specifies an unsupported container type.",b.w),new F(2,4,4006);if("webm"==f&&!e)throw A.error("SegmentBase does not contain sufficient segment information:","the SegmentBase uses a WebM container,","but does not contain an Initialization element.",b.w),new F(2,
4,4005);g=$e(b,vf,"RepresentationIndex");var h=Ze(b,vf,"indexRange"),k=O(b.P.Ha,b.w.P);h=S.fc(h||"");if(g){var m=g.getAttribute("sourceURL");m&&(k=O(k,[m]));h=S.D(g,"range",S.fc,h)}if(!h)throw A.error("SegmentBase does not contain sufficient segment information:","the SegmentBase does not contain @indexRange","or a RepresentationIndex element.",b.w),new F(2,4,4002);f=wf(b,c,e,k,h.start,h.end,f,d);return{createSegmentIndex:f.createSegmentIndex,findSegmentPosition:f.findSegmentPosition,getSegmentReference:f.getSegmentReference,
initSegmentReference:e,ia:d}}function wf(b,c,d,e,f,g,h,k){var m=b.presentationTimeline,n=!b.ob||!b.T.Fc,p=b.T.start,q=b.T.duration,t=c,u=null;return{createSegmentIndex:function(){var b=[t(e,f,g),"webm"==h?t(d.c(),d.b,d.a):null];t=null;return Promise.all(b).then(function(b){var c=b[0];b=b[1]||null;c="mp4"==h?df(c,f,e,k):(new qf).parse(c,b,e,k);m.ac(c,p);u=new U(c);n&&ff(u,q)})},findSegmentPosition:function(b){return u.find(b)},getSegmentReference:function(b){return u.get(b)}}}
function vf(b){return b.Jb};function xf(b,c){var d=tf(b,yf);var e=zf(b);var f=Ye(b,yf),g=f.ab;0==g&&(A.l("SegmentList@startNumber must be > 0"),g=1);var h=0;f.Y?h=f.Y*(g-1):f.L&&0<f.L.length&&(h=f.L[0].start);e={Y:f.Y,startTime:h,ab:g,ia:f.ia,L:f.L,Ya:e};if(!e.Y&&!e.L&&1<e.Ya.length)throw A.l("SegmentList does not contain sufficient segment information:","the SegmentList specifies multiple segments,","but does not specify a segment duration or timeline.",b.w),new F(2,4,4002);if(!e.Y&&!b.T.duration&&!e.L&&1==e.Ya.length)throw A.l("SegmentList does not contain sufficient segment information:",
"the SegmentList specifies one segment,","but does not specify a segment duration, period duration,","or timeline.",b.w),new F(2,4,4002);if(e.L&&0==e.L.length)throw A.l("SegmentList does not contain sufficient segment information:","the SegmentList has an empty timeline.",b.w),new F(2,4,4002);g=f=null;b.ea.id&&b.w.id&&(g=b.ea.id+","+b.w.id,f=c[g]);h=Af(b.T.duration,e.ab,b.w.P,e);f?(f.Jc(h),f.uc(b.presentationTimeline.Vb()-b.T.start)):(b.presentationTimeline.ac(h,b.T.start),f=new U(h),g&&b.ob&&(c[g]=
f));b.ob&&b.T.Fc||ff(f,b.T.duration);return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:f.find.bind(f),getSegmentReference:f.get.bind(f),initSegmentReference:d,ia:e.ia}}function yf(b){return b.Na}
function Af(b,c,d,e){var f=e.Ya.length;e.L&&e.L.length!=e.Ya.length&&(f=Math.min(e.L.length,e.Ya.length),A.l("The number of items in the segment timeline and the number of segment","URLs do not match, truncating",e.Ya.length,"to",f));for(var g=[],h=e.startTime,k=0;k<f;k++){var m=e.Ya[k],n=O(d,[m.Ee]),p=void 0;p=null!=e.Y?h+e.Y:e.L?e.L[k].end:h+b;g.push(new T(k+c,h,p,function(b){return b}.bind(null,n),m.start,m.end));h=p}return g}
function zf(b){return[b.w.Na,b.W.Na,b.ea.Na].filter(hd.Ka).map(function(b){return S.R(b,"SegmentURL")}).reduce(function(b,d){return 0<b.length?b:d}).map(function(c){c.getAttribute("indexRange")&&!b.rd&&(b.rd=!0,A.l("We do not support the SegmentURL@indexRange attribute on SegmentList.  We only use the SegmentList@duration attribute or SegmentTimeline, which must be accurate."));var d=c.getAttribute("media");c=S.D(c,"mediaRange",S.fc,{start:0,end:null});return{Ee:d,start:c.start,end:c.end}})};function Bf(b,c,d,e){var f=Cf(b);var g=Ye(b,Df);var h=Ze(b,Df,"media"),k=Ze(b,Df,"index");g={Y:g.Y,timescale:g.timescale,ab:g.ab,ia:g.ia,fd:g.fd,L:g.L,Ic:h,Gb:k};h=g.Gb?1:0;h+=g.L?1:0;h+=g.Y?1:0;if(0==h)throw A.error("SegmentTemplate does not contain any segment information:","the SegmentTemplate must contain either an index URL template","a SegmentTimeline, or a segment duration.",b.w),new F(2,4,4002);1!=h&&(A.l("SegmentTemplate containes multiple segment information sources:","the SegmentTemplate should only contain an index URL template,",
"a SegmentTimeline or a segment duration.",b.w),g.Gb?(A.info("Using the index URL template by default."),g.L=null):A.info("Using the SegmentTimeline by default."),g.Y=null);if(!g.Gb&&!g.Ic)throw A.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate's media URL template is missing.",b.w),new F(2,4,4002);if(g.Gb){d=b.w.mimeType.split("/")[1];if("mp4"!=d&&"webm"!=d)throw A.error("SegmentTemplate specifies an unsupported container type.",b.w),new F(2,4,4006);
if("webm"==d&&!f)throw A.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate uses a WebM container,","but does not contain an initialization URL template.",b.w),new F(2,4,4005);e=Xe(g.Gb,b.w.id,null,b.bandwidth||null,null);h=O(b.P.Ha,b.w.P);e=O(h,[e]);b=wf(b,c,f,e,0,null,d,g.ia)}else g.Y?(e||(b.presentationTimeline.Kc(g.Y),b.presentationTimeline.Lc(b.T.start)),b=Ef(b,g)):(e=c=null,b.ea.id&&b.w.id&&(e=b.ea.id+","+b.w.id,c=d[e]),h=Ff(b,g),k=!b.ob||!b.T.Fc,c?
(k&&ff(new U(h),b.T.duration),c.Jc(h),c.uc(b.presentationTimeline.Vb()-b.T.start)):(b.presentationTimeline.ac(h,b.T.start),c=new U(h),e&&b.ob&&(d[e]=c)),k&&ff(c,b.T.duration),b={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:c.find.bind(c),getSegmentReference:c.get.bind(c)});return{createSegmentIndex:b.createSegmentIndex,findSegmentPosition:b.findSegmentPosition,getSegmentReference:b.getSegmentReference,initSegmentReference:f,ia:g.ia}}function Df(b){return b.Kb}
function Ef(b,c){var d=b.T.duration,e=c.Y,f=c.ab,g=c.timescale,h=c.Ic,k=b.bandwidth||null,m=b.w.id,n=b.w;return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(b){return 0>b||d&&b>=d?null:Math.floor(b/e)},getSegmentReference:function(c){var p=c*e,t=p+e;d&&(t=Math.min(t,d));return 0>t||d&&p>=d?null:new T(c,p,t,function(){var d=O(b.P.Ha,n.P),e=Xe(h,m,c+f,k,p*g);return O(d,[e])},0,null)}}}
function Ff(b,c){for(var d=[],e=0;e<c.L.length;e++){var f=e+c.ab;d.push(new T(f,c.L[e].start,c.L[e].end,function(b,c,d,e,f,p,q){e=O(e.Ha,f);b=Xe(b,c,p,d,q);return O(e,[b]).map(function(b){return b.toString()})}.bind(null,c.Ic,b.w.id,b.bandwidth||null,b.P,b.w.P,f,c.L[e].zf+c.fd),0,null))}return d}function Cf(b){var c=Ze(b,Df,"initialization");if(!c)return null;var d=b.w.id,e=b.bandwidth||null,f=b.w;return new cf(function(){var g=Xe(c,d,null,e,null),h=O(b.P.Ha,f.P);return O(h,[g])},0,null)};var V={xb:{},Hb:{},Hd:function(b,c){V.Hb[b]=c}};z("shaka.media.ManifestParser.registerParserByExtension",V.Hd);V.Tc=function(b,c){V.xb[b]=c};z("shaka.media.ManifestParser.registerParserByMime",V.Tc);
V.Ye=function(){var b={};if(hc()){for(var c in V.xb)b[c]=!0;for(var d in V.Hb)b[d]=!0}c={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"};d=r(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"]);for(var e=d.next();!e.done;e=d.next())e=e.value,b[e]=hc()?!!V.xb[e]:ic(e);for(var f in c)b[f]=hc()?!!V.Hb[f]:ic(c[f]);return b};
V.create=function(b,c,d,e){return v(function g(){var h,k;return y(g,function(g){switch(g.j){case 1:return g.U=2,w(g,V.je(b,c,d,e),4);case 4:return h=g.N,g["return"](new h);case 2:throw k=Ba(g),k.severity=2,k;}})})};
V.je=function(b,c,d,e){return v(function g(){var h,k,m,n,p;return y(g,function(g){switch(g.j){case 1:h=V;if(e){if(k=h.xb[e.toLowerCase()])return g["return"](k);A.l("Could not determine manifest type using MIME type ",e)}if(m=h.getExtension(b)){if(n=h.Hb[m])return g["return"](n);A.l("Could not determine manifest type for extension ",m)}else A.l("Could not find extension for ",b);if(e){g.j=2;break}return w(g,h.re(b,c,d),3);case 3:if(e=g.N){if(p=V.xb[e])return g["return"](p);A.l("Could not determine manifest type using MIME type",
e)}case 2:throw new F(2,4,4E3,b);}})})};V.re=function(b,c,d){return v(function f(){var g,h,k;return y(f,function(f){switch(f.j){case 1:return g=Hb([b],d),g.method="HEAD",w(f,c.request(0,g).promise,2);case 2:return h=f.N,k=h.headers["content-type"],f["return"](k?k.toLowerCase().split(";").shift():"")}})})};V.getExtension=function(b){b=(new Wa(b)).qa.split("/").pop().split(".");return 1==b.length?"":b.pop().toLowerCase()};
V.isSupported=function(b,c){return hc()?c in V.xb||V.getExtension(b)in V.Hb?!0:!1:!1};function X(b,c,d,e){this.b=b;this.u=c;this.K=void 0===d?0:d;this.h=this.g=Infinity;this.a=1;this.c=this.f=null;this.i=0;this.v=!0;this.m=0;this.C=void 0===e?!0:e;this.o=0}z("shaka.media.PresentationTimeline",X);X.prototype.da=function(){return this.g};X.prototype.getDuration=X.prototype.da;X.prototype.pe=function(){return this.a};X.prototype.getMaxSegmentDuration=X.prototype.pe;X.prototype.$a=function(b){this.g=b};X.prototype.setDuration=X.prototype.$a;X.prototype.we=function(){return this.b};
X.prototype.getPresentationStartTime=X.prototype.we;X.prototype.Md=function(b){this.i=b};X.prototype.setClockOffset=X.prototype.Md;X.prototype.Od=function(b){this.v=b};X.prototype.setStatic=X.prototype.Od;X.prototype.Nd=function(b){this.h=b};X.prototype.setSegmentAvailabilityDuration=X.prototype.Nd;X.prototype.mf=function(b){this.u=b};X.prototype.setDelay=X.prototype.mf;X.prototype.he=function(){return this.u};X.prototype.getDelay=X.prototype.he;
X.prototype.ac=function(b,c){if(0!=b.length){var d=b[b.length-1].endTime+c;this.Lc(b[0].startTime+c);this.a=b.reduce(function(b,c){return Math.max(b,c.endTime-c.startTime)},this.a);this.c=Math.max(this.c,d);null!=this.b&&this.C&&(this.b=(Date.now()+this.i)/1E3-this.c-this.a);A.A("notifySegments:","maxSegmentDuration="+this.a)}};X.prototype.notifySegments=X.prototype.ac;X.prototype.Lc=function(b){this.f=null==this.f?b:Math.min(this.f,b)};X.prototype.notifyMinSegmentStartTime=X.prototype.Lc;
X.prototype.Kc=function(b){this.a=Math.max(this.a,b);A.A("notifyNewSegmentDuration:","maxSegmentDuration="+this.a)};X.prototype.notifyMaxSegmentDuration=X.prototype.Kc;X.prototype.offset=function(b){null!=this.f&&(this.f+=b);null!=this.c&&(this.c+=b)};X.prototype.offset=X.prototype.offset;X.prototype.aa=function(){return Infinity==this.g&&!this.v};X.prototype.isLive=X.prototype.aa;X.prototype.Gc=function(){return this.aa&&0!==this.o};X.prototype.isLowLatencyLive=X.prototype.Gc;
X.prototype.tb=function(){return Infinity!=this.g&&!this.v};X.prototype.isInProgress=X.prototype.tb;X.prototype.Vb=function(){return Infinity==this.h?this.m:Math.max(this.m,this.qb()-this.h)};X.prototype.getSegmentAvailabilityStart=X.prototype.Vb;X.prototype.Pd=function(b){this.m=b};X.prototype.setUserSeekStart=X.prototype.Pd;X.prototype.qb=function(){return this.aa()||this.tb()?Math.min(Math.max(0,(Date.now()+this.i)/1E3-this.a-this.b)+this.o,this.g):this.g};
X.prototype.getSegmentAvailabilityEnd=X.prototype.qb;X.prototype.Eb=function(b){var c=Math.max(this.f,this.m);return Infinity==this.h?c:Math.max(c,Math.min(this.qb()-this.h+b,this.za()))};X.prototype.getSafeSeekRangeStart=X.prototype.Eb;X.prototype.pb=function(){return this.Eb(0)};X.prototype.getSeekRangeStart=X.prototype.pb;X.prototype.za=function(){var b=Math.max(0,this.qb()-(this.aa()||this.tb()?this.u:0));return this.Gc()?Math.min(b+this.b,(Date.now()+this.i)/1E3-this.K)-this.b:b};
X.prototype.getSeekRangeEnd=X.prototype.za;X.prototype.Rd=function(){return null==this.b||null!=this.c&&this.C?!1:!0};X.prototype.usingPresentationStartTime=X.prototype.Rd;X.prototype.Ld=function(b){this.o=b};X.prototype.setAvailabilityTimeOffset=X.prototype.Ld;function Gf(b,c,d,e,f,g,h){b=Hb(b,e,f,g,h);if(0!=c||null!=d)b.headers.Range=d?"bytes="+c+"-"+d:"bytes="+c+"-";return b};function Hf(){var b=this;this.b=this.a=null;this.f=[];this.c=null;this.o=[];this.h=1;this.u={};this.v=0;this.C=new Pa(5);this.i=new D(function(){If(b)});this.g=new Db;this.m=Infinity}z("shaka.dash.DashParser",Hf);l=Hf.prototype;l.configure=function(b){this.a=b};l.start=function(b,c){var d=this;return v(function f(){var g;return y(f,function(f){switch(f.j){case 1:return d.f=[b],d.b=c,w(f,Jf(d),2);case 2:g=f.N;d.b&&Kf(d,g);if(!d.b)throw new F(2,7,7001);return f["return"](d.c)}})})};
l.stop=function(){this.a=this.b=null;this.f=[];this.c=null;this.o=[];this.u={};null!=this.i&&(this.i.stop(),this.i=null);return this.g.destroy()};l.update=function(){Jf(this)["catch"](function(b){if(this.b)this.b.onError(b)}.bind(this))};l.onExpirationUpdated=function(){};
function Jf(b){var c=Date.now(),d=b.b.networkingEngine.request(0,Hb(b.f,b.a.retryParameters));Eb(b.g,d);return d.promise.then(function(c){if(b.b)return c.uri&&!b.f.includes(c.uri)&&b.f.unshift(c.uri),Lf(b,c.data,c.uri)}).then(function(){var d=(Date.now()-c)/1E3;Qa(b.C,1,d);return d})}function Mf(b){this.Ha=b}
function Lf(b,c,d){c=S.Bd(c,"MPD");if(!c)throw new F(2,4,4001,d);c=bf(c,b.a.retryParameters,b.a.dash.xlinkFailGracefully,d,b.b.networkingEngine);Eb(b.g,c);return c.promise.then(function(c){return Nf(b,c,d)})}
function Nf(b,c,d){return v(function f(){var g,h,k,m,n,p,q,t,u,E,B,C,J,Z,xa,na,ka,ya,cb,za,W,Ua,Aa,db,gf,hf,jf,zd,Ad,qg;return y(f,function(f){switch(f.j){case 1:m=hd;n=S;p=[d];q=n.R(c,"Location").map(n.Tb).filter(m.Ka);0<q.length&&(t=O(p,q),p=b.f=t);u=n.R(c,"BaseURL");E=u.map(n.Tb);B=O(p,E);C=0;u&&u.length&&(C=n.D(u[0],"availabilityTimeOffset",n.parseFloat)||0);J=b.a.dash.ignoreMinBufferTime;Z=0;J||(Z=n.D(c,"minBufferTime",n.Ba));b.v=n.D(c,"minimumUpdatePeriod",n.Ba,-1);xa=n.D(c,"availabilityStartTime",
n.Ue);na=n.D(c,"timeShiftBufferDepth",n.Ba);ka=n.D(c,"maxSegmentDuration",n.Ba);ya=c.getAttribute("type")||"static";cb=b.a.dash.ignoreSuggestedPresentationDelay;za=null;cb||(za=n.D(c,"suggestedPresentationDelay",n.Ba));b.c?W=b.c.presentationTimeline:(Ua=Math.max(b.a.dash.defaultPresentationDelay,1.5*Z),Aa=null!=za?za:Ua,W=new X(xa,Aa,b.a.dash.targetLatency,b.a.dash.autoCorrectDrift));b.c&&b.c.P?(db=b.c.P,db.Ha=B):db=new Mf(B);gf={ob:"static"!=ya,presentationTimeline:W,ea:null,T:null,W:null,w:null,
bandwidth:0,rd:!1,P:db,nb:C};for(var rg=gf,Lj=[""],Wb=S.D(c,"mediaPresentationDuration",S.Ba),Xb=[],Ra=0,tb=S.R(c,"Period"),Da=0;Da<tb.length;Da++){var Xa=tb[Da];Ra=S.D(Xa,"start",S.Ba,Ra);var ub=S.D(Xa,"duration",S.Ba),Ea=null;if(Da!=tb.length-1){var Oc=S.D(tb[Da+1],"start",S.Ba);null!=Oc&&(Ea=Oc-Ra)}else null!=Wb&&(Ea=Wb-Ra);Oc=kd;Ea&&ub&&Math.abs(Ea-ub)>Oc&&A.l("There is a gap/overlap between Periods",Xa);null==Ea&&(Ea=ub);Xa=Of(b,rg,Lj,{start:Ra,duration:Ea,node:Xa,Fc:null==Ea||Da==tb.length-
1});Xb.push(Xa);ub=rg.ea.id;b.o.includes(ub)||(b.o.push(ub),b.c&&(b.b.filterNewPeriod(Xa),b.c.periods.push(Xa)));if(null==Ea){Da!=tb.length-1&&A.l("Skipping Period",Da+1,"and any subsequent Periods:","Period",Da+1,"does not have a valid start time.",Xb[Da+1]);Ra=null;break}Ra+=Ea}null==b.c&&b.b.filterAllPeriods(Xb);null!=Wb?(Ra!=Wb&&A.l("@mediaPresentationDuration does not match the total duration of all","Periods."),g=Xb,h=Wb,k=!1):(g=Xb,h=Ra,k=!0);hf=h;jf=g;W.Od("static"==ya);"static"!=ya&&k||W.$a(hf||
Infinity);W.Ld(b.m);(zd=W.aa())&&!isNaN(b.a.availabilityWindowOverride)&&(na=b.a.availabilityWindowOverride);null==na&&(na=Infinity);W.Nd(na);W.Kc(ka||1);if(b.c){f.j=0;break}b.c={P:db,presentationTimeline:W,periods:jf,offlineSessionIds:[],minBufferTime:Z||0};if(!W.Rd()){f.j=0;break}Ad=n.R(c,"UTCTiming");return w(f,Pf(b,B,Ad),4);case 4:qg=f.N;if(!b.b)return f["return"]();W.Md(qg);x(f)}})})}
function Of(b,c,d,e){c.ea=Qf(e.node,null,d);c.T=e;c.ea.nb=c.nb;c.ea.id||(A.info("No Period ID given for Period with start time "+e.start+",  Assigning a default"),c.ea.id="__shaka_period_"+e.start);S.R(e.node,"EventStream").forEach(b.We.bind(b,e.start,e.duration));d=S.R(e.node,"AdaptationSet").map(b.Te.bind(b,c)).filter(hd.Ka);if(c.ob){c=[];for(var f=r(d),g=f.next();!g.done;g=f.next()){g=r(g.value.cf);for(var h=g.next();!h.done;h=g.next())c.push(h.value)}if(c.length!=(new Set(c)).size)throw new F(2,
4,4018);}var k=d.filter(function(b){return!b.ed});d.filter(function(b){return b.ed}).forEach(function(b){var c=b.streams[0],d=b.ed;k.forEach(function(b){b.id==d&&b.streams.forEach(function(b){b.trickModeVideo=c})})});c=Rf(k,"video");f=Rf(k,"audio");if(!c.length&&!f.length)throw new F(2,4,4004);d=b.a.disableAudio;if(!f.length||d)f=[null];d=b.a.disableVideo;if(!c.length||d)c=[null];d=[];for(g=0;g<f.length;g++)for(h=0;h<c.length;h++)Sf(b,f[g],c[h],d);c=[];if(!b.a.disableText)for(b=Rf(k,"text"),f=0;f<
b.length;f++)c.push.apply(c,b[f].streams);return{startTime:e.start,textStreams:c,variants:d}}function Rf(b,c){return b.filter(function(b){return b.contentType==c})}
function Sf(b,c,d,e){if(c||d)if(c&&d){var f=c.drmInfos;var g=d.drmInfos;if(f.length&&g.length?0<Zc(f,g).length:1){g=Zc(c.drmInfos,d.drmInfos);for(var h=0;h<c.streams.length;h++)for(var k=0;k<d.streams.length;k++)f=(d.streams[k].bandwidth||0)+(c.streams[h].bandwidth||0),f={id:b.h++,language:c.language,primary:c.Hc||d.Hc,audio:c.streams[h],video:d.streams[k],bandwidth:f,drmInfos:g,allowedByApplication:!0,allowedByKeySystem:!0},e.push(f)}}else for(g=c||d,h=0;h<g.streams.length;h++)f=g.streams[h].bandwidth||
0,f={id:b.h++,language:g.language||"und",primary:g.Hc,audio:c?g.streams[h]:null,video:d?g.streams[h]:null,bandwidth:f,drmInfos:g.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0},e.push(f)}
l.Te=function(b,c){b.W=Qf(c,b.ea,null);if("image"==b.W.contentType)return A.l("Skipping Image AdaptationSet",b.W),null;var d=!1,e=S.R(c,"Role"),f=e.map(function(b){return b.getAttribute("value")}).filter(hd.Ka),g=void 0,h="text"==b.W.contentType;h&&(g="subtitle");for(var k=0;k<e.length;k++){var m=e[k].getAttribute("schemeIdUri");if(null==m||"urn:mpeg:dash:role:2011"==m)switch(m=e[k].getAttribute("value"),m){case "main":d=!0;break;case "caption":case "subtitle":g=m}}var n=null,p=!1;S.R(c,"EssentialProperty").forEach(function(b){"http://dashif.org/guidelines/trickmode"==
b.getAttribute("schemeIdUri")?n=b.getAttribute("value"):p=!0});k=S.R(c,"Accessibility");var q=new Map;e={};k=r(k);for(m=k.next();!m.done;e={Db:e.Db},m=k.next()){var t=m.value;m=t.getAttribute("schemeIdUri");t=t.getAttribute("value");"urn:scte:dash:cc:cea-608:2015"==m||"urn:scte:dash:cc:cea-708:2015"==m?(e.Db=1,null!=t?t.split(";").forEach(function(b){return function(c){if(c.includes("=")){c=c.split("=");var d=c[0].startsWith("CC")?c[0]:"CC"+c[0];c=c[1].split(",")[0].split(":").pop()}else d="CC"+b.Db,
b.Db+=2;q.set(d,P(c))}}(e)):q.set("CC1","und")):"urn:mpeg:dash:role:2011"==m&&null!=t&&(f.push(t),"captions"==t&&(g="caption"))}if(p)return null;e=S.R(c,"ContentProtection");var u=Pe(e,this.a.dash.customScheme,this.a.dash.ignoreDrmInfo);e=P(c.getAttribute("lang")||"und");k=c.getAttribute("label");(m=S.R(c,"Label"))&&m.length&&(m=m[0],m.textContent&&(k=m.textContent));m=S.R(c,"Representation");f=m.map(this.Xe.bind(this,b,u,g,e,k,d,f,q)).filter(function(b){return!!b});if(0==f.length){if(this.a.dash.ignoreEmptyAdaptationSet||
h)return null;throw new F(2,4,4003);}b.W.contentType&&"application"!=b.W.contentType||(b.W.contentType=Tf(f[0].mimeType,f[0].codecs),f.forEach(function(c){c.type=b.W.contentType}));f.forEach(function(b){u.drmInfos.forEach(function(c){b.keyId&&c.keyIds.push(b.keyId)})});h=m.map(function(b){return b.getAttribute("id")}).filter(hd.Ka);return{id:b.W.id||"__fake__"+this.h++,contentType:b.W.contentType,language:e,Hc:d,streams:f,drmInfos:u.drmInfos,ed:n,cf:h}};
l.Xe=function(b,c,d,e,f,g,h,k,m){b.w=Qf(m,b.W,null);this.m=Math.min(this.m,b.w.nb);if(!Uf(b.w))return A.l("Skipping Representation",b.w),null;b.bandwidth=S.D(m,"bandwidth",S.ec)||0;var n=b.w.contentType;n="text"==n||"application"==n;try{var p=this.df.bind(this);if(b.w.Jb)var q=uf(b,p);else if(b.w.Na)q=xf(b,this.u);else if(b.w.Kb)q=Bf(b,p,this.u,!!this.c);else{var t=O(b.P.Ha,b.w.P),u=b.T.duration||0;q={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(b){return 0<=b&&b<
u?1:null},getSegmentReference:function(b){return 1!=b?null:new T(1,0,u,function(){return t},0,null)},initSegmentReference:null,ia:0}}}catch(E){if(n&&4002==E.code)return null;throw E;}m=S.R(m,"ContentProtection");m=Se(m,this.a.dash.customScheme,c,this.a.dash.ignoreDrmInfo);return{id:this.h++,originalId:b.w.id,createSegmentIndex:q.createSegmentIndex,findSegmentPosition:q.findSegmentPosition,getSegmentReference:q.getSegmentReference,initSegmentReference:q.initSegmentReference,presentationTimeOffset:q.ia,
mimeType:b.w.mimeType,codecs:b.w.codecs,frameRate:b.w.frameRate,pixelAspectRatio:b.w.pixelAspectRatio,bandwidth:b.bandwidth,width:b.w.width,height:b.w.height,kind:d,encrypted:0<c.drmInfos.length,keyId:m,language:e,label:f,type:b.W.contentType,primary:g,trickModeVideo:null,emsgSchemeIdUris:b.w.emsgSchemeIdUris,roles:h,channelsCount:b.w.Mc,audioSamplingRate:b.w.audioSamplingRate,closedCaptions:k}};
function If(b){v(function d(){var e,f;return y(d,function(d){switch(d.j){case 1:return A.info("Updating manifest..."),e=0,d.U=2,w(d,Jf(b),4);case 4:e=d.N;wa(d,3);break;case 2:f=Ba(d),b.b&&(f.severity=1,b.b.onError(f));case 3:if(!b.b)return d["return"]();Kf(b,e);x(d)}})})}function Kf(b,c){0>b.v||b.i.V(Math.max(3,b.v-c,Sa(b.C)))}
function Qf(b,c,d){c=c||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,Mc:null,audioSamplingRate:null,nb:0};d=d||c.P;var e=S.wb,f=S.be,g=S.R(b,"BaseURL"),h=g.map(S.Tb),k=b.getAttribute("contentType")||c.contentType,m=b.getAttribute("mimeType")||c.mimeType,n=b.getAttribute("codecs")||c.codecs;f=S.D(b,"frameRate",f)||c.frameRate;var p=b.getAttribute("sar")||c.pixelAspectRatio,q=S.R(b,"InbandEventStream"),t=c.emsgSchemeIdUris.slice();q=r(q);for(var u=q.next();!u.done;u=q.next())u=
u.value.getAttribute("schemeIdUri"),t.includes(u)||t.push(u);q=S.R(b,"AudioChannelConfiguration");q=Vf(q)||c.Mc;u=S.D(b,"audioSamplingRate",e)||c.audioSamplingRate;k||(k=Tf(m,n));var E=S.Sb(b,"SegmentBase"),B=S.Sb(b,"SegmentTemplate"),C=E?S.D(E,"availabilityTimeOffset",S.parseFloat)||0:0,J=B?S.D(B,"availabilityTimeOffset",S.parseFloat)||0:0;g=g&&g.length?S.D(g[0],"availabilityTimeOffset",S.parseFloat)||0:0;g=c.nb+g+C+J;return{P:O(d,h),Jb:E||c.Jb,Na:S.Sb(b,"SegmentList")||c.Na,Kb:B||c.Kb,width:S.D(b,
"width",e)||c.width,height:S.D(b,"height",e)||c.height,contentType:k,mimeType:m,codecs:n,frameRate:f,pixelAspectRatio:p,emsgSchemeIdUris:t,id:b.getAttribute("id"),Mc:q,audioSamplingRate:u,nb:g}}
function Vf(b){for(var c=0;c<b.length;++c){var d=b[c],e=d.getAttribute("schemeIdUri");if(e&&(d=d.getAttribute("value")))switch(e){case "urn:mpeg:dash:outputChannelPositionList:2012":return d.trim().split(/ +/).length;case "urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case "urn:dts:dash:audio_channel_configuration:2012":var f=parseInt(d,10);if(!f){A.l("Channel parsing failure! Ignoring scheme and value",e,d);continue}return f;case "tag:dolby.com,2014:dash:audio_channel_configuration:2011":case "urn:dolby:dash:audio_channel_configuration:2011":f=
parseInt(d,16);if(!f){A.l("Channel parsing failure! Ignoring scheme and value",e,d);continue}for(b=0;f;)f&1&&++b,f>>=1;return b;default:A.l("Unrecognized audio channel scheme:",e,d)}}return null}
function Uf(b){var c=b.Jb?1:0;c+=b.Na?1:0;c+=b.Kb?1:0;if(0==c){if("text"==b.contentType||"application"==b.contentType)return!0;A.l("Representation does not contain a segment information source:","the Representation must contain one of SegmentBase, SegmentList,",'SegmentTemplate, or explicitly indicate that it is "text".',b);return!1}1!=c&&(A.l("Representation contains multiple segment information sources:","the Representation should only contain one of SegmentBase,","SegmentList, or SegmentTemplate.",
b),b.Jb?(A.info("Using SegmentBase by default."),b.Na=null):A.info("Using SegmentList by default."),b.Kb=null);return!0}
function Wf(b,c,d,e){c=O(c,[d]);c=Hb(c,b.a.retryParameters);c.method=e;c=b.b.networkingEngine.request(4,c);Eb(b.g,c);return c.promise.then(function(b){if("HEAD"==e){if(!b.headers||!b.headers.date)return A.l("UTC timing response is missing","expected date header"),0;b=b.headers.date}else b=qc(b.data);b=Date.parse(b);return isNaN(b)?(A.l("Unable to parse date from UTC timing response"),0):b-Date.now()})}
function Pf(b,c,d){d=d.map(function(b){return{scheme:b.getAttribute("schemeIdUri"),value:b.getAttribute("value")}});var e=b.a.dash.clockSyncUri;!d.length&&e&&d.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:e});return hd.$d(d,function(b){var d=b.scheme;b=b.value;switch(d){case "urn:mpeg:dash:utc:http-head:2014":case "urn:mpeg:dash:utc:http-head:2012":return Wf(this,c,b,"HEAD");case "urn:mpeg:dash:utc:http-xsdate:2014":case "urn:mpeg:dash:utc:http-iso:2014":case "urn:mpeg:dash:utc:http-xsdate:2012":case "urn:mpeg:dash:utc:http-iso:2012":return Wf(this,
c,b,"GET");case "urn:mpeg:dash:utc:direct:2014":case "urn:mpeg:dash:utc:direct:2012":return d=Date.parse(b),isNaN(d)?0:d-Date.now();case "urn:mpeg:dash:utc:http-ntp:2014":case "urn:mpeg:dash:utc:ntp:2014":case "urn:mpeg:dash:utc:sntp:2014":return A.ra("NTP UTCTiming scheme is not supported"),Promise.reject();default:return A.ra("Unrecognized scheme in UTCTiming element",d),Promise.reject()}}.bind(b))["catch"](function(){A.ra("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!");
return 0})}l.We=function(b,c,d){var e=S.wb,f=d.getAttribute("schemeIdUri")||"",g=d.getAttribute("value")||"",h=S.D(d,"timescale",e)||1;S.R(d,"Event").forEach(function(d){var k=S.D(d,"presentationTime",e)||0,n=S.D(d,"duration",e)||0;k=k/h+b;n=k+n/h;null!=c&&(k=Math.min(k,b+c),n=Math.min(n,b+c));d={schemeIdUri:f,value:g,startTime:k,endTime:n,id:d.getAttribute("id")||"",eventElement:d};this.b.onTimelineRegionAdded(d)}.bind(this))};
l.df=function(b,c,d){b=Gf(b,c,d,this.a.retryParameters);b=this.b.networkingEngine.request(1,b);Eb(this.g,b);return b.promise.then(function(b){return b.data})};function Tf(b,c){return Kd(dc(b,c))?"text":b.split("/")[0]}V.Hd("mpd",Hf);V.Tc("application/dash+xml",Hf);V.Tc("video/vnd.mpeg.dash.mpd",Hf);function Xf(b,c){this.a=b;this.b=c}Xf.prototype.toString=function(){return"v"+this.a+"."+this.b};function Yf(b,c){var d=new Xf(2,6),e=Zf,f=e.a,g=d.b-f.b;(0<(d.a-f.a||g)?e.c:e.b)(e.a,d,b,c)}function $f(b,c,d,e){A.ra([d,"has been deprecated and will be removed in",c,". We are currently at version",b,". Additional information:",e].join(" "))}function ag(b,c,d,e){A.nc([d,"has been deprecated and has been removed in",c,". We are now at version",b,". Additional information:",e].join(""))}var Zf=null;function bg(){this.a=new Map}function cg(b,c,d){dg(b,c).text=d}function dg(b,c){b.a.has(c)||b.a.set(c,new eg);return b.a.get(c)}function eg(){this.text=this.variant=null};function fg(b,c){this.a=b;this.b=new Set([b]);c=c||[];for(var d=r(c),e=d.next();!e.done;e=d.next())this.add(e.value)}fg.prototype.add=function(b){if(gg(this.a,b))return this.b.add(b),!0;A.l("Rejecting variant - not compatible with root.");return!1};
function gg(b,c){var d;if(!(d=!!b.audio!=!!c.audio||!!b.video!=!!c.video||b.language!=c.language)&&(d=b.audio&&c.audio)){d=b.audio;var e=c.audio;d=!(d.channelsCount==e.channelsCount&&hg(d,e)&&ig(d.roles,e.roles))}!d&&(d=b.video&&c.video)&&(d=b.video,e=c.video,d=!(hg(d,e)&&ig(d.roles,e.roles)));return d?!1:!0}fg.prototype.values=function(){return this.b.values()};
function hg(b,c){if(b.mimeType!=c.mimeType)return!1;var d=b.codecs.split(",").map(function(b){return gc(b)[0]}),e=c.codecs.split(",").map(function(b){return gc(b)[0]});if(d.length!=e.length)return!1;d.sort();e.sort();for(var f=0;f<d.length;f++)if(d[f]!=e[f])return!1;return!0}function ig(b,c){var d=new Set(b),e=new Set(c);d["delete"]("main");e["delete"]("main");if(d.size!=e.size)return!1;d=r(d);for(var f=d.next();!f.done;f=d.next())if(!e.has(f.value))return!1;return!0};function jg(b){this.a=b;this.b=new kg(b.language,"",b.audio&&b.audio.channelsCount?b.audio.channelsCount:0,"")}jg.prototype.create=function(b){var c=this,d=b.filter(function(b){return gg(c.a,b)});return d.length?new fg(d[0],d):this.b.create(b)};function kg(b,c,d,e,f){this.f=b;this.c=c;this.a=d;this.b=void 0===e?"":e;this.g=void 0===f?"":f}
kg.prototype.create=function(b){var c=[];c=lg(b,this.f);var d=b.filter(function(b){return b.primary});c=c.length?c:d.length?d:b;this.c&&(b=mg(c,this.c,this.g),b.length?c=b:A.l("No exact match for variant role could be found."));this.a&&(b=je(c,this.a),b.length?c=b:A.l("No exact match for the channel count could be found."));this.b&&(b=ng(c,this.b),b.length?c=b:A.l("No exact match for variant label could be found."));b=new fg(c[0]);c=r(c);for(d=c.next();!d.done;d=c.next())d=d.value,gg(b.a,d)&&b.add(d);
return b};function lg(b,c){var d=P(c),e=he(d,b.map(function(b){return ge(b)}));return e?b.filter(function(b){return e==ge(b)}):[]}function mg(b,c,d){return b.filter(function(b){if(d){var e=b[d];return e&&e.roles.includes(c)}e=b.audio;b=b.video;return e&&0<=e.roles.indexOf(c)||b&&0<=b.roles.indexOf(c)})}function ng(b,c){return b.filter(function(b){return b.audio?b.audio.label.toLowerCase()==c.toLowerCase():!1})};function og(){this.a=pg;this.b=(new Map).set(pg,2).set(sg,1)}function tg(b,c,d){b.b.set(pg,d).set(sg,c)}var sg=0,pg=1;function ug(b,c){this.g=b;this.h=vg(b);this.a=b.a.currentTime;this.f=Date.now()/1E3;this.b=!1;this.i=c;this.c=function(){}}ug.prototype.release=function(){this.g=null;this.c=function(){}};function wg(b,c){b.c=c}function xg(b){this.a=b}function vg(b){if(b.a.paused||0==b.a.playbackRate||0==b.a.buffered.length)var c=!1;else a:{c=b.a.buffered;b=b.a.currentTime;for(var d=0;d<c.length;d++){var e=c.start(d),f=c.end(d);if(!(b<e-.1||b>f-.5)){c=!0;break a}}c=!1}return c};function yg(b,c,d,e,f){var g=this;this.a=b;this.v=c;this.u=d;this.m=f;this.f=new N;this.i=!1;this.o=b.readyState;this.c=!1;this.b=e;this.h=!1;this.f.B(b,"waiting",function(){return zg(g)});this.g=(new D(function(){zg(g)})).Ea(.25)}yg.prototype.release=function(){this.f&&(this.f.release(),this.f=null);null!=this.g&&(this.g.stop(),this.g=null);this.b&&(this.b.release(),this.b=null);this.a=this.v=this.m=null};yg.prototype.Oc=function(){this.h=!0;zg(this)};
function zg(b){if(0!=b.a.readyState){if(b.a.seeking){if(!b.i)return}else b.i=!1;if(!b.a.paused){b.a.readyState!=b.o&&(b.c=!1,b.o=b.a.readyState);var c;if(!(c=!b.b)){c=b.b;var d=c.g,e=vg(d),f=d.a.currentTime,g=Date.now()/1E3;if(c.a!=f||c.h!=e)c.f=g,c.a=f,c.h=e,c.b=!1;f=g-c.f;if(e=f>=c.i&&e&&!c.b)c.c(c.a,f),c.b=!0,c.a=d.a.currentTime;c=!e}if(c){var h=b.u.smallGapLimit;c=b.a.currentTime;d=b.a.buffered;a:{if(d&&d.length&&!(1==d.length&&1E-6>d.end(0)-d.start(0)))for(e=kc()||mc("Trident/")||mc("Tizen")||
mc("CrKey")?.5:.1,f=0;f<d.length;f++)if(d.start(f)>c&&(0==f||d.end(f-1)-c<=e)){e=f;break a}e=null}if(!(null==e||0==e&&!b.h||(f=d.start(e),f>=b.v.za()))){g=f-c;h=g<=h;var k=!1;if(!(.001>g)){if(!h&&!b.c){b.c=!0;var m=new I("largegap",{currentTime:c,gapSize:g});m.cancelable=!0;b.m(m);b.u.jumpLargeGaps&&!m.defaultPrevented?k=!0:A.info("Ignoring large gap at",c,"size",g)}if(h||k)0==e?A.info("Jumping forward",g,"seconds because of gap before start time of",f):A.info("Jumping forward",g,"seconds because of gap starting at",
d.end(e-1),"and ending at",f),b.a.currentTime=f}}}}}};function Ag(b){var c=this;this.c=b;this.a=new Set;this.b=(new D(function(){Bg(c,!1)})).Ea(.25)}Ag.prototype.release=function(){this.b.stop();for(var b=r(this.a),c=b.next();!c.done;c=b.next())c.value.release();this.a.clear()};function Bg(b,c){for(var d=r(b.a),e=d.next();!e.done;e=d.next())e.value.g(b.c.currentTime,c)};function Cg(b){var c=[];b=r(b);for(var d=b.next();!d.done;d=b.next()){d=r(d.value.variants);for(var e=d.next();!e.done;e=d.next())c.push(e.value)}return c}function Dg(b,c){for(var d=null,e=r(b),f=e.next();!f.done;f=e.next())f=f.value,c>=f.startTime&&(d=f);return d};function Eg(b){this.c=b;this.a=null;this.b=function(){}}Eg.prototype.release=function(){this.a=this.c=null;this.b=function(){}};Eg.prototype.g=function(b){var c=this.a,d=this.c.periods;b=Dg(d,b)||d[0];c!=b&&this.b(b);this.a=b};function Fg(b,c){b.b=c};function Gg(b){var c=this;this.a=b;this.f=!1;this.c=this.a.Ub();this.b=new D(function(){c.a.td(.25*c.c)})}Gg.prototype.release=function(){this.b&&(this.b.stop(),this.b=null);this.a=null};Gg.prototype.set=function(b){this.c=b;Hg(this)};function Hg(b){b.b.stop();var c=b.f?0:b.c;if(0<=c)try{b.a.Ub()!=c&&b.a.$c(c);return}catch(d){}b.b.Ea(.25);0!=b.a.Ub()&&b.a.$c(0)};/*

 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function Ig(b,c,d,e){c==HTMLMediaElement.HAVE_NOTHING||b.readyState>=c?e():(c=Jg.get(c),d.pa(b,c,e))}var Jg=new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]]);function Kg(b,c,d){var e=this;this.a=b;this.f=c;this.g=d;this.h=!1;this.b=new N;this.c=new Lg(b);Ig(this.a,HTMLMediaElement.HAVE_METADATA,this.b,function(){Mg(e,e.g)})}Kg.prototype.release=function(){this.b&&(this.b.release(),this.b=null);null!=this.c&&(this.c.release(),this.c=null);this.f=function(){};this.a=null};function Ng(b){return b.h?b.a.currentTime:b.g}function Og(b,c){0<b.a.readyState?Pg(b.c,c):Ig(b.a,HTMLMediaElement.HAVE_METADATA,b.b,function(){Mg(b,b.g)})}
function Mg(b,c){.001>Math.abs(b.a.currentTime-c)?Qg(b):(b.b.pa(b.a,"seeking",function(){Qg(b);b.f(!0)}),Pg(b.c,0==b.a.currentTime?c:b.a.currentTime))}function Qg(b){b.h=!0;b.b.B(b.a,"seeking",function(){return b.f(!1)})}function Lg(b){var c=this;this.b=b;this.h=10;this.g=this.c=this.f=0;this.a=new D(function(){0>=c.f?(A.l(["Failed to move playhead from",c.c,"to",c.g].join(" ")),c.a.stop()):c.b.currentTime!=c.c?c.a.stop():(c.b.currentTime=c.g,c.f--)})}
Lg.prototype.release=function(){this.a&&(this.a.stop(),this.a=null);this.b=null};function Pg(b,c){b.c=b.b.currentTime;b.g=c;b.f=b.h;b.b.currentTime=c;b.a.Ea(.1)};function Rg(b){function c(){null==d.c?d.f=!0:(d.b.pa(d.a,"seeking",function(){d.f=!0}),d.a.currentTime=Math.max(0,d.a.currentTime+d.c))}var d=this;this.a=b;this.f=!1;this.c=null;this.b=new N;Ig(this.a,HTMLMediaElement.HAVE_CURRENT_DATA,this.b,function(){c()})}Rg.prototype.release=function(){this.b&&(this.b.release(),this.b=null);this.a=null};Rg.prototype.o=function(b){this.c=this.f?this.c:b};Rg.prototype.g=function(){return(this.f?this.a.currentTime:this.c)||0};Rg.prototype.u=function(){};
function Sg(b,c,d,e,f,g){var h=this;this.c=b;this.a=c.presentationTimeline;this.C=c.minBufferTime||0;this.h=d;this.v=f;this.m=null;this.f=new yg(b,c.presentationTimeline,d,Tg(b,d),g);this.b=new Kg(b,function(b){a:{var c=h.f;c.i=!0;c.h=!1;c.c=!1;if(!b){b=Ng(h.b);c=Ug(h,b);if(.001<Math.abs(c-b)){var d=Date.now()/1E3;if(!h.m||h.m<d-1){h.m=d;Og(h.b,c);b=void 0;break a}}A.A("Seek to "+b);h.v()}b=void 0}return b},Vg(this,e));this.i=(new D(function(){if(0!=h.c.readyState&&!h.c.paused){var b=Ng(h.b),c=h.a.pb(),
d=h.a.za();3>d-c&&(c=d-3);b<c&&(c=Ug(h,b),A.info("Jumping forward "+(c-b)+" seconds to catch up with the seek range."),h.c.currentTime=c)}})).Ea(.25)}Sg.prototype.release=function(){this.b&&(this.b.release(),this.b=null);this.f&&(this.f.release(),this.f=null);this.i&&(this.i.stop(),this.i=null);this.c=this.b=this.a=this.h=null;this.v=function(){}};Sg.prototype.o=function(b){Og(this.b,b)};Sg.prototype.g=function(){var b=Ng(this.b);return 0<this.c.readyState&&!this.c.paused?Wg(this,b):b};
function Vg(b,c){null==c?c=Infinity>b.a.da()?b.a.pb():b.a.za():0>c&&(c=b.a.za()+c);return Xg(b,Wg(b,c))}Sg.prototype.u=function(){this.f.Oc()};function Xg(b,c){var d=b.a.da();return c>=d?d-b.h.durationBackoff:c}
function Ug(b,c){var d=ed.bind(null,b.c.buffered),e=Math.max(b.C,b.h.rebufferingGoal),f=b.h.safeSeekOffset,g=b.a.pb(),h=b.a.za(),k=b.a.da();3>h-g&&(g=h-3);var m=b.a.Eb(e),n=b.a.Eb(f);e=b.a.Eb(e+f);if(c>=k)return A.A("Playhead past duration."),Xg(b,c);if(c>h)return A.A("Playhead past end."),h;if(c<g){if(d(n))return A.A("Playhead before start & start is buffered"),n;A.A("Playhead before start & start is unbuffered");return e}if(c>=m||d(c))return A.A("Playhead in safe region or in buffered region."),
c;A.A("Playhead outside safe region & in unbuffered region.");return e}function Wg(b,c){var d=b.a.pb();if(c<d)return d;d=b.a.za();return c>d?d:c}function Tg(b,c){if(!c.stallEnabled)return null;var d=c.stallSkip,e=new ug(new xg(b),c.stallThreshold);wg(e,function(c,e){A.debug("Stall detected at "+c+" for "+e+" seconds.");d?(A.debug("Seeking forward "+d+" seconds to break stall."),b.currentTime+=d):(A.debug("Pausing and unpausing to break stall."),b.pause(),b.play())});return e};function Yg(b){var c=this;this.b=function(){};this.a=new Set;this.f=b;this.c=(new D(function(){for(var b=c.f(),e=r(c.a),f=e.next();!f.done;f=e.next())f=f.value,f.endTime<b.start&&c.a["delete"](f)})).Ea(2)}Yg.prototype.release=function(){this.b=function(){};this.a.clear();this.c.stop()};function Zg(b,c){b.b=c};function $g(b){var c=this;this.h=b;this.f=new Map;this.a=function(){};this.b=function(){};this.c=function(){};this.i=[{eb:null,cb:ah,Wa:function(b,e){return c.a(b,e)}},{eb:bh,cb:ah,Wa:function(b,e){return c.a(b,e)}},{eb:ch,cb:ah,Wa:function(b,e){return c.a(b,e)}},{eb:ah,cb:bh,Wa:function(b,e){return c.b(b,e)}},{eb:ah,cb:ch,Wa:function(b,e){return c.b(b,e)}},{eb:bh,cb:ch,Wa:function(b,e){return c.c(b,e)}},{eb:ch,cb:bh,Wa:function(b,e){return c.c(b,e)}}]}
$g.prototype.release=function(){this.h=null;this.f.clear();this.a=function(){};this.b=function(){};this.c=function(){}};$g.prototype.g=function(b,c){for(var d=r(this.h.a),e=d.next();!e.done;e=d.next()){e=e.value;var f=this.f.get(e),g=b<e.startTime?bh:b>e.endTime?ch:ah;this.f.set(e,g);for(var h=r(this.i),k=h.next();!k.done;k=h.next())k=k.value,k.eb==f&&k.cb==g&&k.Wa(e,c)}};function dh(b,c,d,e){b.a=c;b.b=d;b.c=e}var bh=1,ah=2,ch=3;function eh(b,c){this.a=c;this.c=b;this.h=null;this.o=1;this.C=Promise.resolve();this.g=[];this.i=[];this.m=new Map;this.b=new Map;this.v=!1;this.O=null;this.M=this.f=this.u=!1;this.K=0}l=eh.prototype;
l.destroy=function(){var b=this;return v(function d(){var e,f;return y(d,function(d){switch(d.j){case 1:e=[];for(var g=r(b.b.values()),k=g.next();!k.done;k=g.next())f=k.value,fh(f),e.push(gh(f));return w(d,Promise.all(e),2);case 2:b.b.clear(),b.m.clear(),b.a=null,b.c=null,b.C=null,b.i=null,b.h=null,b.g.length=0,b.f=!0,x(d)}})})};l.Dc=function(b){for(var c=0;c<this.g.length;c++)if(this.g[c].startTime<=b&&b<=this.g[c].endTime)return this.g[c];return null};
l.configure=function(b){this.h=b;this.O=new nb({maxAttempts:Math.max(b.retryParameters.maxAttempts,2),baseDelay:b.retryParameters.baseDelay,backoffFactor:b.retryParameters.backoffFactor,fuzzFactor:b.retryParameters.fuzzFactor,timeout:0},!0)};
l.start=function(){var b=this;return v(function d(){var e,f,g;return y(d,function(d){switch(d.j){case 1:return e=b.a.Ua(),f=hh(b,e),g=b.a.wd(b.c.periods[f]),g.variant||g.text?w(d,ih(b,g.variant?g.variant.audio:null,g.variant?g.variant.video:null,g.text,e),2):(A.error("init: no Streams chosen"),d["return"](new F(2,5,5005)));case 2:if(b.f)return d["return"]();A.debug("init: completed initial Stream setup");b.a&&b.a.He&&(A.A("init: calling onInitialStreamsSetup()..."),b.a.He());x(d)}})})};
function jh(b){return kh(b,"audio")}function lh(b){return kh(b,"video")}function kh(b,c){var d=b.b.get(c);return d?d.Ma||d.stream:null}
function mh(b,c){return v(function e(){var f,g,h,k,m,n,p,q,t,u;return y(e,function(e){switch(e.j){case 1:return f=jd,w(e,$d(b.a.J,f.xa),2);case 2:return b.K++,b.M=!1,g=b.K,h=b.a.J,k=new Map,m=new Set,k.set(f.xa,c),m.add(c),w(e,h.init(k,!1),3);case 3:return b.f?e["return"]():w(e,nh(b,m),4);case 4:if(b.f)return e["return"]();p=(n=b.a.J.g.isTextVisible())||b.h.alwaysStreamText;b.K!=g||b.b.has(f.xa)||b.M||!p||(q=b.a.Ua(),t=hh(b,q),u=oh(c,t,0),b.b.set(f.xa,u),ph(b,u,0));x(e)}})})}
function qh(b){b.M=!0;var c=b.b.get("text");c&&(fh(c),gh(c)["catch"](function(){}),b.b["delete"]("text"))}function rh(b,c){var d=b.b.get("video");if(d){var e=d.stream;if(e)if(A.debug("setTrickPlay",c),c){var f=e.trickModeVideo;f&&!d.Ma&&(A.debug("Engaging trick mode stream",f),sh(b,f,!1,0,!1),d.Ma=e)}else if(e=d.Ma)A.debug("Restoring non-trick-mode stream",e),d.Ma=null,sh(b,e,!0,0,!1)}}
function th(b,c,d,e){var f=!1;if(c.video){var g=sh(b,c.video,d,e,!1);f=f||g}c.audio&&(b=sh(b,c.audio,d,e,!1),f=f||b);return f}
function sh(b,c,d,e,f){var g=b.b.get(c.type);if(!g&&"text"==c.type&&b.h.ignoreTextStreamFailures)return mh(b,c),!0;if(!g)return!1;var h=uh(b,c),k=Array.from(b.b.values()).every(function(b){return b.ha==g.ha});if(d&&h!=g.ha&&k)return A.debug("switch: switching to stream in another Period; clearing buffer and changing Periods"),b.b.forEach(function(c){vh(b,c)}),!0;g.Ma&&(A.debug("switch during trick play mode",c),c.trickModeVideo?(g.Ma=c,c=c.trickModeVideo,A.debug("switch found trick play stream",c)):
(g.Ma=null,A.debug("switch found no special trick play stream")));k=b.i[h];if(!k||!k.Ab)return!1;k=b.m.get(c.id);if(!k||!k.Ab)return!1;if(g.stream==c&&!f)return A.debug("switch: Stream "+wh(g)+" already active"),!1;"text"==c.type&&Rd(b.a.J,dc(c.mimeType,c.codecs));g.stream=c;g.Yb=!0;A.debug("switch: switching to Stream "+wh(g));xh(b,g,h);d&&(g.Sa?g.ic=!0:g.La?(g.Qa=!0,g.Qb=e,g.ic=!0):(fh(g),yh(b,g,!0,e)["catch"](function(c){if(b.a)b.a.onError(c)})));return!0}
function xh(b,c,d){d=void 0===d?uh(b,c.stream):d;zh(b,c,d)&&c.Aa&&(A.info("Aborting current segment request"),c.Aa.abort())}
function zh(b,c,d){if(!c.Aa)return!1;var e=b.a.getBandwidthEstimate(),f=c.Aa.c;if(f&&f.stream){if(f.stream===c.stream)return!1;if(b.c.presentationTimeline.Gc())return b=e/f.stream.bandwidth,c.stream.bandwidth<f.stream.bandwidth&&.85>b}f=b.a.Ua();var g=Vd(b.a.J,c.type),h=Ah(b,c,f,g,d);d=h?h.a?h.a-h.b:null:null;h&&!d&&(d=(h.endTime-h.Cc())*c.stream.bandwidth/8);if(isNaN(d))return!1;(h=c.stream.initSegmentReference)&&(d+=(h.a?h.a-h.b:null)||0);return 8*d/e<g-f-Math.max(b.c.minBufferTime||0,b.h.rebufferingGoal)||
c.Aa.b.a>d?!0:!1}function Bh(b,c,d){0>=c||0>=d||b.b.forEach(function(c){return xh(b,c)})}
function Ch(b){function c(c){var f=b.a.J;"text"==c?(c=f.a,c=null==c.a||null==c.b?!1:d>=c.a&&d<c.b):(c=Ud(f,c),c=ed(c,d,e));return c}var d=b.a.Ua(),e=b.h.smallGapLimit,f=!1,g=hh(b,d);if(ac(b.b.values(),function(b){return b.ha==g}))for(var h=r(b.b.keys()),k=h.next();!k.done;k=h.next())k=k.value,c(k)||(vh(b,b.b.get(k)),f=!0);else ac(b.b.keys(),c)||(A.debug("(all): seeked: unbuffered seek: clearing all buffers"),b.b.forEach(function(c){vh(b,c)}),f=!0);f||A.debug("(all): seeked: buffered seek: presentationTime="+
d)}function vh(b,c){var d=wh(c);c.Sa?A.debug(d,"clear: already clearing the buffer"):c.Qa?A.debug(d,"clear: already waiting"):c.La?(A.debug(d,"clear: currently updating"),c.Qa=!0,c.Qb=0):null==Td(b.a.J,c.type)?(A.debug(d,"clear: nothing buffered"),null==c.Fa&&ph(b,c,0)):(A.debug(d,"clear: handling right now"),fh(c),yh(b,c,!1,0)["catch"](function(c){if(b.a)b.a.onError(c)}))}
function ih(b,c,d,e,f){return v(function h(){var k,m,n,p,q,t,u;return y(h,function(h){switch(h.j){case 1:return k=b.a.Ua(),m=hh(b,k),n=jd,p=new Map,q=new Set,c&&(p.set(n.Sd,c),q.add(c)),d&&(p.set(n.gd,d),q.add(d)),e&&(p.set(n.xa,e),q.add(e)),t=b.a.J,u=b.h.forceTransmuxTS,w(h,t.init(p,u),2);case 2:if(b.f)return h["return"]();Dh(b);return w(h,nh(b,q),3);case 3:if(b.f)return h["return"]();p.forEach(function(c,d){if(!b.b.has(d)){var e=oh(c,m,f);b.b.set(d,e);ph(b,e,0)}});x(h)}})})}
function oh(b,c,d){return{stream:b,type:b.type,Xa:null,va:null,Ma:null,Yb:!0,ha:c,endOfStream:!1,La:!1,Fa:null,Qa:!1,Qb:0,ic:!1,Sa:!1,Sc:!1,Fb:!1,Vc:d||0,Aa:null}}
function Eh(b,c){var d=b.i[c];if(d)return A.debug("(all) Period "+c+" is being or has been set up"),d.promise;A.debug("(all) setting up Period "+c);d={promise:new G,Ab:!1};b.i[c]=d;for(var e=new Set,f=r(b.c.periods[c].variants),g=f.next();!g.done;g=f.next())g=g.value,g.video&&e.add(g.video),g.video&&g.video.trickModeVideo&&e.add(g.video.trickModeVideo),g.audio&&e.add(g.audio);f=r(b.c.periods[c].textStreams);for(g=f.next();!g.done;g=f.next())e.add(g.value);b.C=b.C.then(function(){if(!this.f)return nh(this,
e)}.bind(b)).then(function(){this.f||(this.i[c].promise.resolve(),this.i[c].Ab=!0,A.A("(all) setup Period "+c))}.bind(b))["catch"](function(b){this.f||(this.i[c].promise["catch"](function(){}),this.i[c].promise.reject(),delete this.i[c],A.l("(all) failed to setup Period "+c),this.a.onError(b))}.bind(b));return d.promise}
function nh(b,c){return v(function e(){var f,g,h,k,m,n,p;return y(e,function(e){switch(e.j){case 1:f=[];for(var q=r(c),u=q.next();!u.done;u=q.next())g=u.value,(h=b.m.get(g.id))?(A.debug("(all) Stream "+g.id+" is being or has been set up"),f.push(h.promise)):(A.A("(all) setting up Stream "+g.id),b.m.set(g.id,{promise:new G,Ab:!1}),f.push(g.createSegmentIndex()));e.U=2;return w(e,Promise.all(f),4);case 4:if(b.f)return e["return"]();wa(e,3);break;case 2:k=Ba(e);if(b.f)return e["return"]();e=r(c);for(u=
e.next();!u.done;u=e.next())m=u.value,b.m.get(m.id).promise["catch"](function(){}),b.m.get(m.id).promise.reject(),b.m["delete"](m.id);throw k;case 3:q=r(c);for(u=q.next();!u.done;u=q.next())n=u.value,p=b.m.get(n.id),p.Ab||(p.promise.resolve(),p.Ab=!0,A.A("(all) setup Stream "+n.id));x(e)}})})}function Dh(b){var c=b.c.presentationTimeline.da();Infinity>c?b.a.J.$a(c):b.a.J.$a(Math.pow(2,32))}
function Fh(b,c){if(!b.f){var d=wh(c);if(!c.La&&null!=c.Fa&&!c.Sa)if(c.Fa=null,c.Qa)A.debug(d,"skipping update and clearing the buffer"),yh(b,c,c.ic,c.Qb);else{try{var e=Gh(b,c);null!=e&&(ph(b,c,e),c.Fb=!1)}catch(f){Hh(b,f);return}e=Array.from(b.b.values());Ih(b,c);b.v&&e.every(function(b){return b.endOfStream})&&(A.A(d,"calling endOfStream()..."),b.a.J.endOfStream().then(function(){if(!this.f){var b=this.a.J.da();0!=b&&b<this.c.presentationTimeline.da()&&this.c.presentationTimeline.$a(b)}}.bind(b)))}}}
function Gh(b,c){if(Jh(c))return Zd(b.a.J,c.stream.originalId||""),null;var d=wh(c),e=b.a.Ua(),f=Kh(b,c,e);A.I(d,"timeNeeded="+f);var g=uh(b,c.stream),h=hh(b,f),k=Wd(b.a.J,c.type,e);A.I(d,"update_:","presentationTime="+e,"bufferedAhead="+k);var m=Math.max(b.c.minBufferTime||0,b.h.rebufferingGoal,b.h.bufferingGoal)*b.o;if(f>=b.c.presentationTimeline.da())return A.debug(d,"buffered to end of presentation"),c.endOfStream=!0,"video"==c.type&&(f=b.b.get("text"))&&"application/cea-608"==f.stream.mimeType&&
(f.endOfStream=!0),null;c.endOfStream=!1;c.ha=h;if(h!=g)return A.debug(d,"need Period "+h,"presentationTime="+e,"timeNeeded="+f,"currentPeriodIndex="+g),null;if(k>=m)return A.I(d,"buffering goal met"),.5;d=Vd(b.a.J,c.type);d=Ah(b,c,e,d,g);if(!d)return 1;var n=Infinity;Array.from(b.b.values()).forEach(function(c){Jh(c)||(c=Kh(b,c,e),n=Math.min(n,c))});if(f>=n+b.c.presentationTimeline.a)return 1;c.Vc=0;Lh(b,c,e,g,d);return null}
function Kh(b,c,d){if(!c.Xa||!c.va)return Math.max(d,c.Vc);d=uh(b,c.Xa);return b.c.periods[d].startTime+c.va.endTime}function Ah(b,c,d,e,f){var g=wh(c);if(c.va&&c.stream==c.Xa)return d=c.va.position+1,A.I(g,"next position known:","position="+d),Mh(b,c,f,d);c.va?(A.A(g,"next position unknown: another Stream buffered"),g=uh(b,c.Xa),g=Nh(b,c,b.c.periods[g].startTime+c.va.endTime,f)):(A.A(g,"next position unknown: nothing buffered"),g=Nh(b,c,e||d,f));return null==g?null:Mh(b,c,f,g)}
function Nh(b,c,d,e){var f=wh(c);b=b.c.periods[e];A.debug(f,"looking up segment:","presentationTime="+d,"currentPeriod.startTime="+b.startTime);d=Math.max(0,d-b.startTime);c=c.stream.findSegmentPosition(d);null==c&&A.l(f,"cannot find segment:","currentPeriod.startTime="+b.startTime,"lookupTime="+d);return c}
function Mh(b,c,d,e){var f=wh(c);d=b.c.periods[d];c=c.stream.getSegmentReference(e);if(!c)return A.A(f,"segment does not exist:","currentPeriod.startTime="+d.startTime,"position="+e),null;e=b.c.presentationTimeline;b=e.Vb();e=e.qb();return d.startTime+c.endTime<b||d.startTime+c.startTime>e?(A.I(f,"segment is not available:","currentPeriod.startTime="+d.startTime,"reference.startTime="+c.startTime,"reference.endTime="+c.endTime,"availabilityStart="+b,"availabilityEnd="+e),null):c}
function Lh(b,c,d,e,f){v(function h(){var k,m,n,p,q,t,u,E,B,C,J,Z,xa,na,ka,ya,cb,za,W,Ua,Aa;return y(h,function(h){switch(h.j){case 1:return k=jd,m=wh(c),n=b.c.periods[e],A.A(m,"fetchAndAppend_:","presentationTime="+d,"currentPeriod.startTime="+n.startTime,"reference.position="+f.position,"reference.startTime="+f.startTime,"reference.endTime="+f.endTime),p=c.stream,q=b.c.presentationTimeline.da(),t=b.c.periods[e+1],u=Math.max(0,n.startTime-.1),E=t?t.startTime+.01:q,B=Oh(b,c,e,u,E),B["catch"](function(){}),
c.La=!0,c.Yb=!1,A.I(m,"fetching segment"),C=function(){return b.f||b.u},J=[],Z=!1,na=xa=0,ka=new Uint8Array(0),ya=function(e,h){return v(function zd(){var k,m;return y(zd,function(q){switch(q.j){case 1:return k=xa,w(q,B,2);case 2:return w(q,Promise.all(J),3);case 3:if(C()||Z&&!h||k!==xa)return q["return"]();if(h){if(na===e.byteLength)return q["return"]()}else na+=e.byteLength;m=Ph(b,c,d,n,p,f,e);J.push(m);return q["return"](m)}})})},cb=function(b,c){ka=L.concat(ka,c);var d=!1,e=0;(new M).F("mdat",
function(b){e=b.size+b.start;d=!0}).parse(ka,!1,!0);if(d){var f=ka.subarray(0,e);ka=ka.subarray(e);ya(f,!1)["catch"](function(){})}},za=function(){ka=new Uint8Array(0);J=[];xa++;na=0;return c.stream!==p},h.U=2,w(h,Qh(b,c,p,f,cb,za),4);case 4:W=h.N;if(C())return h["return"]();Ua=Z=!0;(new M).F("mdat",function(b){Ua=0!==b.reader.G.byteLength}).parse(W,!1,!1);if(!Ua){h.j=5;break}return w(h,ya(W,!0),5);case 5:if(C())return h["return"]();c.La=!1;c.Sc=!1;c.Xa=p;c.va=f;c.Qa||b.a.Oc();ph(b,c,0);Rh(b,c,p);
A.A(m,"finished fetch and append");wa(h,0);break;case 2:Aa=Ba(h);if(b.f||b.u)return h["return"]();c.La=!1;c.type==k.xa&&b.h.ignoreTextStreamFailures?(1001==Aa.code?A.l(m,"Text stream failed to download. Proceeding without it."):A.l(m,"Text stream failed to parse. Proceeding without it."),b.b["delete"](k.xa)):7001==Aa.code?(c.La=!1,c.Fa=null,ph(b,c,0)):3017==Aa.code?Sh(b,c,Aa):(A.error(m,"failed fetch and append: code="+Aa.code),c.Fb=!0,Aa.severity=2,Hh(b,Aa));x(h)}})})}
function Sh(b,c,d){var e=wh(c);if(Array.from(b.b.values()).some(function(b){return b!=c&&b.Sc}))A.debug(e,"MediaSource threw QuotaExceededError:","waiting for another stream to recover...");else{var f=Math.round(100*b.o);if(20<f)b.o-=.2;else if(4<f)b.o-=.04;else{A.error(e,"MediaSource threw QuotaExceededError too many times");c.Fb=!0;b.u=!0;b.a.onError(d);return}A.l(e,"MediaSource threw QuotaExceededError:","reducing buffering goals by "+(100-Math.round(100*b.o))+"%");c.Sc=!0}ph(b,c,4)}
function Oh(b,c,d,e,f){if(!c.Yb)return Promise.resolve();var g=wh(c);d=b.c.periods[d].startTime-c.stream.presentationTimeOffset;A.A(g,"setting timestamp offset to "+d);A.A(g,"setting append window start to "+e);A.A(g,"setting append window end to "+f);e=ae(b.a.J,c.type,d,e,f);var h=c.stream;if(!h.initSegmentReference)return e;A.A(g,"fetching init segment");b=Qh(b,c,h,h.initSegmentReference,function(){},function(){return c.stream!==h}).then(function(b){if(!this.f)return A.A(g,"appending init segment"),
Xd(this.a.J,c.type,b,null,null,c.stream.closedCaptions&&0<c.stream.closedCaptions.size)}.bind(b)).then(function(b){c.De=h;return b})["catch"](function(b){c.Yb=!0;return Promise.reject(b)});return Promise.all([e,b])}
function Ph(b,c,d,e,f,g,h){if(f.initSegmentReference&&c.De!==f)return Promise.resolve();var k=wh(c),m=f.closedCaptions&&0<f.closedCaptions.size;null!=f.emsgSchemeIdUris&&0<f.emsgSchemeIdUris.length&&(new M).oa("emsg",b.Ve.bind(b,e,g,f.emsgSchemeIdUris)).parse(h);var n=g.startTime+e.startTime,p=g.endTime+e.startTime;return Th(b,c,d).then(function(){if(!this.f)return A.A(k,"appending media segment"),Xd(this.a.J,c.type,h,n,p,m)}.bind(b)).then(function(){if(!this.f){A.I(k,"appended media segment");c.Xa=
f;c.va=g;if("video"!==f.type||0<this.g.length&&this.g[0].Gd===g)return Promise.resolve();for(var b=1;b<this.g.length;b++)if(this.g[b].Gd===g){this.g.splice(b,1);break}this.g.unshift({startTime:n,endTime:p,stream:f,Gd:g});20<this.g.length&&this.g.pop();return Promise.resolve()}}.bind(b))}
l.Ve=function(b,c,d,e){var f=e.reader.Qc(),g=e.reader.Qc(),h=e.reader.H(),k=e.reader.H(),m=e.reader.H(),n=e.reader.H();e=e.reader.Da(e.reader.G.byteLength-e.reader.$());b=b.startTime+c.startTime+k/h;if(d.includes(f))if("urn:mpeg:dash:event:2012"==f)this.a.Ie();else this.a.onEvent(new I("emsg",{detail:{startTime:b,endTime:b+m/h,schemeIdUri:f,value:g,timescale:h,presentationTimeDelta:k,eventDuration:m,id:n,messageData:e}}))};
function Th(b,c,d){var e=wh(c);A.I(e,"checking buffer length");var f=Math.max(b.h.bufferBehind,b.c.presentationTimeline.a),g=Td(b.a.J,c.type);if(null==g)return A.I(e,"buffer behind okay because nothing buffered:","presentationTime="+d,"bufferBehind="+f),Promise.resolve();var h=d-g,k=h-f;if(0>=k)return A.I(e,"buffer behind okay:","presentationTime="+d,"bufferedBehind="+h,"bufferBehind="+f,"underflow="+-k),Promise.resolve();A.A(e,"buffer behind too large:","presentationTime="+d,"bufferedBehind="+h,
"bufferBehind="+f,"overflow="+k);return b.a.J.remove(c.type,g,g+k).then(function(){this.f||A.A(e,"evicted "+k+" seconds")}.bind(b))}
function Rh(b,c,d){if(!b.v){var e=wh(c);c=Array.from(b.b.values());if(1!=c.length||"text"!=c[0].type)b.v=c.every(function(b){return"text"==b.type?!0:!b.Qa&&!b.Sa&&b.va});if(b.v){A.debug(e,"startup complete");d=uh(b,d);b.i[d]||Eh(b,d).then(function(){this.f||(A.A(e,"calling onCanSwitch()..."),this.a.vd())}.bind(b))["catch"](hd.$b);for(d=0;d<b.c.periods.length;++d)Eh(b,d)["catch"](hd.$b);b.a.Oe&&(A.A(e,"calling onStartupComplete()..."),b.a.Oe())}}}
function Ih(b,c){var d=wh(c),e=uh(b,c.stream);if(c.ha!=e){var f=c.ha,g=Array.from(b.b.values());g.every(function(b){return b.ha==f||Jh(b)})?g.every(Uh)?(A.debug(d,"all need Period "+f),Eh(b,f).then(function(){if(!this.f)if(g.every(function(b){var c=Uh(b),d=uh(this,b.stream);return Jh(b)?!0:c&&b.ha==f&&d!=f}.bind(this))){var b=this.c.periods[f];A.A(d,"calling onChooseStreams()...");var c=this.a.wd(b),e=new Map;c.variant&&c.variant.video&&e.set("video",c.variant.video);c.variant&&c.variant.audio&&e.set("audio",
c.variant.audio);c.text&&e.set("text",c.text);c=r(this.b.keys());for(var n=c.next();!n.done;n=c.next())if(n=n.value,!e.has(n)&&"text"!=n){A.error(d,"invalid Streams chosen: missing "+n+" Stream");this.a.onError(new F(2,5,5005));return}c=r(Array.from(e.keys()));for(n=c.next();!n.done;n=c.next())if(n=n.value,!this.b.has(n))if("text"==n)ih(this,null,null,e.get("text"),b.startTime),e["delete"](n);else{A.error(d,"invalid Streams chosen: unusable "+n+" Stream");this.a.onError(new F(2,5,5005));return}c=
r(Array.from(this.b.keys()));for(n=c.next();!n.done;n=c.next()){n=n.value;var p=this.b.get(n),q=e.get(n);if(q){var t=Jh(p);t&&(p.ha=f,p.Vc=b.startTime);sh(this,q,!1,0,!1);t&&Jh(p)||ph(this,this.b.get(n),0)}else this.b["delete"](n)}A.A(d,"calling onCanSwitch()...");this.a.vd()}else A.debug(d,"ignoring transition to Period",f,"since another is happening")}.bind(b))["catch"](hd.$b)):A.debug(d,"all MediaStates need Period "+f+", but not all MediaStates are idle"):A.debug(d,"not all MediaStates need Period "+
f)}}function Jh(b){return b&&"text"==b.type&&"application/cea-608"==b.stream.mimeType}function Uh(b){return!b.La&&null==b.Fa&&!b.Qa&&!b.Sa}function hh(b,c){var d=Dg(b.c.periods,c+kd);return d?b.c.periods.indexOf(d):0}
function uh(b,c){for(var d=b.c.periods,e=0;e<d.length;e++){for(var f=d[e],g=new Set,h=r(f.variants),k=h.next();!k.done;k=h.next())k=k.value,k.audio&&g.add(k.audio),k.video&&g.add(k.video),k.video&&k.video.trickModeVideo&&g.add(k.video.trickModeVideo);f=r(f.textStreams);for(h=f.next();!h.done;h=f.next())g.add(h.value);if(g.has(c))return e}return-1}
function Qh(b,c,d,e,f,g){d=Gf(e.c(),e.b,e.a,b.h.retryParameters,d,f,g);A.I("fetching: reference=",e);b=b.a.Zb.request(1,d);c.Aa=b;return b.promise.then(function(b){c.Aa=null;return b.data})}
function yh(b,c,d,e){return v(function g(){var h,k,m,n;return y(g,function(g){switch(g.j){case 1:return h=wh(c),c.Qa=!1,c.ic=!1,c.Qb=0,c.Sa=!0,c.Xa=null,c.va=null,A.debug(h,"clearing buffer"),e?(m=b.a.Ua(),n=b.a.J.da(),k=b.a.J.remove(c.type,m+e,n)):k=$d(b.a.J,c.type).then(function(){if(!this.f&&d)return this.a.J.flush(c.type)}.bind(b)),w(g,k,2);case 2:if(b.f)return g["return"]();A.debug(h,"cleared buffer");c.Sa=!1;c.endOfStream=!1;ph(b,c,0);x(g)}})})}
function ph(b,c,d){A.I(wh(c),"updating in "+d+" seconds");c.Fa=(new lb(function(){return v(function f(){var d;return y(f,function(f){switch(f.j){case 1:return f.U=2,w(f,Fh(b,c),4);case 4:wa(f,0);break;case 2:d=Ba(f);if(b.a)b.a.onError(d);x(f)}})})})).V(d)}function fh(b){null!=b.Fa&&(b.Fa.stop(),b.Fa=null)}function gh(b){return v(function d(){return y(d,function(d){switch(d.j){case 1:if(b.Aa)return w(d,b.Aa.abort(),0);d.j=0}})})}
function Hh(b,c){pb(b.O).then(function(){this.f||(this.a.onError(c),c.handled||this.h.failureCallback(c))}.bind(b))}function wh(b){return"("+b.type+":"+b.stream.id+")"};function Vh(b,c,d,e,f,g){if(200<=d&&299>=d&&202!=d)return{uri:f||e,Kf:e,data:c,headers:b,fromCache:!!b["x-shaka-from-cache"]};f=null;try{f=Yb(c)}catch(h){}A.debug("HTTP error text:",f);throw new F(401==d||403==d?2:1,1,1001,e,d,f,b,g);};function Wh(b,c,d,e){var f=new Wh.b;bc(c.headers).forEach(function(b,c){f.append(c,b)});var g=new Wh.a,h={qc:!1,dd:!1};b=Wh.h(b,d,{body:c.body||void 0,headers:f,method:c.method,signal:g.signal,credentials:c.allowCrossSiteCredentials?"include":void 0},h,e,c.streamDataCallback);b=new H(b,function(){h.qc=!0;g.abort();return Promise.resolve()});if(c=c.retryParameters.timeout){var k=new D(function(){h.dd=!0;g.abort()});k.V(c/1E3);b["finally"](function(){k.stop()})}return b}
z("shaka.net.HttpFetchPlugin",Wh);
Wh.h=function(b,c,d,e,f,g){return v(function k(){var m,n,p,q,t,u,E,B,C,J,Z,xa,na,ka,ya,cb;return y(k,function(k){switch(k.j){case 1:return m=Wh.g,n=Wh.c,u=t=0,E=Date.now(),C=function(){return!B&&!e.qc&&!e.dd},J={},k.U=2,w(k,m(b,d),4);case 4:return p=k.N,Z=function(){try{p.headers.forEach(function(b,c){J[c.trim()]=b})}catch(W){}},Z(),xa=p.clone().body.getReader(),ka=(na=p.headers.get("Content-Length"))?parseInt(na,10):0,ya=function(b){function c(){return v(function db(){var d,e,k;return y(db,function(m){switch(m.j){case 1:return m.U=
2,w(m,xa.read(),4);case 4:d=m.N;wa(m,3);break;case 2:return e=Ba(m),A.A("error reading from stream",e.message),m["return"]();case 3:k=Date.now();if(!d.done&&(t+=d.value.byteLength,g&&C()))try{g(k-E,d.value)}catch(Ad){}if(100<k-E||d.done)f(k-E,t-u,ka-t,J),u=t,E=k;d.done?b.close():(b.enqueue(d.value),c());x(m)}})})}c()},new n({start:ya}),w(k,p.arrayBuffer(),5);case 5:q=k.N;Z();wa(k,3);break;case 2:B=cb=Ba(k);case 3:if(e.qc)throw new F(1,1,7001,b,c);if(e.dd)throw new F(1,1,1003,b,c);if(B)throw new F(1,
1,1002,b,B,c);return k["return"](Vh(J,q,p.status,b,p.url,c))}})})};Wh.isSupported=function(){if(window.ReadableStream)try{new ReadableStream({})}catch(b){return!1}else return!1;return!(!window.fetch||!window.AbortController)};Wh.isSupported=Wh.isSupported;Wh.g=window.fetch;Wh.a=window.AbortController;Wh.c=window.ReadableStream;Wh.b=window.Headers;Wh.isSupported()&&(Gb("http",Wh,2),Gb("https",Wh,2));function Xh(b,c,d,e){function f(b){try{for(var c=b.getAllResponseHeaders().trim().split("\r\n"),d=r(c),e=d.next();!e.done;e=d.next()){var f=e.value.split(": ");m[f[0].toLowerCase()]=f.slice(1).join(": ")}}catch(B){}}var g=new Xh.f,h=Date.now(),k=0,m={},n=new Promise(function(n,q){g.open(c.method,b,!0);g.responseType="arraybuffer";g.timeout=c.retryParameters.timeout;g.withCredentials=c.allowCrossSiteCredentials;g.onreadystatechange=function(){2===g.readyState&&f(g)};g.onabort=function(){q(new F(1,
1,7001,b,d))};g.onload=function(c){c=c.target;f(c);try{var e=Vh(m,c.response,c.status,b,c.responseURL,d);n(e)}catch(B){q(B)}};g.onerror=function(c){q(new F(1,1,1002,b,c,d))};g.ontimeout=function(){q(new F(1,1,1003,b,d))};g.onprogress=function(b){var c=Date.now();if(100<c-h||b.lengthComputable&&b.loaded==b.total)e(c-h,b.loaded-k,b.total-b.loaded,m),k=b.loaded,h=c};for(var p in c.headers)g.setRequestHeader(p.toLowerCase(),c.headers[p]);g.send(c.body)});return new H(n,function(){g.abort();return Promise.resolve()})}
z("shaka.net.HttpXHRPlugin",Xh);Xh.f=window.XMLHttpRequest;Gb("http",Xh,1);Gb("https",Xh,1);function Yh(b,c){var d=Zh(),e=this;this.h=c;this.c=b;this.f=d;this.i=null;this.g=[];this.b=this.a=null;this.m=!0;this.o=Promise.resolve().then(function(){return $h(e)})}Yh.prototype.destroy=function(){var b=this;return v(function d(){var e;return y(d,function(d){switch(d.j){case 1:return b.m=!1,b.b&&b.b.abort(),ai(b),w(d,b.o,2);case 2:b.a&&b.a.wa.Za();for(var f=r(b.g),h=f.next();!h.done;h=f.next())e=h.value,e.wa.Za();b.a=null;b.g=[];b.h=null;x(d)}})})};
function bi(b,c){var d={ub:function(){},bc:function(){},Za:function(){},onError:function(){},cc:function(){},Jf:function(){}};b.g.push({create:c,wa:d});b.b&&b.b.abort();ai(b);return d}
function $h(b){return v(function d(){return y(d,function(d){switch(d.j){case 1:if(b.m){if(0==b.g.length||b.a&&!b.a.Va)var e=!1;else{b.a&&(b.a.wa.Za(),b.a=null);e=b.g.shift();var g=e.create(b.f);g?(e.wa.ub(),b.a={node:g.node,payload:g.payload,Va:g.Va,wa:e.wa}):e.wa.cc();e=!0}e?e=Promise.resolve():b.a?e=ci(b):(b.h.Ge(b.c),b.i=new G,e=b.i);return w(d,e,1)}d.j=0}})})}
function ci(b){return v(function d(){var e,f;return y(d,function(d){switch(d.j){case 1:return b.c=b.h.te(b.c,b.f,b.a.node,b.a.payload),d.U=2,b.b=b.h.ae(b.c,b.f,b.a.payload),w(d,b.b.promise,4);case 4:b.b=null;b.c==b.a.node&&(b.a.wa.bc(),b.a=null);wa(d,0);break;case 2:e=Ba(d);if(7001==e.code)b.a.wa.Za();else b.a.wa.onError(e);b.a=null;b.b=null;f=b;return w(d,b.h.handleError(b.f,e),5);case 5:f.c=d.N,x(d)}})})}function ai(b){b.i&&(b.i.resolve(),b.i=null)};function di(b){this.a=null;for(var c=0;c<b.textTracks.length;++c){var d=b.textTracks[c];d.mode="disabled";"Shaka Player TextTrack"==d.label&&(this.a=d)}this.a||(this.a=b.addTextTrack("subtitles","Shaka Player TextTrack"));this.a.mode="hidden"}z("shaka.text.SimpleTextDisplayer",di);di.prototype.remove=function(b,c){if(!this.a)return!1;ei(this.a,function(d){return d.startTime<c&&d.endTime>b});return!0};di.prototype.remove=di.prototype.remove;
di.prototype.append=function(b){var c=fi,d=b.map(function(b){if(b.nestedCues.length){var c=b.nestedCues.map(function(b){return b.spacer?"\n":b.payload+" "}).join("").replace(/ $/m,"");b=b.clone();b.nestedCues=[];b.payload=c}return b}),e=[];b=this.a.cues?Array.from(this.a.cues):[];var f={};d=r(d);for(var g=d.next();!g.done;f={sb:f.sb},g=d.next())f.sb=g.value,b.some(function(b){return function(c){return c.startTime==b.sb.startTime&&c.endTime==b.sb.endTime&&c.text==b.sb.payload?!0:!1}}(f))||(g=c(f.sb))&&
e.push(g);e.slice().sort(function(b,c){return b.startTime!=c.startTime?b.startTime-c.startTime:b.endTime!=c.endTime?b.endTime-c.startTime:"line"in VTTCue.prototype?e.indexOf(c)-e.indexOf(b):e.indexOf(b)-e.indexOf(c)}).forEach(function(b){this.a.addCue(b)}.bind(this))};di.prototype.append=di.prototype.append;di.prototype.destroy=function(){this.a&&ei(this.a,function(){return!0});this.a=null;return Promise.resolve()};di.prototype.destroy=di.prototype.destroy;
di.prototype.isTextVisible=function(){return"showing"==this.a.mode};di.prototype.isTextVisible=di.prototype.isTextVisible;di.prototype.setTextVisibility=function(b){this.a.mode=b?"showing":"hidden"};di.prototype.setTextVisibility=di.prototype.setTextVisibility;
function fi(b){if(b.startTime>=b.endTime)return A.l("Invalid cue times: "+b.startTime+" - "+b.endTime),null;var c=new VTTCue(b.startTime,b.endTime,b.payload);c.lineAlign=b.lineAlign;c.positionAlign=b.positionAlign;b.size&&(c.size=b.size);try{c.align=b.textAlign}catch(d){}"center"==b.textAlign&&"center"!=c.align&&(c.align="middle");"vertical-lr"==b.writingMode?c.vertical="lr":"vertical-rl"==b.writingMode&&(c.vertical="rl");1==b.lineInterpretation&&(c.snapToLines=!1);null!=b.line&&(c.line=b.line);null!=
b.position&&(c.position=b.position);return c}function ei(b,c){var d=b.mode;b.mode="showing"==d?"showing":"hidden";for(var e=b.cues,f=e.length-1;0<=f;f--){var g=e[f];g&&c(g)&&b.removeCue(g)}b.mode=d};function gi(b,c,d,e,f){var g=f in e,h=!0,k;for(k in c){var m=f+"."+k,n=g?e[f]:d[k];g||k in d?void 0===c[k]?void 0===n||g?delete b[k]:b[k]=Ab(n):n.constructor==Object&&c[k]&&c[k].constructor==Object?(b[k]||(b[k]=Ab(n)),m=gi(b[k],c[k],n,e,m),h=h&&m):typeof c[k]!=typeof n||null==c[k]||"function"!=typeof c[k]&&c[k].constructor!=n.constructor?(A.nc("Invalid config, wrong type for "+m),h=!1):("function"==typeof d[k]&&d[k].length!=c[k].length&&A.ra("Unexpected number of arguments for "+m),b[k]=c[k]):h=!1}return h}
z("shaka.util.ConfigUtils.mergeConfigObjects",gi);function hi(b,c){for(var d={},e=d,f=0,g=0;;){f=b.indexOf(".",f);if(0>f)break;if(0==f||"\\"!=b[f-1])g=b.substring(g,f).replace(/\\\./g,"."),e[g]={},e=e[g],g=f+1;f+=1}e[b.substring(g).replace(/\\\./g,".")]=c;return d}z("shaka.util.ConfigUtils.convertToConfigObject",hi);function ii(){}z("shaka.util.PlayerConfiguration",ii);
function ji(){var b=5E5,c="shaka-default",d=Infinity;navigator.connection&&(navigator.connection.downlink&&(b=1E6*navigator.connection.downlink,c="shaka-network-api"),navigator.connection.saveData&&(d=360));var e={retryParameters:ob(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,initDataTransform:Rc,fairPlayTransform:!0,updateExpirationTime:1},f={retryParameters:ob(),availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,dash:{customScheme:function(b){if(b)return null},
clockSyncUri:"",ignoreDrmInfo:!1,xlinkFailGracefully:!1,defaultPresentationDelay:10,ignoreMinBufferTime:!1,targetLatency:0,autoCorrectDrift:!0,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1},hls:{ignoreTextStreamFailures:!1,useFullSegmentsForStartTime:!1}},g={retryParameters:ob(),failureCallback:function(b){A.error("Unhandled streaming error",b);return[b]},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,
smallGapLimit:.5,jumpLargeGaps:!1,durationBackoff:1,forceTransmuxTS:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0};if(mc("Web0S")||mc("Tizen")||mc("CrKey"))g.stallSkip=0;var h={trackSelectionCallback:function(b){return v(function p(){return y(p,function(c){switch(c.j){case 1:return c["return"](b)}})})},progressCallback:function(b,c){return[b,c]},usePersistentLicense:!0},k={drm:e,manifest:f,streaming:g,offline:h,abrFactory:Q,abr:{enabled:!0,defaultBandwidthEstimate:b,
defaultBandwidthEstimateSource:c,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:Infinity,minHeight:0,maxHeight:d,minPixels:0,maxPixels:Infinity,minFrameRate:0,maxFrameRate:Infinity,minBandwidth:0,maxBandwidth:Infinity}},preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,restrictions:{minWidth:0,maxWidth:Infinity,minHeight:0,maxHeight:Infinity,minPixels:0,maxPixels:Infinity,
minFrameRate:0,maxFrameRate:Infinity,minBandwidth:0,maxBandwidth:Infinity},playRangeStart:0,playRangeEnd:Infinity,textDisplayFactory:function(){return null}};h.trackSelectionCallback=function(b){return v(function p(){return y(p,function(c){switch(c.j){case 1:return c["return"](ki(b,k.preferredAudioLanguage))}})})};return k}
function li(b,c,d){var e={".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",serverCertificate:new Uint8Array(0),individualizationServer:""}};return gi(b,c,d||ji(),e,"")}ii.mergeConfigObjects=li;
function ki(b,c){var d=b.filter(function(b){return"variant"==b.type}),e=[],f=he(c,d.map(function(b){return b.language}));f&&(e=d.filter(function(b){return P(b.language)==f}));0==e.length&&(e=d.filter(function(b){return b.primary}));0==e.length&&(1<(new Set(d.map(function(b){return b.language}))).size&&A.l("Could not choose a good audio track based on language preferences or primary tracks.  An arbitrary language will be stored!"),e=d);var g=e.filter(function(b){return b.height&&480>=b.height});g.length&&
(g.sort(function(b,c){return c.height-b.height}),e=g.filter(function(b){return b.height==g[0].height}));d=[];if(e.length){var h=Math.floor(e.length/2);e.sort(function(b,c){return b.bandwidth-c.bandwidth});d.push(e[h])}e=r(b);for(h=e.next();!h.done;h=e.next())h=h.value,"text"==h.type&&d.push(h);return d};function mi(){this.a=null;this.b=[]}function ni(b,c){if(null==b.a)b.a={timestamp:Date.now()/1E3,state:c,duration:0};else{var d=Date.now()/1E3;b.a.duration=d-b.a.timestamp;b.a.state!=c&&(b.b.push(b.a),b.a={timestamp:d,state:c,duration:0})}}function oi(b,c){var d=0;b.a&&b.a.state==c&&(d+=b.a.duration);for(var e=r(b.b),f=e.next();!f.done;f=e.next())f=f.value,d+=f.state==c?f.duration:0;return d}
function pi(b){function c(b){return{timestamp:b.timestamp,state:b.state,duration:b.duration}}for(var d=[],e=r(b.b),f=e.next();!f.done;f=e.next())d.push(c(f.value));b.a&&d.push(c(b.a));return d};function qi(){this.b=this.c=null;this.a=[]};function ri(){this.b=this.v=this.i=this.f=this.m=this.o=this.u=this.h=this.C=NaN;this.c="unknown";this.a=new mi;this.g=new qi};function Y(b,c){var d=this;zb.call(this);this.i=si;this.a=null;this.ib=!1;this.g=new N;this.kc=this.m=this.fb=this.f=this.u=this.c=this.Ob=this.C=this.Lb=this.M=this.kb=this.o=this.K=this.h=this.Z=null;this.qd=1E9;this.Mb=new Set;this.mb=!0;this.na=null;this.od=!1;this.ld=0;this.ma=null;this.ka=new bg;this.b=ti(this);this.Nb={width:Infinity,height:Infinity};this.v=null;this.Bb=new kg(this.b.preferredAudioLanguage,this.b.preferredVariantRole,this.b.preferredAudioChannelCount);this.la=this.b.preferredTextLanguage;
this.gb=this.b.preferredTextRole;this.lc=[];c&&c(this);this.Z=ui(this);this.g.B(window,"online",function(){d.Wc()});this.O={name:"detach"};this.ba={name:"attach"};this.Ga={name:"unload"};this.sc={name:"manifest-parser"};this.pc={name:"manifest"};this.jb={name:"media-source"};this.jc={name:"drm-engine"};this.fa={name:"load"};this.tc={name:"src-equals-drm-engine"};this.lb={name:"src-equals"};var e=new Map;e.set(this.ba,function(b,c){return vb(vi(d,b,c))});e.set(this.O,function(b){b.s&&(d.g.ja(b.s,"error"),
b.s=null);d.a=null;b=Promise.resolve();return vb(b)});e.set(this.Ga,function(b){return vb(wi(d,b))});e.set(this.jb,function(b){b=xi(d,b);return vb(b)});e.set(this.sc,function(b,c){var e=yi(d,b,c);return vb(e)});e.set(this.pc,function(b){return zi(d,b)});e.set(this.jc,function(){var b=Ai(d);return vb(b)});e.set(this.fa,function(b,c){return vb(Bi(d,b,c))});e.set(this.tc,function(b){b=Ci(d,b);return vb(b)});e.set(this.lb,function(b,c){return Di(d,b,c)});this.Ra=new Yh(this.O,{te:function(b,c,e,k){var f=
null;b==d.O&&(f=e==d.O?d.O:d.ba);b==d.ba&&(f=e==d.O||c.s!=k.s?d.O:e==d.ba?d.ba:e==d.jb||e==d.fa?d.jb:e==d.lb?d.tc:null);b==d.jb&&(f=e==d.fa&&c.s==k.s?d.sc:d.Ga);b==d.sc&&(f=Ei(d.fa,d.pc,d.Ga,e,c,k));b==d.pc&&(f=Ei(d.fa,d.jc,d.Ga,e,c,k));b==d.jc&&(f=Ei(d.fa,d.fa,d.Ga,e,c,k));b==d.tc&&(f=e==d.lb&&c.s==k.s?d.lb:d.Ga);if(b==d.fa||b==d.lb)f=d.Ga;b==d.Ga&&(f=k.s&&c.s==k.s?d.ba:d.O);return f},ae:function(b,c,h){d.dispatchEvent(new I("onstatechange",{state:b.name}));return e.get(b)(c,h)},handleError:function(b,
c){return v(function k(){return y(k,function(e){switch(e.j){case 1:return A.l("The walker saw an error:"),c instanceof F?A.l("Error Code:",c.code):(A.l("Error Message:",c.message),A.l("Error Stack:",c.stack)),w(e,wi(d,b),2);case 2:return e["return"](b.s?d.ba:d.O)}})})},Ge:function(b){d.dispatchEvent(new I("onstateidle",{state:b.name}))}});b&&this.Cb(b,!0)}Oa(Y,zb);z("shaka.Player",Y);
Y.prototype.destroy=function(){var b=this;return v(function d(){var e;return y(d,function(d){switch(d.j){case 1:if(b.i==Fi)return d["return"]();b.i=Fi;e=bi(b.Ra,function(){return{node:b.O,payload:Zh(),Va:!1}});return w(d,new Promise(function(d){e.ub=function(){A.info("Preparing to destroy walker...")};e.bc=function(){d();b.dispatchEvent(new I("loaded"))};e.Za=function(){d()};e.onError=function(){d()};e.cc=function(){d()}}),2);case 2:return w(d,b.Ra.destroy(),3);case 3:b.g&&(b.g.release(),b.g=null);
b.kc=null;b.m=null;b.b=null;if(!b.Z){d.j=0;break}return w(d,b.Z.destroy(),5);case 5:b.Z=null,x(d)}})})};Y.prototype.destroy=Y.prototype.destroy;Y.version="2.5.17-yandex-patched-custom-build-prev-segment2-40-g169973fd-dirty";var Gi=["","5"];Zf=new function(b){this.a=b;this.c=$f;this.b=ag}(new Xf(Number(Gi[0]),Number(Gi[1])));var Hi=["output-restricted","internal-error"],Ii={};Y.registerSupportPlugin=function(b,c){Ii[b]=c};
Y.isBrowserSupported=function(){if(!(window.Promise&&window.Uint8Array&&Array.prototype.forEach))return!1;var b=nc();return b&&12>b||!(window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration)?!1:hc()?!0:ic("application/x-mpegurl")};
Y.probeSupport=function(){return Xc().then(function(b){for(var c=V.Ye(),d={},e=r('video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",")),f=
e.next();!f.done;f=e.next()){f=f.value;d[f]=hc()?Kd(f)?!0:MediaSource.isTypeSupported(f)||md(f):ic(f);var g=f.split(";")[0];d[g]=d[g]||d[f]}b={manifest:c,media:d,drm:b};for(var h in Ii)b[h]=Ii[h]();return b})};Y.prototype.Cb=function(b,c){c=void 0===c?!0:c;if(this.i==Fi)return Promise.reject(Ji());var d=Zh();d.s=b;hc()||(c=!1);var e=c?this.jb:this.ba,f=bi(this.Ra,function(){return{node:e,payload:d,Va:!1}});f.ub=function(){return A.info("Starting attach...")};return Ki(f)};Y.prototype.attach=Y.prototype.Cb;
Y.prototype.detach=function(){var b=this;if(this.i==Fi)return Promise.reject(Ji());var c=bi(this.Ra,function(){return{node:b.O,payload:Zh(),Va:!1}});c.ub=function(){return A.info("Starting detach...")};return Ki(c)};Y.prototype.detach=Y.prototype.detach;
Y.prototype.vf=function(b){var c=this;b=void 0===b?!0:b;if(this.i==Fi)return Promise.reject(Ji());hc()||(b=!1);var d=Zh(),e=bi(this.Ra,function(e){var f=e.s&&b?c.jb:e.s?c.ba:c.O;d.s=e.s;return{node:f,payload:d,Va:!1}});e.ub=function(){return A.info("Starting unload...")};return Ki(e)};Y.prototype.unload=Y.prototype.vf;
Y.prototype.load=function(b,c,d){if(this.i==Fi)return Promise.reject(Ji());this.dispatchEvent(new I("loading"));var e=Zh();e.uri=b;e.bd=Date.now()/1E3;d&&"string"!=typeof d&&(Yf("Loading with a manifest parser factory","Please register a manifest parser and for the mime-type."),e.ya=function(){return new d});d&&"string"==typeof d&&(e.mimeType=d);void 0!==c&&(e.startTime=c);var f=Li(this,e)?this.lb:this.fa,g=bi(this.Ra,function(b){if(null==b.s)return null;e.s=b.s;return{node:f,payload:e,Va:!0}});g.ub=
function(){return A.info("Starting load of "+b+"...")};return new Promise(function(b,c){g.cc=function(){return c(new F(2,7,7002))};g.bc=function(){return b()};g.Za=function(){return c(Ji())};g.onError=function(b){return c(b)}})};Y.prototype.load=Y.prototype.load;Y.prototype.Dc=function(b){return this.c?this.c.Dc(b):null};Y.prototype.getStreamForTime=Y.prototype.Dc;
function Li(b,c){if(c.ya)return!1;if(!hc())return!0;var d=c.mimeType,e=c.uri||"";d||(d={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav"}[V.getExtension(e)]);return d?""==(c.s||jc()).canPlayType(d)?!1:V.isSupported(e,d)?lc()&&b.b.streaming.useNativeHlsOnSafari:!0:!1}
function vi(b,c,d){null==c.s&&(c.s=d.s,b.g.B(c.s,"error",function(){var c=Mi(b);c&&b.Oa(c)}));b.a=c.s;return Promise.resolve()}
function wi(b,c){return v(function e(){var f;return y(e,function(e){switch(e.j){case 1:return b.i!=Fi&&(b.i=si),f=b.lc.map(function(b){return b()}),b.lc=[],w(e,Promise.all(f),2);case 2:b.dispatchEvent(new I("unloading"));c.ya=null;c.mimeType=null;c.startTime=null;c.uri=null;c.s&&(b.g.ja(c.s,"loadedmetadata"),b.g.ja(c.s,"playing"),b.g.ja(c.s,"pause"),b.g.ja(c.s,"ended"),b.g.ja(c.s,"ratechange"));b.kb&&(b.kb.release(),b.kb=null);b.Lb&&(b.Lb.stop(),b.Lb=null);if(!b.u){e.j=3;break}return w(e,b.u.stop(),
4);case 4:b.u=null;case 3:if(!b.m){e.j=5;break}return w(e,b.m.stop(),5);case 5:if(!b.c){e.j=7;break}return w(e,b.c.destroy(),8);case 8:b.c=null;case 7:b.M&&(b.M.release(),b.M=null);b.o&&(b.o.release(),b.o=null);if(!b.K){e.j=9;break}return w(e,b.K.destroy(),10);case 10:b.K=null;case 9:if(!c.s||!c.s.src){e.j=11;break}return w(e,new Promise(function(b){return(new D(b)).V(.1)}),12);case 12:c.s.removeAttribute("src"),c.s.load();case 11:if(!b.h){e.j=13;break}return w(e,b.h.destroy(),14);case 14:b.h=null;
case 13:b.ka.a.clear(),b.fb=null,b.C=null,b.Mb.clear(),b.f=null,b.v=null,b.mc=null,b.mb=!0,Ni(b),x(e)}})})}function xi(b,c){return v(function e(){var f,g,h,k;return y(e,function(e){switch(e.j){case 1:return f=window.muxjs?new bd:new cd,g=b.b.textDisplayFactory,h=new g,b.mc=g,k=new Od(c.s,f,h),w(e,k.u,2);case 2:b.K=k,x(e)}})})}
function yi(b,c,d){return v(function f(){var g,h,k,m;return y(f,function(f){switch(f.j){case 1:c.ya=d.ya;c.mimeType=d.mimeType;c.uri=d.uri;g=c.uri;h=b.Z;b.fb=g;if(c.ya){b.u=c.ya();f.j=2;break}k=b;return w(f,V.create(g,h,b.b.manifest.retryParameters,c.mimeType),3);case 3:k.u=f.N;case 2:m=Ab(b.b.manifest),d.s&&"AUDIO"===d.s.nodeName&&(m.disableVideo=!0),b.u.configure(m),x(f)}})})}
function zi(b,c){var d=c.uri,e=b.Z;b.Ob=new Yg(function(){return b.Kd()});Zg(b.Ob,function(c){Oi(b,"timelineregionadded",c)});var f={networkingEngine:e,filterNewPeriod:function(c){return b.vc(c)},filterAllPeriods:function(c){return Pi(b,c)},onTimelineRegionAdded:function(c){var d=b.Ob;a:{var e=r(d.a);for(var f=e.next();!f.done;f=e.next())if(f=f.value,f.schemeIdUri==c.schemeIdUri&&f.id==c.id&&f.startTime==c.startTime&&f.endTime==c.endTime){e=f;break a}e=null}null==e&&(d.a.add(c),d.b(c))},onEvent:function(c){return b.dispatchEvent(c)},
onError:function(c){return b.Oa(c)}};return new H(Promise.resolve().then(function(){return v(function h(){var c;return y(h,function(e){switch(e.j){case 1:return c=b,w(e,b.u.start(d,f),2);case 2:c.f=e.N;b.dispatchEvent(new I("manifestparsed"));if(0==b.f.periods.length)throw new F(2,4,4014);Qi(b.f.periods);x(e)}})})}),function(){A.info("Aborting parser step...");return b.u.stop()})}
function Ai(b){return v(function d(){return y(d,function(d){switch(d.j){case 1:return b.h=Ri(b,{Zb:b.Z,onError:function(d){b.Oa(d)},xd:function(d){Si(b,d)},onExpirationUpdated:function(d,e){Ti(b,d,e)},onEvent:function(d){b.dispatchEvent(d)}}),b.h.configure(b.b.drm),w(d,Ac(b.h,Cg(b.f.periods),b.f.offlineSessionIds),2);case 2:Pi(b,b.f.periods),x(d)}})})}
function Bi(b,c,d){return v(function f(){var g,h,k,m,n,p,q,t,u,E;return y(f,function(f){switch(f.j){case 1:return c.startTime=d.startTime,g=c.s,h=c.uri,b.fb=h,b.M=new Gg({Ub:function(){return c.s.playbackRate},$c:function(b){c.s.playbackRate=b},td:function(b){c.s.currentTime+=b}}),b.v=new ri,k=function(){return Ui(b)},m=function(){return Vi(b)},b.g.B(g,"playing",k),b.g.B(g,"pause",k),b.g.B(g,"ended",k),b.g.B(g,"ratechange",m),n=b.b.abrFactory,b.m&&b.kc==n||(b.kc=n,b.m=new n,b.m.configure(b.b.abr)),
Wi(b,b.f.periods),b.Bb=new kg(b.b.preferredAudioLanguage,b.b.preferredVariantRole,b.b.preferredAudioChannelCount),b.la=b.b.preferredTextLanguage,Xi(b.f.presentationTimeline,b.b.playRangeStart,b.b.playRangeEnd),w(f,b.h.Cb(g),2);case 2:return b.m.init(function(c,d,f){d=void 0===d?!1:d;f=void 0===f?0:f;A.debug("switch_");a:{var g=r(b.f.periods);for(var h=g.next();!h.done;h=g.next())if(h=h.value,h.variants.includes(c)){g=h;break a}g=null}Yi(b,g,c,!0);b.c&&th(b.c,c,d,f)&&Zi(b)}),b.o=$i(b,c.startTime),
b.kb=aj(b),p=Math.max(b.f.minBufferTime,b.b.streaming.rebufferingGoal),bj(b,p),b.c=cj(b),b.c.configure(b.b.streaming),ie(b.f,b.b.preferredAudioChannelCount),b.i=dj,b.dispatchEvent(new I("streaming")),w(f,b.c.start(),3);case 3:b.b.streaming.startAtSegmentBoundary&&(q=b.o.g(),t=ej(b,q),b.o.o(t)),b.f.periods.forEach(b.vc.bind(b)),fj(b),Zi(b),u=gj(b)||b.f.periods[0],E=u.variants.some(function(b){return b.primary}),b.b.preferredAudioLanguage||E||A.l("No preferred audio language set.  We will choose an arbitrary language initially"),
hj(b,u.variants),b.g.pa(g,"loadedmetadata",function(){b.v.f=Date.now()/1E3-d.bd}),x(f)}})})}
function Ci(b,c){return v(function e(){var f,g;return y(e,function(e){switch(e.j){case 1:return f=jd,b.h=Ri(b,{Zb:b.Z,onError:function(c){b.Oa(c)},xd:function(c){Si(b,c)},onExpirationUpdated:function(c,e){Ti(b,c,e)},onEvent:function(c){b.dispatchEvent(c)}}),b.h.configure(b.b.drm),g={id:0,language:"und",primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,
presentationTimeOffset:0,mimeType:"video/mp4",codecs:"",encrypted:!0,keyId:null,language:"und",label:null,type:f.gd,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},bandwidth:100,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0},w(e,Ac(b.h,[g],[]),2);case 2:return w(e,b.h.Cb(c.s),0)}})})}
function Di(b,c,d){function e(){return Ui(b)}c.uri=d.uri;c.startTime=d.startTime;b.fb=c.uri;b.v=new ri;b.o=new Rg(c.s);null!=c.startTime&&b.o.o(c.startTime);b.M=new Gg({Ub:function(){return c.s.playbackRate},$c:function(b){c.s.playbackRate=b},td:function(b){c.s.currentTime+=b}});bj(b,b.b.streaming.rebufferingGoal);b.g.B(c.s,"playing",e);b.g.B(c.s,"pause",e);b.g.B(c.s,"ended",e);b.g.B(c.s,"ratechange",function(){return Vi(b)});"none"!=b.a.preload&&b.g.pa(c.s,"loadedmetadata",function(){b.v.f=Date.now()/
1E3-d.bd});b.a.audioTracks&&(b.g.B(b.a.audioTracks,"addtrack",function(){return fj(b)}),b.g.B(b.a.audioTracks,"removetrack",function(){return fj(b)}),b.g.B(b.a.audioTracks,"change",function(){return fj(b)}));if(b.a.textTracks){var f=b.a.textTracks;b.g.B(f,"addtrack",function(){return fj(b)});b.g.B(f,"removetrack",function(){return fj(b)});b.g.B(f,"change",function(){return fj(b)})}c.s.src=c.uri;(mc("Tizen")||mc("Web0S"))&&c.s.load();b.i=ij;b.dispatchEvent(new I("streaming"));var g=new G;Ig(b.a,HTMLMediaElement.HAVE_METADATA,
b.g,function(){g.resolve()});var h=!1;b.lc.push(function(){h=!0});Ig(b.a,HTMLMediaElement.HAVE_CURRENT_DATA,b.g,function(){return v(function m(){var c;return y(m,function(d){switch(d.j){case 1:if(h)return d["return"]();jj(b);c=kj(b);if(c.find(function(b){return"disabled"!=b.mode})){d.j=2;break}return w(d,new Promise(function(c){b.g.pa(b.a.textTracks,"change",c);(new D(c)).V(1)}),2);case 2:if(h)return d["return"]();lj(b);x(d)}})})});b.a.error?g.reject(Mi(b)):"none"==b.a.preload&&(A.ra('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),
g.resolve());b.g.pa(b.a,"error",function(){g.reject(Mi(b))});return new H(g,function(){g.reject(new F(2,7,7001));return Promise.resolve()})}function jj(b){var c=b.b.preferredAudioLanguage;if(""!=c){b.Xc(c);var d=b.b.preferredVariantRole;""!=d&&b.Xc(c,d)}}function lj(b){var c=b.b.preferredTextLanguage;if(""!=c){b.Yc(c);var d=b.b.preferredTextRole;""!=d&&b.Yc(c,d)}}
function Qi(b){function c(b){return b.video&&b.audio||b.video&&b.video.codecs.includes(",")}b.some(function(b){return b.variants.some(c)})&&(A.debug("Found variant with audio and video content, so filtering out audio-only content in all periods."),b.forEach(function(b){b.variants=b.variants.filter(c)}))}function Ri(b,c){return new vc(c,b.b.drm.updateExpirationTime)}function ui(b){return new K(function(c,d){b.m&&b.m.segmentDownloaded(c,d);b.c&&Bh(b.c,c,d)})}
function $i(b,c){return new Sg(b.a,b.f,b.b.streaming,c,function(){b.kb&&Bg(b.kb,!0);b.c&&Ch(b.c);b.C&&mj(b)},function(c){return b.dispatchEvent(c)})}function aj(b){var c=new Eg(b.f);Fg(c,function(){fj(b)});var d=new $g(b.Ob);dh(d,function(c){Oi(b,"timelineregionenter",c)},function(c){Oi(b,"timelineregionexit",c)},function(c,d){d||(Oi(b,"timelineregionenter",c),Oi(b,"timelineregionexit",c))});var e=new Ag(b.a);e.a.add(c);e.a.add(d);return e}
function bj(b,c){b.C=new og;b.C.a=sg;tg(b.C,c,Math.min(.5,c/2));Ni(b);b.Lb=(new D(function(){mj(b)})).Ea(.25)}function mj(b){switch(b.i){case ij:var c=b.a.ended?!0:dd(b.a.buffered)>=b.a.duration-1;break;case dj:a:if(b.a.ended||Sd(b.K))c=!0;else{if(b.f.presentationTimeline.aa()){var d=b.f.presentationTimeline.qb();if(dd(b.a.buffered)>=d){c=!0;break a}}c=!1}break;default:c=!1}var e=fd(b.a.buffered,b.a.currentTime);d=b.C;var f=c,g=d.b.get(d.a);c=d.a;e=f||e>=g?pg:sg;d.a=e;c!=e&&Ni(b)}
function cj(b){return new eh(b.f,{Ua:function(){return b.o.g()},getBandwidthEstimate:function(){var c=b.m.getBandwidthEstimate();return c.value||c},J:b.K,Zb:b.Z,wd:b.Fe.bind(b),vd:b.Wd.bind(b),onError:b.Oa.bind(b),onEvent:function(c){return b.dispatchEvent(c)},Ie:b.Je.bind(b),Oc:b.Ne.bind(b)})}Y.prototype.configure=function(b,c){2==arguments.length&&"string"==typeof b&&(b=hi(b,c));var d=li(this.b,b,ti(this));nj(this);return d};Y.prototype.configure=Y.prototype.configure;
function nj(b){if(b.u){var c=Ab(b.b.manifest);b.a&&"AUDIO"===b.a.nodeName&&(c.disableVideo=!0);b.u.configure(c)}b.h&&b.h.configure(b.b.drm);if(b.c){b.c.configure(b.b.streaming);try{b.f.periods.forEach(b.vc.bind(b))}catch(g){b.Oa(g)}var d=jh(b.c),e=lh(b.c);c=gj(b);d=Be(d,e,c.variants);b.m&&d&&d.allowedByApplication&&d.allowedByKeySystem?hj(b,c.variants):(A.debug("Choosing new streams after changing configuration"),oj(b,c))}if(b.K&&(c=b.b.textDisplayFactory,b.mc!=c)){d=new c;e=b.K;var f=e.g;e.g=d;f&&
(d.setTextVisibility(f.isTextVisible()),f.destroy());e.a&&(e.a.c=d);b.mc=c;b.c&&(c=b.c,(d=c.b.get("text"))&&sh(c,d.stream,!0,0,!0))}b.m&&(b.m.configure(b.b.abr),b.b.abr.enabled&&!b.mb?b.m.enable():b.m.disable(),pj(b));b.C&&(c=b.b.streaming.rebufferingGoal,b.f&&(c=Math.max(c,b.f.minBufferTime)),tg(b.C,c,Math.min(.5,c/2)))}Y.prototype.getConfiguration=function(){var b=ti(this);li(b,this.b,ti(this));return b};Y.prototype.getConfiguration=Y.prototype.getConfiguration;
Y.prototype.ef=function(){for(var b in this.b)delete this.b[b];li(this.b,ti(this),ti(this));nj(this)};Y.prototype.resetConfiguration=Y.prototype.ef;Y.prototype.le=function(){return this.i};Y.prototype.getLoadMode=Y.prototype.le;Y.prototype.qe=function(){return this.a};Y.prototype.getMediaElement=Y.prototype.qe;Y.prototype.se=function(){return this.Z};Y.prototype.getNetworkingEngine=Y.prototype.se;Y.prototype.ee=function(){return this.fb};Y.prototype.getAssetUri=Y.prototype.ee;
Y.prototype.oe=function(){Yf("getManifestUri",'Please use "getAssetUri" instead.');return this.fb};Y.prototype.getManifestUri=Y.prototype.oe;Y.prototype.aa=function(){return this.f?this.f.presentationTimeline.aa():this.a&&this.a.src?Infinity==this.a.duration:!1};Y.prototype.isLive=Y.prototype.aa;Y.prototype.tb=function(){return this.f?this.f.presentationTimeline.tb():!1};Y.prototype.isInProgress=Y.prototype.tb;
Y.prototype.Be=function(){if(this.f){if(!this.f.periods.length)return!1;var b=this.f.periods[0].variants;return b.length?!b[0].video:!1}return this.a&&this.a.src?this.a.videoTracks?0==this.a.videoTracks.length:0==this.a.videoHeight:!1};Y.prototype.isAudioOnly=Y.prototype.Be;Y.prototype.Kd=function(){if(this.f){var b=this.f.presentationTimeline;return{start:b.pb(),end:b.za()}}return this.a&&this.a.src&&(b=this.a.seekable,b.length)?{start:b.start(0),end:b.end(b.length-1)}:{start:0,end:0}};
Y.prototype.seekRange=Y.prototype.Kd;Y.prototype.keySystem=function(){return Nc(this.drmInfo())};Y.prototype.keySystem=Y.prototype.keySystem;Y.prototype.drmInfo=function(){return this.h?this.h.a:null};Y.prototype.drmInfo=Y.prototype.drmInfo;Y.prototype.Ac=function(){return this.h?this.h.Ac():Infinity};Y.prototype.getExpiration=Y.prototype.Ac;Y.prototype.sd=function(){return this.C?this.C.a==sg:!1};Y.prototype.isBuffering=Y.prototype.sd;
Y.prototype.ue=function(){if(this.M){var b=this.M;b=b.f?0:b.c}else b=0;return b};Y.prototype.getPlaybackRate=Y.prototype.ue;Y.prototype.uf=function(b){0==b?A.ra("A trick play rate of 0 is unsupported!"):(this.a.paused&&this.a.play(),this.M&&this.M.set(b),this.i==dj&&rh(this.c,1<Math.abs(b)))};Y.prototype.trickPlay=Y.prototype.uf;Y.prototype.Xd=function(){this.i==ij&&this.M.set(1);this.i==dj&&(this.M.set(1),rh(this.c,!1))};Y.prototype.cancelTrickPlay=Y.prototype.Xd;
Y.prototype.Ec=function(){if(this.f&&this.o){for(var b=qj(this),c=[],d=r(rj(this)),e=d.next();!e.done;e=d.next()){e=e.value;var f=se(e);f.active=e==b;c.push(f)}return c}return this.a&&this.a.audioTracks?Array.from(this.a.audioTracks).map(function(b){return we(b)}):[]};Y.prototype.getVariantTracks=Y.prototype.Ec;
Y.prototype.rb=function(){if(this.f&&this.o){for(var b=sj(this),c=[],d=r(tj(this)),e=d.next();!e.done;e=d.next()){e=e.value;var f=te(e);f.active=e==b;c.push(f)}return c}return this.a&&this.a.src&&this.a.textTracks?kj(this).map(function(b){var c=xe(b);c.active="disabled"!=b.mode;c.type="text";c.originalTextId=b.id;"captions"==b.kind&&(c.mimeType="application/cea-608");b.kind&&(c.roles=[b.kind]);return c}):[]};Y.prototype.getTextTracks=Y.prototype.rb;
Y.prototype.Zc=function(b){if(this.f&&this.c){var c=gj(this),d=c.textStreams.find(function(c){return c.id==b.id});d?(uj(this,c,d,!1),vj(this,d),this.la=d.language):A.error("No stream with id",b.id)}else if(this.a&&this.a.src&&this.a.textTracks){c=kj(this);c=r(c);for(d=c.next();!d.done;d=c.next())d=d.value,ue(d)==b.id?d.mode=this.ib?"showing":"hidden":d.mode="disabled";wj(this)}};Y.prototype.selectTextTrack=Y.prototype.Zc;
Y.prototype.hf=function(){Yf("selectEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. Please use SelectTextTrack.");var b=this.rb().filter(function(b){return"application/cea-608"==b.mimeType});0<b.length?this.Zc(b[0]):A.l("Unable to find the text track embedded in the video.")};Y.prototype.selectEmbeddedTextTrack=Y.prototype.hf;
Y.prototype.Bf=function(){Yf("usingEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. There should be no reason to know if the player is playing embedded text.");var b=this.rb().filter(function(b){return b.active})[0];return b?"application/cea-608"==b.mimeType:!1};Y.prototype.usingEmbeddedTextTrack=Y.prototype.Bf;
Y.prototype.jf=function(b,c,d){d=void 0===d?0:d;if(this.f&&this.c){var e=gj(this);this.b.abr.enabled&&A.ra("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var f=e.variants.find(function(c){return c.id==b.id});f?ye(f)?(Yi(this,e,f,!1),xj(this,f,c,d),this.Bb=new jg(f),hj(this,e.variants)):A.error("Unable to switch to restricted track",b.id):A.error("No variant with id",b.id)}else if(this.a&&
this.a.audioTracks){c=Array.from(this.a.audioTracks);c=r(c);for(d=c.next();!d.done;d=c.next())d=d.value,ue(d)==b.id&&(d.enabled=!0);yj(this)}};Y.prototype.selectVariantTrack=Y.prototype.jf;Y.prototype.ge=function(){return zj(this.Ec())};Y.prototype.getAudioLanguagesAndRoles=Y.prototype.ge;Y.prototype.ze=function(){return zj(this.rb())};Y.prototype.getTextLanguagesAndRoles=Y.prototype.ze;Y.prototype.fe=function(){return Array.from(Aj(this.Ec()))};Y.prototype.getAudioLanguages=Y.prototype.fe;
Y.prototype.ye=function(){return Array.from(Aj(this.rb()))};Y.prototype.getTextLanguages=Y.prototype.ye;Y.prototype.Xc=function(b,c){if(this.f&&this.o){var d=gj(this);this.Bb=new kg(b,c||"",0,"","audio");Bj(this,d)}else if(this.a&&this.a.audioTracks){var e=Array.from(this.a.audioTracks);d=P(b);e=r(e);for(var f=e.next();!f.done;f=e.next()){f=f.value;var g=we(f);P(g.language)!=d||c&&!g.roles.includes(c)||(f.enabled=!0)}yj(this)}};Y.prototype.selectAudioLanguage=Y.prototype.Xc;
Y.prototype.Yc=function(b,c){if(this.f&&this.o){var d=gj(this);this.la=b;this.gb=c||"";var e=ze(d.textStreams,this.la,this.gb)[0]||null;e&&(uj(this,d,e,!1),(this.b.streaming.alwaysStreamText||this.Xb())&&vj(this,e))}else{var f=P(b);(d=this.rb().filter(function(b){return P(b.language)==f&&(!c||b.roles.includes(c))})[0])&&this.Zc(d)}};Y.prototype.selectTextLanguage=Y.prototype.Yc;
Y.prototype.kf=function(b){if(this.f&&this.o){for(var c=gj(this),d=null,e=r(rj(this)),f=e.next();!f.done;f=e.next())if(f=f.value,f.audio.label==b){d=f;break}null==d?A.l("No variants were found with label: "+b+". Ignoring the request to switch."):(this.Bb=new kg(d.language,"",0,b),Bj(this,c))}};Y.prototype.selectVariantsByLabel=Y.prototype.kf;
Y.prototype.Xb=function(){var b=this.ib;return this.K?this.K.g.isTextVisible():this.a&&this.a.src&&this.a.textTracks?kj(this).some(function(b){return"showing"==b.mode}):b};Y.prototype.isTextTrackVisible=Y.prototype.Xb;function kj(b){return Array.from(b.a.textTracks).filter(function(b){return"metadata"!=b.kind&&"Shaka Player TextTrack"!=b.label})}
Y.prototype.pf=function(b){var c=this;return v(function e(){var f,g,h,k,m,n;return y(e,function(e){switch(e.j){case 1:f=c.ib;g=!!b;if(f==g)return e["return"]();c.ib=g;if(c.i!=dj){if(c.a&&c.a.src&&c.a.textTracks){h=kj(c);for(var p=r(h),t=p.next();!t.done;t=p.next())k=t.value,"disabled"!=k.mode&&(k.mode=g?"showing":"hidden")}e.j=2;break}c.K.g.setTextVisibility(g);if(c.b.streaming.alwaysStreamText){e.j=2;break}if(!g){qh(c.c);e.j=2;break}if(kh(c.c,"text")){e.j=2;break}m=gj(c);n=ze(m.textStreams,c.la,
c.gb);if(!(0<n.length)){e.j=2;break}return w(e,mh(c.c,n[0]),2);case 2:Cj(c),x(e)}})})};Y.prototype.setTextTrackVisibility=Y.prototype.pf;
Y.prototype.ve=function(){if(!this.aa())return A.l("getPlayheadTimeAsDate is for live streams!"),null;var b=this.Ra.f,c=0;if(this.o)c=this.o.g();else if(b){if(null==b.startTime)return new Date;c=b.startTime}if(this.f)return new Date(1E3*(this.f.presentationTimeline.b+this.a.currentTime));if(this.a&&this.a.getStartDate)return b=this.a.getStartDate(),isNaN(b.getTime())?(A.l("EXT-X-PROGRAM-DATETIME required to get playhead time as Date!"),null):new Date(b.getTime()+1E3*c);A.l("No way to get playhead time as Date!");
return null};Y.prototype.getPlayheadTimeAsDate=Y.prototype.ve;Y.prototype.xe=function(){if(!this.aa())return A.l("getPresentationStartTimeAsDate is for live streams!"),null;if(this.f)return new Date(1E3*this.f.presentationTimeline.b);if(this.a&&this.a.getStartDate){var b=this.a.getStartDate();return isNaN(b.getTime())?(A.l("EXT-X-PROGRAM-DATETIME required to get presentation start time as Date!"),null):b}A.l("No way to get presentation start time as Date!");return null};
Y.prototype.getPresentationStartTimeAsDate=Y.prototype.xe;Y.prototype.yc=function(){var b={total:[],audio:[],video:[],text:[]};this.i==ij&&(b.total=gd(this.a.buffered));this.i==dj&&this.K.yc(b);return b};Y.prototype.getBufferedInfo=Y.prototype.yc;
Y.prototype.getStats=function(){if(this.i!=dj&&this.i!=ij)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,estimatedBandwidth:NaN,estimatedBandwidthSource:"unknown",loadLatency:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,switchHistory:[],stateHistory:[]};Ui(this);var b=this.a;if(b.getVideoPlaybackQuality){b=b.getVideoPlaybackQuality();var c=this.v,d=Number(b.totalVideoFrames);c.u=Number(b.droppedVideoFrames);c.o=d;this.v.m=
Number(b.corruptedVideoFrames)}this.h?(b=this.h,b=b.M?b.M:NaN):b=NaN;this.v.i=b;if(this.i==dj){if(b=qj(this))this.v.v=b.bandwidth;b&&b.video&&(c=this.v,d=b.video.height||NaN,c.C=b.video.width||NaN,c.h=d);b=this.m.getBandwidthEstimate();b.value?(c=this.v,d=b.source,c.b=b.value,c.c=d):(c=this.v,c.b=b,c.c="unknown")}var e=this.v;b=e.C;c=e.h;d=e.v;var f=e.o,g=e.u,h=e.m,k=e.b,m=e.c,n=e.f,p=oi(e.a,"playing"),q=oi(e.a,"paused"),t=oi(e.a,"buffering"),u=e.i,E=pi(e.a),B=[];e=r(e.g.a);for(var C=e.next();!C.done;C=
e.next())C=C.value,B.push({timestamp:C.timestamp,id:C.id,type:C.type,fromAdaptation:C.fromAdaptation,bandwidth:C.bandwidth});return{width:b,height:c,streamBandwidth:d,decodedFrames:f,droppedFrames:g,corruptedFrames:h,estimatedBandwidth:k,estimatedBandwidthSource:m,loadLatency:n,playTime:p,pauseTime:q,bufferingTime:t,licenseTime:u,stateHistory:E,switchHistory:B}};Y.prototype.getStats=Y.prototype.getStats;
Y.prototype.addTextTrack=function(b,c,d,e,f,g){var h=this;return v(function m(){var n,p,q,t,u,E,B,C,J;return y(m,function(m){switch(m.j){case 1:if(h.i==ij)throw A.error("Cannot add text when loaded with src="),Error("State error!");if(h.i!=dj)throw A.error("Must call load() and wait for it to resolve before adding text tracks."),Error("State error!");n=gj(h);p=jd;q=h.f.periods.indexOf(n);t=q+1;u=t>=h.f.periods.length?h.f.presentationTimeline.da():h.f.periods[t].startTime;E=u-n.startTime;if(Infinity==
E)throw new F(1,4,4033);B=new T(1,0,E,function(){return[b]},0,null);C={id:h.qd++,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return 1},getSegmentReference:function(b){return 1==b?B:null},initSegmentReference:null,presentationTimeOffset:0,mimeType:e,codecs:f||"",kind:d,encrypted:!1,keyId:null,language:c,label:g||null,type:p.xa,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,
audioSamplingRate:null,closedCaptions:null};h.Mb.add(C);n.textStreams.push(C);return w(m,mh(h.c,C),2);case 2:return(J=kh(h.c,"text"))&&cg(h.ka,n,J),h.Mb["delete"](C),A.debug("Choosing new streams after adding a text stream"),oj(h,n),fj(h),m["return"](te(C))}})})};Y.prototype.addTextTrack=Y.prototype.addTextTrack;Y.prototype.nf=function(b,c){this.Nb.width=b;this.Nb.height=c};Y.prototype.setMaxHardwareResolution=Y.prototype.nf;
Y.prototype.Wc=function(){if(this.i==dj){var b=this.c;if(b.f)A.error("Unable to retry after StreamingEngine is destroyed!"),b=!1;else if(b.u)A.error("Unable to retry after StreamingEngine encountered a fatal error!"),b=!1;else{for(var c=r(b.b.values()),d=c.next();!d.done;d=c.next()){d=d.value;var e=wh(d);d.Fb&&(A.info(e,"Retrying after failure..."),d.Fb=!1,ph(b,d,.1))}b=!0}}else b=!1;return b};Y.prototype.retryStreaming=Y.prototype.Wc;Y.prototype.me=function(){return this.f};
Y.prototype.getManifest=Y.prototype.me;Y.prototype.ne=function(){return this.u?this.u.constructor:null};Y.prototype.getManifestParserFactory=Y.prototype.ne;function Yi(b,c,d,e){dg(b.ka,c).variant=d;b=b.v.g;b.c!=d&&(b.c=d,b.a.push({timestamp:Date.now()/1E3,id:d.id,type:"variant",fromAdaptation:e,bandwidth:d.bandwidth}))}function uj(b,c,d,e){cg(b.ka,c,d);b=b.v.g;b.b!=d&&(b.b=d,b.a.push({timestamp:Date.now()/1E3,id:d.id,type:"text",fromAdaptation:e,bandwidth:null}))}
function ti(b){var c=ji();c.streaming.failureCallback=function(c){var d=[1001,1002,1003];b.aa()&&d.includes(c.code)&&(c.severity=1,A.l("Live streaming error.  Retrying automatically..."),b.Wc())};c.textDisplayFactory=function(){return new di(b.a)};return c}
function Wi(b,c){for(var d=0;d<c.length;d++){for(var e=c[d],f=new Map,g=r(e.variants),h=g.next();!h.done;h=g.next())if(h=h.value,h.video&&h.video.closedCaptions){h=h.video;for(var k=r(h.closedCaptions.keys()),m=k.next();!m.done;m=k.next())if(m=m.value,!f.has(m)){var n={id:b.qd++,originalId:m,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"application/cea-608",
codecs:"",kind:"caption",encrypted:!1,keyId:null,language:h.closedCaptions.get(m),label:null,type:"text",primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:h.roles,channelsCount:null,audioSamplingRate:null,closedCaptions:null};f.set(m,n)}}f=r(f.values());for(g=f.next();!g.done;g=f.next())e.textStreams.push(g.value)}}
function Pi(b,c){var d=b.c?jh(b.c):null,e=b.c?lh(b.c):null;c.forEach(pe.bind(null,b.h,d,e));d=Cb(c,function(b){return b.variants.some(ye)});if(0==d)throw new F(2,4,4032);if(d<c.length)throw new F(2,4,4011);c.forEach(function(b){oe(b.variants,this.b.restrictions,this.Nb)&&this.c&&gj(this)==b&&fj(this);Dj(this,b.variants)}.bind(b))}l=Y.prototype;
l.vc=function(b){var c=this.c?jh(this.c):null,d=this.c?lh(this.c):null;pe(this.h,c,d,b);c=b.variants;if(!c.some(ye))throw new F(2,4,4011);Dj(this,b.variants);oe(c,this.b.restrictions,this.Nb)&&this.c&&gj(this)==b&&fj(this);if(b=this.h?this.h.a:null)for(c=r(c),d=c.next();!d.done;d=c.next()){d=r(d.value.drmInfos);for(var e=d.next();!e.done;e=d.next())if(e=e.value,e.keySystem==b.keySystem){e=r(e.initData||[]);for(var f=e.next();!f.done;f=e.next())f=f.value,Kc(this.h,f.initDataType,f.initData)}}};
function xj(b,c,d,e){d=void 0===d?!1:d;e=void 0===e?0:e;if(b.mb)return b.na=c,b.od=d,b.ld=e,!0;(c=th(b.c,c,d,e))&&yj(b);return c}function vj(b,c){if(b.mb)return b.ma=c,!0;var d=sh(b.c,c,!0,0,!1);d&&wj(b);return d}function ej(b,c){function d(b,c){if(!b)return null;var d=b.findSegmentPosition(c-g.startTime);return null==d?null:(d=b.getSegmentReference(d))?d.startTime+g.startTime:null}var e=jh(b.c),f=lh(b.c),g=gj(b);e=d(e,c);f=d(f,c);return null!=f&&null!=e?Math.max(f,e):null!=f?f:null!=e?e:c}
function Ni(b){var c=b.sd();if(b.v&&b.C&&b.o){var d=b.M;d.f=c;Hg(d);Ui(b)}b.dispatchEvent(new I("buffering",{buffering:c}))}function Vi(b){var c=b.a.playbackRate;0!=c&&b.M.set(c)}function Ui(b){if(b.v&&b.C){var c=b.v.a;b.C.a==sg?ni(c,"buffering"):b.a.paused?ni(c,"paused"):b.a.ended?ni(c,"ended"):ni(c,"playing")}}function hj(b,c){try{Dj(b,c)}catch(e){return b.Oa(e),null}var d=c.filter(function(b){return ye(b)});d=b.Bb.create(d);b.m.setVariants(Array.from(d.values()));return b.m.chooseVariant()}
function oj(b,c){var d=Bj(b,c,!1),e=ze(c.textStreams,b.la,b.gb)[0]||null,f=!1;e&&(b.b.streaming.alwaysStreamText||b.Xb())&&(uj(b,c,e,!0),f=vj(b,e));(d||f)&&Zi(b)}function Bj(b,c,d){d=void 0===d?!0:d;var e=hj(b,c.variants),f=!1;e&&(Yi(b,c,e,!0),f=xj(b,e,!0));d&&f&&Zi(b);return f}
l.Fe=function(b){A.debug("onChooseStreams_",b);try{A.I("onChooseStreams_, choosing variant from ",b.variants);A.I("onChooseStreams_, choosing text from ",b.textStreams);this.mb=!0;this.m.disable();pj(this);A.debug("Choosing new streams after period changed");var c=hj(this,b.variants),d=ze(b.textStreams,this.la,this.gb)[0]||null;this.na&&(b.variants.includes(this.na)&&(c=this.na),this.na=null);this.ma&&(b.textStreams.includes(this.ma)&&(d=this.ma),this.ma=null);c&&Yi(this,b,c,!0);d&&uj(this,b,d,!0);
var e=this.c,f=e.b.get("video");if(f)var g=e.c.periods[f.ha];else{var h=e.b.get("audio");g=h?e.c.periods[h.ha]:null}var k=c?c.audio:null;if(!g&&d){var m;if(m=k){b=d;var n=P(this.b.preferredTextLanguage),p=P(k.language),q=P(b.language);m=de(q,n)&&!de(p,q)}m&&(this.ib=!0);this.ib&&this.K.g.setTextVisibility(!0);Cj(this)}var t=this.b.streaming.alwaysStreamText||this.Xb()?{variant:c,text:d}:{variant:c,text:null};A.I("onChooseStreams_, chose variant ",t.variant);A.I("onChooseStreams_, chose text ",t.text);
return t}catch(u){return this.Oa(u),{variant:null,text:null}}};l.Wd=function(){A.debug("canSwitch_");this.mb=!1;this.b.abr.enabled&&(this.m.enable(),pj(this));this.na&&(th(this.c,this.na,this.od,this.ld),yj(this),this.na=null);this.ma&&(sh(this.c,this.ma,!0,0,!1),wj(this),this.ma=null)};l.Je=function(){this.u&&this.u.update&&this.u.update()};l.Ne=function(){this.o&&this.o.u()};function Zi(b){Ej(b,new I("adaptation"))}function fj(b){Ej(b,new I("trackschanged"))}
function yj(b){Ej(b,new I("variantchanged"))}function wj(b){Ej(b,new I("textchanged"))}function Cj(b){Ej(b,new I("texttrackvisibility"))}function pj(b){Ej(b,new I("abrstatuschanged",{If:b.b.abr.enabled}))}l.Oa=function(b){if(this.i!=Fi){var c=new I("error",{detail:b});this.dispatchEvent(c);c.defaultPrevented&&(b.handled=!0)}};function Oi(b,c,d){b.dispatchEvent(new I(c,{detail:{schemeIdUri:d.schemeIdUri,value:d.value,startTime:d.startTime,endTime:d.endTime,id:d.id,eventElement:d.eventElement}}))}
function Mi(b){if(!b.a.error)return null;var c=b.a.error.code;if(1==c)return null;var d=b.a.error.msExtendedCode;d&&(0>d&&(d+=Math.pow(2,32)),d=d.toString(16));return new F(2,3,3016,c,d,b.a.error.message)}
function Si(b,c){if(b.c){var d=gj(b),e=!1,f=Object.keys(c);0==f.length&&A.l("Got a key status event without any key statuses, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");var g=1==f.length&&"00"==f[0];g&&A.l("Got a synthetic key status event, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");f.length&&b.f.periods.forEach(function(b){b.variants.forEach(function(b){Ce(b).forEach(function(d){var f=
b.allowedByKeySystem;d.keyId&&(d=c[g?"00":d.keyId],b.allowedByKeySystem=!!d&&!Hi.includes(d));f!=b.allowedByKeySystem&&(e=!0)})})});f=jh(b.c);var h=lh(b.c);(f=Be(f,h,d.variants))&&!f.allowedByKeySystem&&(A.debug("Choosing new variants after key status changed"),Bj(b,d));e&&(fj(b),hj(b,d.variants))}}function Ti(b,c,d){if(b.u&&b.u.onExpirationUpdated)b.u.onExpirationUpdated(c,d);b.dispatchEvent(new I("expirationupdated"))}
function Xi(b,c,d){0<c&&(b.aa()?A.l("|playRangeStart| has been configured for live content. Ignoring the setting."):b.Pd(c));d<b.da()&&(b.aa()?A.l("|playRangeEnd| has been configured for live content. Ignoring the setting."):b.$a(d))}
function Dj(b,c){var d=b.h?cc(b.h.fa):{},e=Object.keys(d);e=e.length&&"00"==e[0];for(var f=!1,g=!1,h=[],k=[],m=r(c),n=m.next();!n.done;n=m.next()){n=n.value;var p=[];n.audio&&p.push(n.audio);n.video&&p.push(n.video);p=r(p);for(var q=p.next();!q.done;q=p.next())if(q=q.value,q.keyId){var t=d[e?"00":q.keyId];t?Hi.includes(t)&&(k.includes(t)||k.push(t)):h.includes(q.keyId)||h.push(q.keyId)}n.allowedByApplication?n.allowedByKeySystem&&(f=!0):g=!0}if(!f)throw new F(2,4,4012,{hasAppRestrictions:g,missingKeys:h,
restrictedKeyStatuses:k});}function Ej(b,c){v(function e(){return y(e,function(e){switch(e.j){case 1:return w(e,Promise.resolve(),2);case 2:b.i!=Fi&&b.dispatchEvent(c),x(e)}})})}function Aj(b){var c=new Set;b=r(b);for(var d=b.next();!d.done;d=b.next())d=d.value,d.language?c.add(P(d.language)):c.add("und");return c}
function zj(b){var c=new Map;b=r(b);for(var d=b.next();!d.done;d=b.next()){var e=d.value;d="und";var f=[];e.language&&(d=P(e.language));"variant"==e.type?f=e.audioRoles:f=e.roles;f&&f.length||(f=[""]);c.has(d)||c.set(d,new Set);e=r(f);for(f=e.next();!f.done;f=e.next())f=f.value,c.get(d).add(f)}var g=[];c.forEach(function(b,c){for(var d=r(b),e=d.next();!e.done;e=d.next())g.push({language:c,role:e.value})});return g}
function rj(b){b=gj(b);return null==b?[]:b.variants.filter(function(b){return ye(b)})}function tj(b){var c=gj(b);return null==c?[]:c.textStreams.filter(function(c){return!b.Mb.has(c)})}function gj(b){var c=b.o.g(),d=null;b=r(b.f.periods);for(var e=b.next();!e.done;e=b.next())e=e.value,e.startTime<=c&&(d=e);return d}function qj(b){var c=gj(b);return dg(b.ka,c).variant}
function sj(b){var c=gj(b);if(null==c)return null;if(!dg(b.ka,c).text){var d=ze(c.textStreams,b.la,b.gb);d.length&&cg(b.ka,c,d[0])}return dg(b.ka,c).text}function Ji(){return new F(2,7,7E3)}function Ei(b,c,d,e,f,g){return e==b&&f.s==g.s&&f.uri==g.uri&&f.mimeType==g.mimeType&&f.ya==g.ya?c:d}function Zh(){return{ya:null,s:null,mimeType:null,startTime:null,bd:null,uri:null}}
function Ki(b){return new Promise(function(c,d){b.Za=function(){return d(Ji())};b.bc=function(){return c()};b.onError=function(b){return d(b)};b.cc=function(){return d(Ji())}})}var Fi=0,si=1,dj=2,ij=3;Y.LoadMode={DESTROYED:Fi,NOT_LOADED:si,MEDIA_SOURCE:dj,SRC_EQUALS:ij};z("shaka.polyfill.installAll",function(){for(var b=0;b<Fj.length;++b)try{Fj[b].Vd()}catch(c){A.ra("Error installing polyfill!",c)}});var Fj=[];function Gj(b,c){c=c||0;for(var d={priority:c,Vd:b},e=0;e<Fj.length;e++)if(Fj[e].priority<c){Fj.splice(e,0,d);return}Fj.push(d)}z("shaka.polyfill.register",Gj);Gj(function(){Hj()},-1);function Ij(b,c,d){if("input"==b)switch(this.type){case "range":b="change"}HTMLInputElement.prototype.originalAddEventListener.call(this,b,c,d)}Gj(function(){A.debug("InputEvent.install");mc("Trident/")&&!HTMLInputElement.prototype.originalAddEventListener&&(A.info("Patching input event support on IE."),HTMLInputElement.prototype.originalAddEventListener=HTMLInputElement.prototype.addEventListener,HTMLInputElement.prototype.addEventListener=Ij)});Gj(function(){navigator.languages||Object.defineProperty(navigator,"languages",{get:function(){return navigator.language?[navigator.language]:["en"]}})});Gj(function(){A.debug("mathRound.install")});function Jj(){var b=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(c){for(var d=[],e=0;e<arguments.length;++e)d[e]=arguments[e];d=b.apply(this,d);d.abort=function(){};return d}}function Kj(){var b=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(c,d){return b.call(this,c,d-.001)}}function Mj(){var b=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(c){return"mp2t"==c.split(/ *; */)[0].split("/")[1].toLowerCase()?!1:b(c)}}
function Nj(){var b=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(c){return"opus"!=gc(c)[0]&&b(c)}}function Oj(){var b=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(c){var d=c.split(/ *; */);d.shift();return d.some(function(b){return b.startsWith("codecs=")})?cast.__platform__.canDisplayType(c):b(c)}}
Gj(function(){A.debug("MediaSource.install");var b=nc();window.MediaSource?window.cast&&cast.__platform__&&cast.__platform__.canDisplayType?(A.info("Patching Chromecast MSE bugs."),Oj()):b?(Mj(),12>=b?(A.info("Patching Safari 11 & 12 MSE bugs."),Jj(),Kj()):(A.info("Patching Safari 13 MSE bugs."),Jj())):mc("Tizen 2")||mc("Tizen 3")||mc("Tizen 4")?Nj():A.info("Using native MSE as-is."):A.info("No MSE implementation available.")});function Pj(b,c){A.debug("PatchedMediaKeysMs.requestMediaKeySystemAccess");try{var d=new Qj(b,c);return Promise.resolve(d)}catch(e){return Promise.reject(e)}}
function Qj(b,c){A.debug("PatchedMediaKeysMs.MediaKeySystemAccess");this.keySystem=b;for(var d=!1,e=0;e<c.length;++e){var f=c[e],g={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:f.initDataTypes,sessionTypes:["temporary"],label:f.label},h=!1;if(f.audioCapabilities)for(var k=0;k<f.audioCapabilities.length;++k){var m=f.audioCapabilities[k];if(m.contentType){h=!0;var n=m.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,
n)&&(g.audioCapabilities.push(m),d=!0)}}if(f.videoCapabilities)for(k=0;k<f.videoCapabilities.length;++k)m=f.videoCapabilities[k],m.contentType&&(h=!0,n=m.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,n)&&(g.videoCapabilities.push(m),d=!0));h||(d=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4"));"required"==f.persistentState&&(d=!1);if(d){this.a=g;return}}d=Error("Unsupported keySystem");d.name="NotSupportedError";d.code=DOMException.NOT_SUPPORTED_ERR;throw d;}
Qj.prototype.createMediaKeys=function(){A.debug("PatchedMediaKeysMs.MediaKeySystemAccess.createMediaKeys");var b=new Rj(this.keySystem);return Promise.resolve(b)};Qj.prototype.getConfiguration=function(){A.debug("PatchedMediaKeysMs.MediaKeySystemAccess.getConfiguration");return this.a};function Sj(b){A.debug("PatchedMediaKeysMs.setMediaKeys");var c=this.mediaKeys;c&&c!=b&&Tj(c,null);delete this.mediaKeys;return(this.mediaKeys=b)?Tj(b,this):Promise.resolve()}
function Rj(b){A.debug("PatchedMediaKeysMs.MediaKeys");this.b=new MSMediaKeys(b);this.a=new N}Rj.prototype.createSession=function(b){A.debug("PatchedMediaKeysMs.MediaKeys.createSession");b=b||"temporary";if("temporary"!=b)throw new TypeError("Session type "+b+" is unsupported on this platform.");return new Uj(this.b,b)};Rj.prototype.setServerCertificate=function(){A.debug("PatchedMediaKeysMs.MediaKeys.setServerCertificate");return Promise.resolve(!1)};
function Tj(b,c){b.a.Ib();if(!c)return Promise.resolve();b.a.B(c,"msneedkey",Vj);try{return Ig(c,HTMLMediaElement.HAVE_METADATA,b.a,function(){c.msSetMediaKeys(b.b)}),Promise.resolve()}catch(d){return Promise.reject(d)}}function Uj(b){A.debug("PatchedMediaKeysMs.MediaKeySession");zb.call(this);this.c=null;this.g=b;this.b=this.a=null;this.f=new N;this.sessionId="";this.expiration=NaN;this.closed=new G;this.keyStatuses=new Wj}Oa(Uj,zb);l=Uj.prototype;
l.generateRequest=function(b,c){A.debug("PatchedMediaKeysMs.MediaKeySession.generateRequest");this.a=new G;try{this.c=this.g.createSession("video/mp4",new Uint8Array(c),null),this.f.B(this.c,"mskeymessage",this.Me.bind(this)),this.f.B(this.c,"mskeyadded",this.Ke.bind(this)),this.f.B(this.c,"mskeyerror",this.Le.bind(this)),Xj(this,"status-pending")}catch(d){this.a.reject(d)}return this.a};l.load=function(){A.debug("PatchedMediaKeysMs.MediaKeySession.load");return Promise.reject(Error("MediaKeySession.load not yet supported"))};
l.update=function(b){A.debug("PatchedMediaKeysMs.MediaKeySession.update");this.b=new G;try{this.c.update(new Uint8Array(b))}catch(c){this.b.reject(c)}return this.b};l.close=function(){A.debug("PatchedMediaKeysMs.MediaKeySession.close");try{this.c.close(),this.closed.resolve(),this.f.Ib()}catch(b){this.closed.reject(b)}return this.closed};l.remove=function(){A.debug("PatchedMediaKeysMs.MediaKeySession.remove");return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))};
function Vj(b){A.debug("PatchedMediaKeysMs.onMsNeedKey_",b);if(b.initData){var c=document.createEvent("CustomEvent");c.initCustomEvent("encrypted",!1,!1,null);c.initDataType="cenc";c.initData=Ne(b.initData).buffer;this.dispatchEvent(c)}}l.Me=function(b){A.debug("PatchedMediaKeysMs.onMsKeyMessage_",b);this.a&&(this.a.resolve(),this.a=null);this.dispatchEvent(new I("message",{messageType:void 0==this.keyStatuses.a?"license-request":"license-renewal",message:b.message.buffer}))};
l.Ke=function(b){A.debug("PatchedMediaKeysMs.onMsKeyAdded_",b);this.a?(A.debug("Simulating completion for a PR persistent license."),Xj(this,"usable"),this.a.resolve(),this.a=null):this.b&&(Xj(this,"usable"),this.b.resolve(),this.b=null)};
l.Le=function(b){A.debug("PatchedMediaKeysMs.onMsKeyError_",b);b=Error("EME PatchedMediaKeysMs key error");b.errorCode=this.c.error;if(null!=this.a)this.a.reject(b),this.a=null;else if(null!=this.b)this.b.reject(b),this.b=null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:Xj(this,"output-not-allowed");break;default:Xj(this,"internal-error")}};
function Xj(b,c){var d=b.keyStatuses;d.size=void 0==c?0:1;d.a=c;b.dispatchEvent(new I("keystatuseschange"))}function Wj(){this.size=0;this.a=void 0}var Yj;l=Wj.prototype;l.forEach=function(b){this.a&&b(this.a,Yj)};l.get=function(b){if(this.has(b))return this.a};l.has=function(b){var c=Yj;return this.a&&L.Ia(new Uint8Array(b),new Uint8Array(c))?!0:!1};l.entries=function(){};l.keys=function(){};l.values=function(){};
Gj(function(){!window.HTMLVideoElement||!window.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(A.info("Using ms-prefixed EME v20140218"),Yj=(new Uint8Array([0])).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Sj,window.MediaKeys=Rj,window.MediaKeySystemAccess=Qj,navigator.requestMediaKeySystemAccess=Pj)});function Zj(){A.debug("PatchedMediaKeysNop.requestMediaKeySystemAccess");return Promise.reject(Error("The key system specified is not supported."))}function ak(b){A.debug("PatchedMediaKeysNop.setMediaKeys");return null==b?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function bk(){throw new TypeError("Illegal constructor.");}bk.prototype.createSession=function(){};bk.prototype.setServerCertificate=function(){};function ck(){throw new TypeError("Illegal constructor.");}
ck.prototype.getConfiguration=function(){};ck.prototype.createMediaKeys=function(){};Gj(function(){!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(A.info("EME not available."),navigator.requestMediaKeySystemAccess=Zj,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=ak,window.MediaKeys=bk,window.MediaKeySystemAccess=ck)},-10);var dk="";function ek(b){var c=dk;return c?c+b.charAt(0).toUpperCase()+b.slice(1):b}function fk(b,c){A.debug("PatchedMediaKeysWebkit.requestMediaKeySystemAccess");try{var d=new gk(b,c);return Promise.resolve(d)}catch(e){return Promise.reject(e)}}function hk(b){A.debug("PatchedMediaKeysWebkit.setMediaKeys");var c=this.mediaKeys;c&&c!=b&&ik(c,null);delete this.mediaKeys;(this.mediaKeys=b)&&ik(b,this);return Promise.resolve()}
function gk(b,c){A.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess");this.a=this.keySystem=b;var d=!1;"org.w3.clearkey"==b&&(this.a="webkit-org.w3.clearkey",d=!1);var e=!1;var f=document.getElementsByTagName("video");f=f.length?f[0]:document.createElement("video");for(var g=0;g<c.length;++g){var h=c[g],k={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:h.initDataTypes,sessionTypes:["temporary"],label:h.label},m=!1;if(h.audioCapabilities)for(var n=
0;n<h.audioCapabilities.length;++n){var p=h.audioCapabilities[n];if(p.contentType){m=!0;var q=p.contentType.split(";")[0];f.canPlayType(q,this.a)&&(k.audioCapabilities.push(p),e=!0)}}if(h.videoCapabilities)for(n=0;n<h.videoCapabilities.length;++n)p=h.videoCapabilities[n],p.contentType&&(m=!0,f.canPlayType(p.contentType,this.a)&&(k.videoCapabilities.push(p),e=!0));m||(e=f.canPlayType("video/mp4",this.a)||f.canPlayType("video/webm",this.a));"required"==h.persistentState&&(d?(k.persistentState="required",
k.sessionTypes=["persistent-license"]):e=!1);if(e){this.b=k;return}}d="Unsupported keySystem";if("org.w3.clearkey"==b||"com.widevine.alpha"==b)d="None of the requested configurations were supported.";d=Error(d);d.name="NotSupportedError";d.code=DOMException.NOT_SUPPORTED_ERR;throw d;}gk.prototype.createMediaKeys=function(){A.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.createMediaKeys");var b=new jk(this.a);return Promise.resolve(b)};
gk.prototype.getConfiguration=function(){A.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.getConfiguration");return this.b};function jk(b){A.debug("PatchedMediaKeysWebkit.MediaKeys");this.g=b;this.b=null;this.a=new N;this.c=[];this.f={}}function ik(b,c){b.b=c;b.a.Ib();var d=dk;c&&(b.a.B(c,d+"needkey",b.Se.bind(b)),b.a.B(c,d+"keymessage",b.Re.bind(b)),b.a.B(c,d+"keyadded",b.Pe.bind(b)),b.a.B(c,d+"keyerror",b.Qe.bind(b)))}l=jk.prototype;
l.createSession=function(b){A.debug("PatchedMediaKeysWebkit.MediaKeys.createSession");b=b||"temporary";if("temporary"!=b&&"persistent-license"!=b)throw new TypeError("Session type "+b+" is unsupported on this platform.");var c=this.b||document.createElement("video");c.src||(c.src="about:blank");b=new kk(c,this.g,b);this.c.push(b);return b};l.setServerCertificate=function(){A.debug("PatchedMediaKeysWebkit.MediaKeys.setServerCertificate");return Promise.resolve(!1)};
l.Se=function(b){A.debug("PatchedMediaKeysWebkit.onWebkitNeedKey_",b);var c=document.createEvent("CustomEvent");c.initCustomEvent("encrypted",!1,!1,null);c.initDataType="cenc";b.initData instanceof ArrayBuffer?c.initData=b.initData:c.initData=b.initData.buffer;this.b.dispatchEvent(c)};
l.Re=function(b){A.debug("PatchedMediaKeysWebkit.onWebkitKeyMessage_",b);var c=lk(this,b.sessionId);c?(b=new I("message",{messageType:void 0==c.keyStatuses.a?"licenserequest":"licenserenewal",message:b.message}),A.debug("PatchedMediaKeysWebkit.MediaKeySession.generated"),c.b&&(c.b.resolve(),c.b=null),c.dispatchEvent(b)):A.error("Session not found",b.sessionId)};
l.Pe=function(b){A.debug("PatchedMediaKeysWebkit.onWebkitKeyAdded_",b);if(b=lk(this,b.sessionId))A.debug("PatchedMediaKeysWebkit.MediaKeySession.ready"),mk(b,"usable"),b.a&&b.a.resolve(),b.a=null};l.Qe=function(b){A.debug("PatchedMediaKeysWebkit.onWebkitKeyError_",b);var c=lk(this,b.sessionId);c&&c.handleError(b)};
function lk(b,c){var d=b.f[c];return d?(A.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",d),d):(d=b.c.shift())?(d.sessionId=c,b.f[c]=d,A.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",d),d):null}function kk(b,c,d){A.debug("PatchedMediaKeysWebkit.MediaKeySession");zb.call(this);this.f=b;this.h=!1;this.a=this.b=null;this.c=c;this.g=d;this.sessionId="";this.expiration=NaN;this.closed=new G;this.keyStatuses=new nk}Oa(kk,zb);l=kk.prototype;
l.handleError=function(b){A.debug("PatchedMediaKeysWebkit.MediaKeySession.handleError",b);var c=Error("EME v0.1b key error"),d=b.errorCode;d.systemCode=b.systemCode;c.errorCode=d;!b.sessionId&&this.b?(45==b.systemCode&&(c.message="Unsupported session type."),this.b.reject(c),this.b=null):b.sessionId&&this.a?(this.a.reject(c),this.a=null):(c=b.systemCode,b.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?mk(this,"output-restricted"):1==c?mk(this,"expired"):mk(this,"internal-error"))};
function ok(b,c,d){if(b.h)return Promise.reject(Error("The session is already initialized."));b.h=!0;try{if("persistent-license"==b.g)if(d)var e=new Uint8Array(tc("LOAD_SESSION|"+d));else{var f=tc("PERSISTENT|"),g=new Uint8Array(f.byteLength+c.byteLength);g.set(new Uint8Array(f),0);g.set(new Uint8Array(c),f.byteLength);e=g}else e=new Uint8Array(c)}catch(k){return Promise.reject(k)}b.b=new G;var h=ek("generateKeyRequest");try{b.f[h](b.c,e)}catch(k){if("InvalidStateError"!=k.name)return b.b=null,Promise.reject(k);
(new D(function(){try{b.f[h](b.c,e)}catch(m){b.b.reject(m),b.b=null}})).V(.01)}return b.b}
l.ad=function(b,c){if(this.a)this.a.then(this.ad.bind(this,b,c))["catch"](this.ad.bind(this,b,c));else{this.a=b;if("webkit-org.w3.clearkey"==this.c){var d=qc(c);var e=JSON.parse(d);"oct"!=e.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null);d=L.Ja(e.keys[0].k);e=L.Ja(e.keys[0].kid)}else d=new Uint8Array(c),e=null;var f=ek("addKey");try{this.f[f](this.c,d,e,this.sessionId)}catch(g){this.a.reject(g),this.a=null}}};
function mk(b,c){var d=b.keyStatuses;d.size=void 0==c?0:1;d.a=c;b.dispatchEvent(new I("keystatuseschange"))}l.generateRequest=function(b,c){A.debug("PatchedMediaKeysWebkit.MediaKeySession.generateRequest");return ok(this,c,null)};l.load=function(b){A.debug("PatchedMediaKeysWebkit.MediaKeySession.load");return"persistent-license"==this.g?ok(this,null,b):Promise.reject(Error("Not a persistent session."))};
l.update=function(b){A.debug("PatchedMediaKeysWebkit.MediaKeySession.update",b);var c=new G;this.ad(c,b);return c};l.close=function(){A.debug("PatchedMediaKeysWebkit.MediaKeySession.close");if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var b=ek("cancelKeyRequest");try{this.f[b](this.c,this.sessionId)}catch(c){}}this.closed.resolve();return this.closed};
l.remove=function(){A.debug("PatchedMediaKeysWebkit.MediaKeySession.remove");return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()};function nk(){this.size=0;this.a=void 0}var pk;l=nk.prototype;l.forEach=function(b){this.a&&b(this.a,pk)};l.get=function(b){if(this.has(b))return this.a};l.has=function(b){var c=pk;return this.a&&L.Ia(new Uint8Array(b),new Uint8Array(c))?!0:!1};l.entries=function(){};l.keys=function(){};l.values=function(){};
Gj(function(){if(!(!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)A.info("Using webkit-prefixed EME v0.1b"),dk="webkit";else if(HTMLMediaElement.prototype.generateKeyRequest)A.info("Using nonprefixed EME v0.1b");else return;pk=(new Uint8Array([0])).buffer;navigator.requestMediaKeySystemAccess=fk;delete HTMLMediaElement.prototype.mediaKeys;HTMLMediaElement.prototype.mediaKeys=
null;HTMLMediaElement.prototype.setMediaKeys=hk;window.MediaKeys=jk;window.MediaKeySystemAccess=gk}});Gj(function(){A.debug("VideoPlayPromise.install");if(window.HTMLMediaElement){var b=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var c=b.apply(this);c&&c["catch"](function(){});return c}}});function qk(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}Gj(function(){if(window.HTMLVideoElement){var b=HTMLVideoElement.prototype;!b.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in b&&(b.getVideoPlaybackQuality=qk)}});function rk(b,c,d){return new window.TextTrackCue(b,c,d)}function sk(b,c,d){return new window.TextTrackCue(b+"-"+c+"-"+d,b,c,d)}
Gj(function(){if(window.VTTCue)A.info("Using native VTTCue.");else if(window.TextTrackCue){var b=TextTrackCue.length;if(3==b)A.info("Using VTTCue polyfill from 3 argument TextTrackCue."),window.VTTCue=rk;else if(6==b)A.info("Using VTTCue polyfill from 6 argument TextTrackCue."),window.VTTCue=sk;else{try{var c=!!rk(1,2,"")}catch(d){c=!1}c&&(A.info("Using VTTCue polyfill from 3 argument TextTrackCue."),window.VTTCue=rk)}}else A.error("VTTCue not available.")});function tk(b){this.b=b;this.a=0}function uk(b){vk(b,/[ \t]+/gm)}function vk(b,c){c.lastIndex=b.a;var d=c.exec(b.b);d=null==d?null:{position:d.index,length:d[0].length,ff:d};if(b.a==b.b.length||null==d||d.position!=b.a)return null;b.a+=d.length;return d.ff}function wk(b){return b.a==b.b.length?null:(b=vk(b,/[^ \t\n]*/gm))?b[0]:null};function xk(){}z("shaka.text.VttTextParser",xk);xk.prototype.parseInit=function(){};xk.prototype.parseInit=xk.prototype.parseInit;
xk.prototype.parseMedia=function(b,c){var d=qc(b);d=d.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n");d=d.split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(d[0]))throw new F(2,2,2E3);var e=c.segmentStart;if(null==e&&(e=0,d[0].includes("X-TIMESTAMP-MAP"))){var f=d[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),g=d[0].match(/MPEGTS:(\d+)/m);if(f&&g){e=yk(new tk(f[1]));if(null==e)throw new F(2,2,2E3);e=c.periodStart+(Number(g[1])/9E4-e)}}g=[];var h=d[0].split("\n");for(f=1;f<h.length;f++)if(/^Region:/.test(h[f])){var k=
new tk(h[f]),m=new rd;wk(k);uk(k);for(var n=wk(k);n;){var p;a:{var q=m,t=n;if(p=/^id=(.*)$/.exec(t))q.id=p[1];else if(p=/^width=(\d{1,2}|100)%$/.exec(t))q.width=Number(p[1]);else if(p=/^lines=(\d+)$/.exec(t))q.height=Number(p[1]),q.heightUnits=2;else if(p=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(t))q.regionAnchorX=Number(p[1]),q.regionAnchorY=Number(p[2]);else if(p=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(t))q.viewportAnchorX=Number(p[1]),q.viewportAnchorY=Number(p[2]);else if(/^scroll=up$/.exec(t))q.scroll=
"up";else{p=!1;break a}p=!0}p||A.l("VTT parser encountered an invalid VTTRegion setting: ",n," The setting will be ignored.");uk(k);n=wk(k)}g.push(m)}f=[];for(k=1;k<d.length;k++){h=d[k].split("\n");p=h;q=e;h=g;if(1==p.length&&!p[0]||/^NOTE($|[ \t])/.test(p[0])||"STYLE"==p[0])h=null;else{m=null;p[0].includes("--\x3e")||(m=p[0],p.splice(0,1));n=new tk(p[0]);t=yk(n);var u=vk(n,/[ \t]+--\x3e[ \t]+/g),E=yk(n);if(null==t||null==u||null==E)throw new F(2,2,2001);p=new pd(t+q,E+q,p.slice(1).join("\n").trim());
uk(n);for(q=wk(n);q;)zk(p,q,h)||A.l("VTT parser encountered an invalid VTT setting: ",q," The setting will be ignored."),uk(n),q=wk(n);null!=m&&(p.id=m);h=p}h&&f.push(h)}return f};xk.prototype.parseMedia=xk.prototype.parseMedia;
function zk(b,c,d){var e;if(e=/^align:(start|middle|center|end|left|right)$/.exec(c))c=e[1],"middle"==c?b.textAlign=td:b.textAlign=Cd[c.toUpperCase()];else if(e=/^vertical:(lr|rl)$/.exec(c))b.writingMode="lr"==e[1]?"vertical-lr":"vertical-rl";else if(e=/^size:([\d.]+)%$/.exec(c))b.size=Number(e[1]);else if(e=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(c))b.position=Number(e[1]),e[2]&&(c=e[2],b.positionAlign="line-left"==c||"start"==c?"line-left":"line-right"==c||"end"==
c?"line-right":"center");else if(e=/^region:(.*)$/.exec(c)){if(c=Ak(d,e[1]))b.region=c}else{a:{if(d=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(c))b.lineInterpretation=1,b.line=Number(d[1]),d[2]&&(b.lineAlign=Ed[d[2].toUpperCase()]);else if(d=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(c))b.lineInterpretation=vd,b.line=Number(d[1]),d[2]&&(b.lineAlign=Ed[d[2].toUpperCase()]);else{b=!1;break a}b=!0}return b}return!0}
function Ak(b,c){var d=b.filter(function(b){return b.id==c});return d.length?d[0]:(A.l("VTT parser could not find a region with id: ",c," The region will be ignored."),null)}function yk(b){b=vk(b,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g);if(null==b)return null;var c=Number(b[2]),d=Number(b[3]);return 59<c||59<d?null:Number(b[4])/1E3+d+60*c+3600*(Number(b[1])||0)}Jd["text/vtt"]=xk;Jd['text/vtt; codecs="vtt"']=xk;Jd['text/vtt; codecs="wvtt"']=xk;function Bk(){this.a=null}z("shaka.text.Mp4VttParser",Bk);Bk.prototype.parseInit=function(b){var c=!1;(new M).F("moov",Je).F("trak",Je).F("mdia",Je).oa("mdhd",function(b){0==b.version?(b.reader.S(4),b.reader.S(4),this.a=b.reader.H(),b.reader.S(4)):(b.reader.S(8),b.reader.S(8),this.a=b.reader.H(),b.reader.S(8));b.reader.S(4)}.bind(this)).F("minf",Je).F("stbl",Je).oa("stsd",Ke).F("wvtt",function(){c=!0}).parse(b);if(!this.a)throw new F(2,2,2008);if(!c)throw new F(2,2,2008);};
Bk.prototype.parseInit=Bk.prototype.parseInit;
Bk.prototype.parseMedia=function(b,c){var d=this;if(!this.a)throw A.error("No init segment for MP4+VTT!"),new F(2,2,2008);var e=0,f=[],g,h=[],k=!1,m=!1,n=!1,p=null;(new M).F("moof",Je).F("traf",Je).oa("tfdt",function(b){k=!0;e=0==b.version?b.reader.H():b.reader.zb()}).oa("tfhd",function(b){var c=b.flags;b=b.reader;b.S(4);c&1&&b.S(8);c&2&&b.S(4);p=c&8?b.H():null}).oa("trun",function(b){m=!0;f=Ck(b.version,b.flags,b.reader)}).F("mdat",Le(function(b){n=!0;g=b})).parse(b);if(!n&&!k&&!m)throw new F(2,
2,2008);var q=e,t=new DataView(g.buffer,g.byteOffset,g.byteLength),u=new R(t,0);f.forEach(function(b){var f=b.duration||p,g=b.cd?e+b.cd:q;q=g+(f||0);var k=0;do{var m=u.H();k+=m;var n=u.H();n=Ie(n);var t=null;"vttc"==n?8<m&&(t=u.Da(m-8)):("vtte"!=n&&A.error("Unknown box "+n+"! Skipping!"),u.S(m-8));f?t&&h.push(Dk(t,c.periodStart+g/d.a,c.periodStart+q/d.a)):A.error("WVTT sample duration unknown, and no default found!")}while(b.sampleSize&&k<b.sampleSize)});return h.filter(hd.Ka)};
Bk.prototype.parseMedia=Bk.prototype.parseMedia;function Ck(b,c,d){var e=d.H();c&1&&d.S(4);c&4&&d.S(4);for(var f=[],g=0;g<e;g++){var h={duration:null,sampleSize:null,cd:null};c&256&&(h.duration=d.H());c&512&&(h.sampleSize=d.H());c&1024&&d.S(4);c&2048&&(h.cd=0==b?d.H():d.Dd());f.push(h)}return f}function Dk(b,c,d){var e,f,g;(new M).F("payl",Le(function(b){e=qc(b)})).F("iden",Le(function(b){f=qc(b)})).F("sttg",Le(function(b){g=qc(b)})).parse(b);return e?Ek(e,f,g,c,d):null}
function Ek(b,c,d,e,f){b=new pd(e,f,b);c&&(b.id=c);if(d)for(c=new tk(d),d=wk(c);d;)zk(b,d,[])||A.l("VTT parser encountered an invalid VTT setting: ",d," The setting will be ignored."),uk(c),d=wk(c);return b}Jd['application/mp4; codecs="wvtt"']=Bk;function Fk(){}z("shaka.text.TtmlTextParser",Fk);Fk.prototype.parseInit=function(){};Fk.prototype.parseInit=Fk.prototype.parseInit;
Fk.prototype.parseMedia=function(b,c){var d=qc(b),e=[],f=new DOMParser,g=null;if(""==d)return e;try{g=f.parseFromString(d,"text/xml")}catch(xa){throw new F(2,2,2005,"Failed to parse TTML.");}if(g){if(d=g.getElementsByTagName("parsererror")[0])throw new F(2,2,2005,d.textContent);if(f=g.getElementsByTagName("tt")[0]){var h=S.getAttributeNS(f,"http://www.w3.org/ns/ttml#parameter","frameRate");var k=S.getAttributeNS(f,"http://www.w3.org/ns/ttml#parameter","subFrameRate");var m=S.getAttributeNS(f,"http://www.w3.org/ns/ttml#parameter",
"frameRateMultiplier");var n=S.getAttributeNS(f,"http://www.w3.org/ns/ttml#parameter","tickRate");g=f.getAttribute("xml:space")||"default";d=S.getAttributeNS(f,"http://www.w3.org/ns/ttml#styling","extent")}else throw new F(2,2,2005,"TTML does not contain <tt> tag.");if("default"!=g&&"preserve"!=g)throw new F(2,2,2005,"Invalid xml:space value: "+g);g="default"==g;h=new Gk(h,k,m,n);k=Hk(f.getElementsByTagName("metadata")[0]);m=Hk(f.getElementsByTagName("styling")[0]);n=Hk(f.getElementsByTagName("layout")[0]);
for(var p=[],q=0;q<n.length;q++){var t=n[q],u=m,E=d;var B=new rd;var C=t.getAttribute("xml:id");if(C){B.id=C;C=null;E&&(C=Ik.exec(E)||Jk.exec(E));E=C?Number(C[1]):null;C=C?Number(C[2]):null;var J,Z;if(J=Kk(t,u,"extent"))J=(Z=Ik.exec(J))||Jk.exec(J),null!=J&&(B.width=null!=E?100*Number(J[1])/E:Number(J[1]),B.height=null!=C?100*Number(J[2])/C:Number(J[2]),B.widthUnits=Z||null!=E?Gd:0,B.heightUnits=Z||null!=C?Gd:0);if(t=Kk(t,u,"origin"))J=(Z=Ik.exec(t))||Jk.exec(t),null!=J&&(B.viewportAnchorX=null!=
C?100*Number(J[1])/C:Number(J[1]),B.viewportAnchorY=null!=E?100*Number(J[2])/E:Number(J[2]),B.viewportAnchorUnits=Z||null!=E?Gd:0)}else A.l("TtmlTextParser parser encountered a region with no id. Region will be ignored."),B=null;B&&p.push(B)}d=Lk(f.getElementsByTagName("body")[0]);d=r(d);for(f=d.next();!f.done;f=d.next())(f=Mk(f.value,c.periodStart,h,k,m,n,p,g,!1))&&e.push(f)}return e};Fk.prototype.parseMedia=Fk.prototype.parseMedia;
var Ik=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,Nk=/^(\d+px|\d+em)$/,Jk=/^(\d+)px (\d+)px$/,Ok=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Pk=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,Qk=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,Rk=/^(\d*(?:\.\d*)?)f$/,Sk=/^(\d*(?:\.\d*)?)t$/,Tk=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m(?!s))?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,Uk={left:wd,center:"center",right:"end",start:wd,end:"end"},Vk={left:"line-left",center:"center",right:"line-right"};
function Hk(b){var c=[];if(!b)return c;for(var d=r(b.childNodes),e=d.next();!e.done;e=d.next())e=e.value,e.nodeType==Node.ELEMENT_NODE&&"br"!==e.nodeName&&(e=Hk(e),c=c.concat(e));c.length||c.push(b);return c}function Lk(b){if(!b)return[];var c=[];b=r(b.childNodes);for(var d=b.next();!d.done;d=b.next())d=d.value,d instanceof Element&&(d.hasAttribute("begin")?c.push(d):c=c.concat(Lk(d)));return c}
function Wk(b,c){for(var d="",e=r(b.childNodes),f=e.next();!f.done;f=e.next())f=f.value,"br"==f.nodeName&&b.childNodes[0]!==f?d+="\n":f.childNodes&&0<f.childNodes.length?d+=Wk(f,c):c?(f=f.textContent.trim(),f=f.replace(/\s+/g," "),d+=f):d+=f.textContent;return d}
function Mk(b,c,d,e,f,g,h,k,m){if(m&&"br"==b.nodeName)return b=new pd(0,0,""),b.spacer=!0,b;var n=/^[\s\n]*$/.test(b.textContent),p=b.nodeType==Node.ELEMENT_NODE&&!b.hasAttribute("begin")&&!b.hasAttribute("end");if(b.nodeType!=Node.ELEMENT_NODE||p&&n||p&&!m)return null;n=Xk(b.getAttribute("begin"),d);p=Xk(b.getAttribute("end"),d);var q=Xk(b.getAttribute("dur"),d);null==p&&null!=q&&(p=n+q);if(!m&&(null==n||null==p))throw new F(2,2,2001);n=m&&null==n?0:n+c;p=m&&null==p?0:p+c;q="";m=[];if(Array.from(b.childNodes).find(function(b){return b.nodeType===
Node.TEXT_NODE&&/\S+/.test(b.textContent)}))q=Wk(b,k);else for(var t=r(b.childNodes),u=t.next();!u.done;u=t.next())if(u=Mk(u.value,c,d,e,f,g,h,k,!0))u.startTime=u.startTime||n,u.endTime=u.endTime||p,m.push(u);c=new pd(n,p,q);c.nestedCues=m;if((g=Yk(b,"region",g,"")[0])&&g.getAttribute("xml:id")){var E=g.getAttribute("xml:id");c.region=h.filter(function(b){return b.id==E})[0]}e=Yk(b,"smpte:backgroundImage",e,"#")[0];Zk(c,b,g,e,f);return c}
function Zk(b,c,d,e,f){"rtl"==$k(c,d,f,"direction")&&(b.direction="rtl");var g=$k(c,d,f,"writingMode");"tb"==g||"tblr"==g?b.writingMode="vertical-lr":"tbrl"==g?b.writingMode="vertical-rl":"rltb"==g||"rl"==g?b.direction="rtl":g&&(b.direction=qd);(g=$k(c,d,f,"textAlign"))?(b.positionAlign=Vk[g],b.lineAlign=Uk[g],b.textAlign=Cd[g.toUpperCase()]):b.textAlign="start";if(g=$k(c,d,f,"displayAlign"))b.displayAlign=Dd[g.toUpperCase()];if(g=$k(c,d,f,"color"))b.color=g;if(g=$k(c,d,f,"backgroundColor"))b.backgroundColor=
g;if(g=$k(c,d,f,"fontFamily"))b.fontFamily=g;(g=$k(c,d,f,"fontWeight"))&&"bold"==g&&(b.fontWeight=700);(g=$k(c,d,f,"wrapOption"))&&"noWrap"==g&&(b.wrapLine=!1);(g=$k(c,d,f,"lineHeight"))&&g.match(Nk)&&(b.lineHeight=g);(g=$k(c,d,f,"fontSize"))&&g.match(Nk)&&(b.fontSize=g);if(g=$k(c,d,f,"fontStyle"))b.fontStyle=Fd[g.toUpperCase()];if(e){g=e.getAttribute("imagetype");var h=e.getAttribute("encoding");e=e.textContent.trim();"PNG"==g&&"Base64"==h&&e&&(b.backgroundImage="data:image/png;base64,"+e)}(d=Kk(d,
f,"textDecoration"))&&al(b,d);(c=bl(c,f,"textDecoration"))&&al(b,c)}
function al(b,c){for(var d=c.split(" "),e=0;e<d.length;e++)switch(d[e]){case "underline":b.textDecoration.includes("underline")||b.textDecoration.push("underline");break;case "noUnderline":b.textDecoration.includes("underline")&&Bb(b.textDecoration,"underline");break;case "lineThrough":b.textDecoration.includes("lineThrough")||b.textDecoration.push("lineThrough");break;case "noLineThrough":b.textDecoration.includes("lineThrough")&&Bb(b.textDecoration,"lineThrough");break;case "overline":b.textDecoration.includes("overline")||
b.textDecoration.push("overline");break;case "noOverline":b.textDecoration.includes("overline")&&Bb(b.textDecoration,"overline")}}function $k(b,c,d,e){return(b=bl(b,d,e))?b:Kk(c,d,e)}function Kk(b,c,d){if(!b)return null;for(var e=Hk(b),f=0;f<e.length;f++){var g=S.getAttributeNS(e[f],"http://www.w3.org/ns/ttml#styling",d);if(g)return g}return cl(b,c,d)}function bl(b,c,d){var e=S.getAttributeNS(b,"http://www.w3.org/ns/ttml#styling",d);return e?e:cl(b,c,d)}
function cl(b,c,d){b=Yk(b,"style",c,"");for(var e=null,f=0;f<b.length;f++){var g=S.getAttributeNS(b[f],"http://www.w3.org/ns/ttml#styling",d);g||(g=bl(b[f],c,d));g&&(e=g)}return e}
function Yk(b,c,d,e){var f=[];if(!b||1>d.length)return f;var g=b;for(b=null;g&&!(b=g.getAttribute(c))&&(g=g.parentNode,g instanceof Element););if(c=b)for(c=c.split(" "),c=r(c),b=c.next();!b.done;b=c.next()){b=b.value;g=r(d);for(var h=g.next();!h.done;h=g.next())if(h=h.value,e+h.getAttribute("xml:id")==b){f.push(h);break}}return f}
function Xk(b,c){var d=null;if(Ok.test(b)){d=Ok.exec(b);var e=Number(d[1]),f=Number(d[2]),g=Number(d[3]),h=Number(d[4]);h+=(Number(d[5])||0)/c.b;g+=h/c.frameRate;d=g+60*f+3600*e}else Pk.test(b)?d=dl(Pk,b):Qk.test(b)?d=dl(Qk,b):Rk.test(b)?(d=Rk.exec(b),d=Number(d[1])/c.frameRate):Sk.test(b)?(d=Sk.exec(b),d=Number(d[1])/c.a):Tk.test(b)&&(d=dl(Tk,b));return d}
function dl(b,c){var d=b.exec(c);return null==d||""==d[0]?null:(Number(d[4])||0)/1E3+(Number(d[3])||0)+60*(Number(d[2])||0)+3600*(Number(d[1])||0)}function Gk(b,c,d,e){this.frameRate=Number(b)||30;this.b=Number(c)||1;this.a=Number(e);0==this.a&&(this.a=b?this.frameRate*this.b:1);d&&(b=/^(\d+) (\d+)$/g.exec(d))&&(this.frameRate*=Number(b[1])/Number(b[2]))}Jd["application/ttml+xml"]=Fk;function el(){this.a=new Fk}z("shaka.text.Mp4TtmlParser",el);el.prototype.parseInit=function(b){var c=!1;(new M).F("moov",Je).F("trak",Je).F("mdia",Je).F("minf",Je).F("stbl",Je).oa("stsd",Ke).F("stpp",function(b){c=!0;b.parser.stop()}).parse(b);if(!c)throw new F(2,2,2007);};el.prototype.parseInit=el.prototype.parseInit;
el.prototype.parseMedia=function(b,c){var d=this,e=!1,f=!1,g=[],h=[],k;(new M).F("moof",Je).F("traf",Je).oa("trun",function(b){e=!0;h=Ck(b.version,b.flags,b.reader)}).F("mdat",Le(function(b){k=b;f=!0})).parse(b);if(!f||!e)throw new F(2,2,2007);var m=new DataView(k.buffer,k.byteOffset,k.byteLength),n=new R(m,0);h.forEach(function(b){b.sampleSize&&(b=n.Da(b.sampleSize),g=g.concat(d.a.parseMedia(b,c)))});return g};el.prototype.parseMedia=el.prototype.parseMedia;Jd['application/mp4; codecs="stpp"']=el;
Jd['application/mp4; codecs="stpp.ttml.im1t"']=el;Jd['application/mp4; codecs="stpp.TTML.im1t"']=el;z("shaka.util.Dom.createHTMLElement",function(b){return document.createElement(b)});z("shaka.util.Dom.createVideoElement",function(){var b=document.createElement("video");b.muted=!0;b.width=600;b.height=400;return b});z("shaka.util.Dom.asHTMLElement",function(b){return b});z("shaka.util.Dom.asHTMLMediaElement",function(b){return b});z("shaka.util.Dom.removeAllChildren",function(b){for(;b.firstChild;)b.removeChild(b.firstChild)});/*
 @license
 EME Encryption Scheme Polyfill
 Copyright 2019 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function fl(){}var gl;z("EmeEncryptionSchemePolyfill",fl);function hl(){gl?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(gl=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=il):console.debug("EmeEncryptionSchemePolyfill: EME not found")}fl.install=hl;
function il(b,c){var d=this;return v(function f(){var g;return y(f,function(f){switch(f.j){case 1:return console.assert(d==navigator,'bad "this" for requestMediaKeySystemAccess'),w(f,gl.call(d,b,c),2);case 2:g=f.N;if(jl(g))return console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=gl,f["return"](g);console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support.");navigator.requestMediaKeySystemAccess=
kl;return f["return"](kl.call(d,b,c))}})})}
function kl(b,c){var d=this;return v(function f(){var g,h,k,m,n,p,q,t;return y(f,function(f){switch(f.j){case 1:console.assert(d==navigator,'bad "this" for requestMediaKeySystemAccess');g=ll(b);h=[];for(var u=r(c),B=u.next();!B.done;B=u.next())k=B.value,m=ml(k.videoCapabilities,g),n=ml(k.audioCapabilities,g),k.videoCapabilities&&k.videoCapabilities.length&&!m.length||k.audioCapabilities&&k.audioCapabilities.length&&!n.length||(p=Object.assign({},k),p.videoCapabilities=m,p.audioCapabilities=n,h.push(p));
if(!h.length)throw q=Error("Unsupported keySystem or supportedConfigurations."),q.name="NotSupportedError",q.code=DOMException.NOT_SUPPORTED_ERR,q;return w(f,gl.call(d,b,h),2);case 2:return t=f.N,f["return"](new nl(t,g))}})})}function ml(b,c){return b?b.filter(function(b){return!b.encryptionScheme||b.encryptionScheme==c}):b}function ol(){}var pl;z("McEncryptionSchemePolyfill",ol);
function ql(){pl?console.debug("McEncryptionSchemePolyfill: Already installed."):navigator.mediaCapabilities?(pl=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=rl):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}ol.install=ql;
function rl(b){var c=this;return v(function e(){var f,g;return y(e,function(e){switch(e.j){case 1:return console.assert(c==navigator.mediaCapabilities,'bad "this" for decodingInfo'),w(e,pl.call(c,b),2);case 2:f=e.N;if(!b.keySystemConfiguration)return e["return"](f);if((g=f.keySystemAccess)&&jl(g))return console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=pl,e["return"](f);console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support.");
navigator.mediaCapabilities.decodingInfo=sl;return e["return"](sl.call(c,b))}})})}
function sl(b){var c=this;return v(function e(){var f,g,h,k,m,n,p,q,t;return y(e,function(e){switch(e.j){case 1:return console.assert(c==navigator.mediaCapabilities,'bad "this" for decodingInfo'),f=null,b.keySystemConfiguration&&(g=b.keySystemConfiguration,h=g.keySystem,k=g.audio&&g.audio.encryptionScheme,m=g.video&&g.video.encryptionScheme,f=ll(h),n={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:b},k&&k!=f||m&&m!=f)?e["return"](n):w(e,pl.call(c,b),2);case 2:p=e.N;if(p.keySystemAccess){p.keySystemAccess=
new nl(p.keySystemAccess,f);e.j=3;break}if(!b.keySystemConfiguration){e.j=3;break}var u=b.keySystemConfiguration,B=[],C=[];u.audio&&B.push({robustness:u.audio.robustness||"",contentType:b.audio.contentType});u.video&&C.push({robustness:u.video.robustness||"",contentType:b.video.contentType});u={initDataTypes:u.initDataType?[u.initDataType]:[],distinctiveIdentifier:u.distinctiveIdentifier,persistentState:u.persistentState,sessionTypes:u.sessionTypes};B.length&&(u.audioCapabilities=B);C.length&&(u.videoCapabilities=
C);q=u;t=p;return w(e,navigator.requestMediaKeySystemAccess(b.keySystemConfiguration.keySystem,[q]),5);case 5:t.keySystemAccess=e.N;case 3:return e["return"](p)}})})}function nl(b,c){this.b=b;this.a=c;this.keySystem=b.keySystem}
nl.prototype.getConfiguration=function(){var b=this.b.getConfiguration();if(b.videoCapabilities)for(var c=r(b.videoCapabilities),d=c.next();!d.done;d=c.next())d.value.encryptionScheme=this.a;if(b.audioCapabilities)for(c=r(b.audioCapabilities),d=c.next();!d.done;d=c.next())d.value.encryptionScheme=this.a;return b};nl.prototype.createMediaKeys=function(){return this.b.createMediaKeys()};
function ll(b){if(b.startsWith("com.widevine")||b.startsWith("com.microsoft")||b.startsWith("com.adobe")||b.startsWith("org.w3"))return"cenc";if(b.startsWith("com.apple"))return"cbcs-1-9";console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",b,"Please contribute!");return null}function jl(b){b=b.getConfiguration();var c=b.audioCapabilities&&b.audioCapabilities[0];return(b=b.videoCapabilities&&b.videoCapabilities[0]||c)&&void 0!==b.encryptionScheme?!0:!1}function tl(){}
z("EncryptionSchemePolyfills",tl);function Hj(){hl();ql()}tl.install=Hj;"undefined"!==typeof module&&module.ce&&(module.ce=tl);}).call(exportTo,innerGlobal,innerGlobal,undefined);if(typeof exports!="undefined")for(var k in exportTo.shaka)exports[k]=exportTo.shaka[k];else if(typeof define=="function"&&define.amd)define(function(){return exportTo.shaka});else innerGlobal.shaka=exportTo.shaka})();

//# sourceMappingURL=shaka-player.compiled.map